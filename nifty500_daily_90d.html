<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nifty 500 - Broad Market Monitor</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/hammer.js/2.0.8/hammer.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-zoom@2.0.1/dist/chartjs-plugin-zoom.min.js"></script>
    <style>
        :root { --bg-color: #1a1b26; --card-bg-color: #24283b; --text-color: #c0caf5; --text-secondary-color: #a9b1d6; --border-color: #414868; --primary-color: #7aa2f7; --green: #9ece6a; --red: #f7768e; --blue: #7aa2f7; --cyan: #7dcfff; --yellow: #e0af68; --magenta: #bb9af7; }
        body[data-theme="bloomberg"] { --bg-color: #0d0d0d; --card-bg-color: #1a1a1a; --text-color: #e0e0e0; --text-secondary-color: #a0a0a0; --border-color: #333333; --primary-color: #ff9900; --green: #00e676; --red: #ff5252; --blue: #2979ff; --cyan: #00e5ff; --yellow: #ffd600; --magenta: #d500f9; }
        body[data-theme="light"] { --bg-color: #f5f7fa; --card-bg-color: #ffffff; --text-color: #1c2a42; --text-secondary-color: #5b6b85; --border-color: #e6e9f0; --primary-color: #0052cc; --green: #00875a; --red: #bf2600; --blue: #0052cc; --cyan: #00a3bf; --yellow: #ffab00; --magenta: #6554c0; }
        body { font-family: 'Segoe UI', 'Roboto', 'Helvetica', sans-serif; background-color: var(--bg-color); color: var(--text-color); margin: 0; padding: 10px; }
        .container { max-width: 1600px; margin: auto; }
        header { text-align: center; margin-bottom: 25px; border-bottom: 1px solid var(--border-color); padding-bottom: 20px; }
        h1 { font-size: 1.5rem; color: var(--text-color); margin: 0 0 5px 0; }
        h2 { margin: 0; color: var(--text-secondary-color); font-weight: 500; font-size: 1rem; }
        .card { background-color: var(--card-bg-color); border: 1px solid var(--border-color); border-radius: 8px; padding: 20px; margin-bottom: 20px; }
        .chart-header { display: flex; flex-direction: column; align-items: flex-start; gap: 10px; border-bottom: 1px solid var(--border-color); padding-bottom: 15px; margin-bottom: 15px; }
        .chart-title { font-size: 1.1rem; color: var(--text-secondary-color); font-weight: 500; }
        .zoom-hint { font-size: 0.8rem; font-style: italic; color: #6c707a; }
        .reset-zoom-btn { background: none; border: 1px solid var(--border-color); color: var(--text-secondary-color); padding: 5px 10px; border-radius: 4px; cursor: pointer; }
        @media (min-width: 600px) { 
            h1 {font-size: 1.8rem;} h2 {font-size: 1.2rem;}
            .chart-header { flex-direction: row; justify-content: space-between; align-items: center;}
        }
    </style>
</head>
<body data-theme="bloomberg">
    <div class="container">
        <header>
            <h1>Nifty 500</h1>
            <h2>Timeframe: Daily | Lookback: 90 Periods</h2>
        </header>
        <div id="charts">
            <div class="card chart-card"><div class="chart-header"><span class="chart-title">Market Trend (Sum)</span><div><span class="zoom-hint">Scroll/Drag to Zoom</span> <button class="reset-zoom-btn" data-chart-id="chart1">Reset</button></div></div><canvas id="chart1"></canvas></div>
            <div class="card chart-card"><div class="chart-header"><span class="chart-title">Market Proportion</span><div><span class="zoom-hint">Scroll/Drag to Zoom</span> <button class="reset-zoom-btn" data-chart-id="chart2">Reset</button></div></div><canvas id="chart2"></canvas></div>
            <div class="card chart-card"><div class="chart-header"><span class="chart-title">Market Breadth</span><div><span class="zoom-hint">Scroll/Drag to Zoom</span> <button class="reset-zoom-btn" data-chart-id="chart3">Reset</button></div></div><canvas id="chart3"></canvas></div>
        </div>
    </div>
    <script>
        window.chartData = {"labels": ["2025-06-26", "2025-06-27", "2025-06-30", "2025-07-01", "2025-07-02", "2025-07-03", "2025-07-04", "2025-07-07", "2025-07-08", "2025-07-09", "2025-07-10", "2025-07-11", "2025-07-14", "2025-07-15", "2025-07-16", "2025-07-17", "2025-07-18", "2025-07-21", "2025-07-22", "2025-07-23", "2025-07-24", "2025-07-25", "2025-07-28", "2025-07-29", "2025-07-30", "2025-07-31", "2025-08-01", "2025-08-04", "2025-08-05", "2025-08-06", "2025-08-07", "2025-08-08", "2025-08-11", "2025-08-12", "2025-08-13", "2025-08-14", "2025-08-18", "2025-08-19", "2025-08-20", "2025-08-21", "2025-08-22", "2025-08-25", "2025-08-26", "2025-08-28", "2025-08-29", "2025-09-01", "2025-09-02", "2025-09-03", "2025-09-04", "2025-09-05", "2025-09-08", "2025-09-09", "2025-09-10", "2025-09-11", "2025-09-12", "2025-09-15", "2025-09-16", "2025-09-17", "2025-09-18", "2025-09-19", "2025-09-22", "2025-09-23", "2025-09-24", "2025-09-25", "2025-09-26", "2025-09-29", "2025-09-30", "2025-10-01", "2025-10-03", "2025-10-06", "2025-10-07", "2025-10-08", "2025-10-09", "2025-10-10", "2025-10-13", "2025-10-14", "2025-10-15", "2025-10-16", "2025-10-17", "2025-10-20", "2025-10-21", "2025-10-23", "2025-10-24", "2025-10-27", "2025-10-28", "2025-10-29", "2025-10-30", "2025-10-31", "2025-11-03", "2025-11-04"], "chart1": {"trendOfStocks": [213, 265, 271, 199, 163, 153, 141, 103, 53, 77, 37, -81, -33, 119, 113, 125, -1, 19, -51, -7, -41, -265, -335, -219, -161, -247, -311, -233, -225, -293, -285, -357, -269, -235, -147, -163, -7, 131, 159, 121, 11, 49, -197, -281, -281, -109, -13, 111, -69, -57, -17, 7, 151, 163, 173, 209, 277, 285, 299, 217, 67, -11, -115, -201, -385, -331, -273, -143, -33, -1, 19, -101, -5, 63, -39, -173, -25, 63, -7, 43, 136, 72, 18, 78, 34, 184, 120, -22, 56, -54], "e9_trendOfStocks": [213.0, 223.4, 232.92000000000002, 226.13600000000002, 213.50880000000004, 201.40704000000002, 189.32563200000004, 172.06050560000003, 148.24840448000003, 133.99872358400003, 114.59897886720003, 75.47918309376003, 53.783346475008024, 66.82667718000643, 76.06134174400515, 85.84907339520413, 68.4792587161633, 58.58340697293064, 36.66672557834451, 27.93338046267561, 14.146704370140489, -41.68263650388761, -100.34610920311009, -124.0768873624881, -131.46150988999048, -154.5692079119924, -185.85536632959395, -195.28429306367516, -201.22743445094014, -219.58194756075213, -232.66555804860172, -257.5324464388814, -259.8259571511051, -254.8607657208841, -233.2886125767073, -219.23089006136584, -176.7847120490927, -115.22776963927414, -60.38221571141932, -24.105772569135453, -17.084618055308365, -3.867694444246691, -42.494155555397356, -90.19532444431789, -128.3562595554543, -124.48500764436345, -102.18800611549077, -59.55040489239262, -61.4403239139141, -60.55225913113128, -51.841807304905025, -40.07344584392403, -1.8587566751392188, 31.112994659888628, 59.49039572791091, 89.39231658232873, 126.913853265863, 158.5310826126904, 186.62486609015232, 192.69989287212186, 167.5599142976975, 131.847931438158, 82.47834515052642, 25.782676120421144, -56.37385910366308, -111.29908728293047, -143.6392698263444, -143.5114158610755, -121.40913268886041, -97.32730615108834, -74.06184492087068, -79.44947593669656, -64.55958074935725, -39.047664599485806, -39.038131679588645, -65.83050534367092, -57.66440427493674, -33.531523419949394, -28.225218735959515, -13.980174988767613, 16.01586000898591, 27.21268800718873, 25.370150405750987, 35.896120324600794, 35.516896259680635, 65.21351700774451, 76.17081360619562, 56.5366508849565, 56.4293207079652, 34.34345656637217]}, "chart2": {"proportion": [0.42857142857142855, 0.5331991951710262, 0.545271629778672, 0.40040241448692154, 0.32796780684104626, 0.30784708249496984, 0.2837022132796781, 0.20724346076458752, 0.10663983903420524, 0.15492957746478872, 0.0744466800804829, -0.16297786720321933, -0.06639839034205232, 0.23943661971830985, 0.22736418511066397, 0.2515090543259557, -0.002012072434607646, 0.03822937625754527, -0.10261569416498995, -0.014084507042253521, -0.08249496981891348, -0.5331991951710262, -0.6740442655935613, -0.44064386317907445, -0.323943661971831, -0.4969818913480885, -0.6257545271629779, -0.4688128772635815, -0.45271629778672035, -0.5895372233400402, -0.5734406438631791, -0.7183098591549296, -0.5412474849094567, -0.47283702213279677, -0.29577464788732394, -0.32796780684104626, -0.014084507042253521, 0.2635814889336016, 0.3199195171026157, 0.24346076458752516, 0.022132796780684104, 0.09859154929577464, -0.3963782696177062, -0.5653923541247485, -0.5653923541247485, -0.2193158953722334, -0.026156941649899398, 0.22334004024144868, -0.13883299798792756, -0.11468812877263582, -0.03420523138832998, 0.014084507042253521, 0.3038229376257545, 0.32796780684104626, 0.34808853118712274, 0.42052313883299797, 0.5573440643863179, 0.5734406438631791, 0.6016096579476862, 0.43661971830985913, 0.13480885311871227, -0.022132796780684104, -0.23138832997987926, -0.4044265593561368, -0.7746478873239436, -0.6659959758551308, -0.5492957746478874, -0.28772635814889336, -0.06639839034205232, -0.002012072434607646, 0.03822937625754527, -0.20321931589537223, -0.01006036217303823, 0.1267605633802817, -0.07847082494969819, -0.34808853118712274, -0.05030181086519115, 0.1267605633802817, -0.014084507042253521, 0.08651911468812877, 0.27419354838709675, 0.14516129032258066, 0.036290322580645164, 0.15725806451612903, 0.06854838709677419, 0.3709677419354839, 0.24193548387096775, -0.04435483870967742, 0.11290322580645161, -0.10887096774193548], "e9_proportion": [0.42857142857142855, 0.4494969818913481, 0.4686519114688129, 0.4550020120724346, 0.42959517102615696, 0.4052455533199195, 0.38093688531187125, 0.34619820040241456, 0.2982865281287727, 0.2696151379959759, 0.2305814464128773, 0.151869583689658, 0.10821598888331595, 0.13446011505031474, 0.1530409290623846, 0.1727345541150988, 0.13778522880515753, 0.11787405829563509, 0.07377610780351009, 0.056203984834357366, 0.0284641939037032, -0.08386848391124269, -0.2019036402477064, -0.24965168483398004, -0.26451008026155026, -0.31100444247885795, -0.37395445941568195, -0.3929261429852619, -0.40488417394555365, -0.441814783824451, -0.4681399558321966, -0.5181739364967433, -0.522788646179286, -0.5127983213699883, -0.46939358667345543, -0.44110843070697364, -0.35570364597402965, -0.23184661899250342, -0.1214933917734796, -0.04850256050127866, -0.03437548904488611, -0.007782081376753958, -0.08550131902494441, -0.18147952604490525, -0.2582620916608739, -0.2504728524031458, -0.20560967025249655, -0.1198197281537075, -0.12362238212055152, -0.12183553145096838, -0.1043094714384407, -0.08063067574230187, -0.003739953068690599, 0.06260159891325677, 0.11969898536802998, 0.17986381606102358, 0.25535986572608244, 0.3189760213535018, 0.3755027486723387, 0.3877261425998428, 0.3371426847036167, 0.26528758840675654, 0.16595240472942938, 0.05187661191231614, -0.11342828793493584, -0.22394182551897485, -0.28901261534475736, -0.2887553639055846, -0.24428396919287815, -0.19582958984122406, -0.1490177966214702, -0.1598581004762506, -0.12989855281560814, -0.07856672957643018, -0.07854754865108379, -0.1324557451582916, -0.11602495829967151, -0.06746785396368088, -0.056791184579395415, -0.02812912472589058, 0.03233540989670689, 0.05490058598188165, 0.051178533301634355, 0.0723944395445333, 0.07162522905498148, 0.13149373163108197, 0.15358208207905913, 0.11399469792131182, 0.11377640349833978, 0.06924692925028474]}, "chart3": {"abvEMA": [355, 381, 384, 348, 330, 325, 319, 300, 275, 287, 267, 208, 232, 308, 305, 311, 248, 258, 223, 245, 228, 116, 81, 139, 168, 125, 93, 132, 136, 102, 106, 70, 114, 131, 175, 167, 245, 314, 328, 309, 254, 273, 150, 108, 108, 194, 242, 304, 214, 220, 240, 252, 324, 330, 335, 353, 387, 391, 398, 357, 282, 243, 191, 148, 56, 83, 112, 177, 232, 248, 258, 198, 246, 280, 229, 162, 236, 280, 245, 270, 316, 284, 257, 287, 265, 340, 308, 237, 276, 221], "belEMA": [142, 116, 113, 149, 167, 172, 178, 197, 222, 210, 230, 289, 265, 189, 192, 186, 249, 239, 274, 252, 269, 381, 416, 358, 329, 372, 404, 365, 361, 395, 391, 427, 383, 366, 322, 330, 252, 183, 169, 188, 243, 224, 347, 389, 389, 303, 255, 193, 283, 277, 257, 245, 173, 167, 162, 144, 110, 106, 99, 140, 215, 254, 306, 349, 441, 414, 385, 320, 265, 249, 239, 299, 251, 217, 268, 335, 261, 217, 252, 227, 180, 212, 239, 209, 231, 156, 188, 259, 220, 275], "e9AbvEMA": [355.0, 360.2, 364.96000000000004, 361.56800000000004, 355.25440000000003, 349.20352, 343.162816, 334.5302528, 322.62420224000005, 315.49936179200006, 305.79948943360006, 286.2395915468801, 275.39167323750405, 281.91333859000326, 286.5306708720026, 291.4245366976021, 282.7396293580817, 277.7917034864654, 266.8333627891723, 262.4666902313379, 255.57335218507032, 227.65868174805627, 198.32694539844502, 186.46155631875604, 182.76924505500483, 171.21539604400388, 155.5723168352031, 150.8578534681625, 147.88628277453, 138.709026219624, 132.1672209756992, 119.73377678055937, 118.5870214244475, 121.069617139558, 131.8556937116464, 138.88455496931712, 160.1076439754537, 190.88611518036296, 218.30889214429038, 236.44711371543232, 239.9576909723459, 246.5661527778767, 227.25292222230138, 203.4023377778411, 184.32187022227288, 186.25749617781833, 197.40599694225466, 218.72479755380374, 217.77983804304301, 218.22387043443442, 222.57909634754753, 228.46327707803803, 247.57062166243043, 264.05649732994436, 278.24519786395547, 293.1961582911644, 311.9569266329315, 327.76554130634526, 341.81243304507626, 344.84994643606103, 332.2799571488489, 314.42396571907915, 289.73917257526335, 261.3913380602107, 220.3130704481686, 192.85045635853487, 176.68036508682792, 176.74429206946235, 187.7954336555699, 199.8363469244559, 211.46907753956472, 208.77526203165178, 216.22020962532144, 228.97616770025718, 228.98093416020578, 215.58474732816464, 219.6677978625317, 231.73423829002536, 234.3873906320203, 241.50991250561626, 256.40793000449304, 261.92634400359447, 260.9410752028756, 266.1528601623005, 265.9222881298404, 280.7378305038724, 286.1902644030979, 276.35221152247834, 276.2817692179827, 265.22541537438616], "netStocks": [497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496]}};
    </script>
    <script>
        
        (function() {
            const chartInstances = {};
            let isSyncing = false;

            document.querySelectorAll('.reset-zoom-btn').forEach(button => {
                button.addEventListener('click', (e) => {
                    const chartId = e.target.getAttribute('data-chart-id');
                    if (chartInstances[chartId]) {
                        chartInstances[chartId].resetZoom();
                    }
                });
            });

            function syncCharts(sourceChart) {
                if (isSyncing) return;
                isSyncing = true;
                const { min, max } = sourceChart.scales.x;
                for (const chartId in chartInstances) {
                    const targetChart = chartInstances[chartId];
                    if (targetChart.canvas.id !== sourceChart.canvas.id) {
                        targetChart.options.scales.x.min = min;
                        targetChart.options.scales.x.max = max;
                        targetChart.update('none');
                    }
                }
                isSyncing = false;
            }

            function createCharts(data) {
                const computedStyles = getComputedStyle(document.body);
                const colors = {
                    green: computedStyles.getPropertyValue('--green').trim(), red: computedStyles.getPropertyValue('--red').trim(),
                    blue: computedStyles.getPropertyValue('--blue').trim(), cyan: computedStyles.getPropertyValue('--cyan').trim(),
                    yellow: computedStyles.getPropertyValue('--yellow').trim(), magenta: computedStyles.getPropertyValue('--magenta').trim(),
                    text: computedStyles.getPropertyValue('--text-color').trim(), grid: computedStyles.getPropertyValue('--border-color').trim() + '80',
                };
                const commonOptions = {
                    responsive: true, maintainAspectRatio: false,
                    scales: {
                        x: { grid: { color: colors.grid }, ticks: { color: colors.text, maxRotation: 0, autoSkip: true, maxTicksLimit: 15 }, grace: '5%' },
                        y: { grid: { color: colors.grid }, ticks: { color: colors.text } }
                    },
                    plugins: {
                        legend: { labels: { color: colors.text, font: { size: 14 } } },
                        tooltip: {
                            backgroundColor: computedStyles.getPropertyValue('--card-bg-color').trim(),
                            titleFont: { size: 16 }, bodyFont: { size: 14 }, padding: 10,
                            borderColor: colors.grid, borderWidth: 1, titleColor: colors.text, bodyColor: colors.text,
                        },
                        zoom: {
                            pan: { enabled: true, mode: 'x', onPanComplete: ({ chart }) => syncCharts(chart) },
                            zoom: {
                                drag: { enabled: false },
                                wheel: { enabled: true }, 
                                pinch: { enabled: true },
                                mode: 'x',
                                onZoomComplete: ({ chart }) => syncCharts(chart)
                            }
                        }
                    },
                    elements: { point: { radius: 0 } },
                    interaction: { intersect: false, mode: 'index' }
                };
                const chartHeight = 450;
                document.querySelectorAll('.chart-card canvas').forEach(c => c.parentElement.style.height = chartHeight + 'px');
                
                chartInstances.chart1 = new Chart(document.getElementById('chart1'), { type: 'line', data: { labels: data.labels, datasets: [{ label: 'Trend Of Stks', data: data.chart1.trendOfStocks, borderColor: colors.magenta, borderWidth: 2, tension: 0.1 }, { label: 'e9 (EMA)', data: data.chart1.e9_trendOfStocks, borderColor: colors.blue, borderWidth: 2, tension: 0.1 }] }, options: commonOptions });
                chartInstances.chart2 = new Chart(document.getElementById('chart2'), { type: 'line', data: { labels: data.labels, datasets: [{ label: 'Proportion', data: data.chart2.proportion, borderColor: colors.yellow, borderWidth: 2, tension: 0.1 }, { label: 'e9 (EMA)', data: data.chart2.e9_proportion, borderColor: colors.blue, borderWidth: 2, tension: 0.1 }] }, options: commonOptions });
                chartInstances.chart3 = new Chart(document.getElementById('chart3'), { type: 'line', data: { labels: data.labels, datasets: [{ label: 'Stocks Above EMA', data: data.chart3.abvEMA, borderColor: colors.green, borderWidth: 2, tension: 0.1 }, { label: 'Stocks Below EMA', data: data.chart3.belEMA, borderColor: colors.red, borderWidth: 2, tension: 0.1 }, { label: 'Net Stocks', data: data.chart3.netStocks, borderColor: colors.text, borderWidth: 1, tension: 0.1, borderDash: [5, 5] }] }, options: commonOptions });
            }
            createCharts(window.chartData);
        })();
    
    </script>
</body>
</html>