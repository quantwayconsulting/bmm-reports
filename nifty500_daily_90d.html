<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nifty 500 - Broad Market Monitor</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/hammer.js/2.0.8/hammer.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-zoom@2.0.1/dist/chartjs-plugin-zoom.min.js"></script>
    <style>
        :root { --bg-color: #1a1b26; --card-bg-color: #24283b; --text-color: #c0caf5; --text-secondary-color: #a9b1d6; --border-color: #414868; --primary-color: #7aa2f7; --green: #9ece6a; --red: #f7768e; --blue: #7aa2f7; --cyan: #7dcfff; --yellow: #e0af68; --magenta: #bb9af7; }
        body[data-theme="bloomberg"] { --bg-color: #0d0d0d; --card-bg-color: #1a1a1a; --text-color: #e0e0e0; --text-secondary-color: #a0a0a0; --border-color: #333333; --primary-color: #ff9900; --green: #00e676; --red: #ff5252; --blue: #2979ff; --cyan: #00e5ff; --yellow: #ffd600; --magenta: #d500f9; }
        body[data-theme="light"] { --bg-color: #f5f7fa; --card-bg-color: #ffffff; --text-color: #1c2a42; --text-secondary-color: #5b6b85; --border-color: #e6e9f0; --primary-color: #0052cc; --green: #00875a; --red: #bf2600; --blue: #0052cc; --cyan: #00a3bf; --yellow: #ffab00; --magenta: #6554c0; }
        body { font-family: 'Segoe UI', 'Roboto', 'Helvetica', sans-serif; background-color: var(--bg-color); color: var(--text-color); margin: 0; padding: 10px; }
        .container { max-width: 1600px; margin: auto; }
        header { text-align: center; margin-bottom: 25px; border-bottom: 1px solid var(--border-color); padding-bottom: 20px; }
        h1 { font-size: 1.5rem; color: var(--text-color); margin: 0 0 5px 0; }
        h2 { margin: 0; color: var(--text-secondary-color); font-weight: 500; font-size: 1rem; }
        .card { background-color: var(--card-bg-color); border: 1px solid var(--border-color); border-radius: 8px; padding: 20px; margin-bottom: 20px; }
        .chart-header { display: flex; flex-direction: column; align-items: flex-start; gap: 10px; border-bottom: 1px solid var(--border-color); padding-bottom: 15px; margin-bottom: 15px; }
        .chart-title { font-size: 1.1rem; color: var(--text-secondary-color); font-weight: 500; }
        .zoom-hint { font-size: 0.8rem; font-style: italic; color: #6c707a; }
        .reset-zoom-btn { background: none; border: 1px solid var(--border-color); color: var(--text-secondary-color); padding: 5px 10px; border-radius: 4px; cursor: pointer; }
        @media (min-width: 600px) { 
            h1 {font-size: 1.8rem;} h2 {font-size: 1.2rem;}
            .chart-header { flex-direction: row; justify-content: space-between; align-items: center;}
        }
    </style>
</head>
<body data-theme="bloomberg">
    <div class="container">
        <header>
            <h1>Nifty 500</h1>
            <h2>Timeframe: Daily | Lookback: 90 Periods</h2>
        </header>
        <div id="charts">
            <div class="card chart-card"><div class="chart-header"><span class="chart-title">Market Trend (Sum)</span><div><span class="zoom-hint">Scroll/Drag to Zoom</span> <button class="reset-zoom-btn" data-chart-id="chart1">Reset</button></div></div><canvas id="chart1"></canvas></div>
            <div class="card chart-card"><div class="chart-header"><span class="chart-title">Market Proportion</span><div><span class="zoom-hint">Scroll/Drag to Zoom</span> <button class="reset-zoom-btn" data-chart-id="chart2">Reset</button></div></div><canvas id="chart2"></canvas></div>
            <div class="card chart-card"><div class="chart-header"><span class="chart-title">Market Breadth</span><div><span class="zoom-hint">Scroll/Drag to Zoom</span> <button class="reset-zoom-btn" data-chart-id="chart3">Reset</button></div></div><canvas id="chart3"></canvas></div>
        </div>
    </div>
    <script>
        window.chartData = {"labels": ["2025-08-01", "2025-08-04", "2025-08-05", "2025-08-06", "2025-08-07", "2025-08-08", "2025-08-11", "2025-08-12", "2025-08-13", "2025-08-14", "2025-08-18", "2025-08-19", "2025-08-20", "2025-08-21", "2025-08-22", "2025-08-25", "2025-08-26", "2025-08-28", "2025-08-29", "2025-09-01", "2025-09-02", "2025-09-03", "2025-09-04", "2025-09-05", "2025-09-08", "2025-09-09", "2025-09-10", "2025-09-11", "2025-09-12", "2025-09-15", "2025-09-16", "2025-09-17", "2025-09-18", "2025-09-19", "2025-09-22", "2025-09-23", "2025-09-24", "2025-09-25", "2025-09-26", "2025-09-29", "2025-09-30", "2025-10-01", "2025-10-03", "2025-10-06", "2025-10-07", "2025-10-08", "2025-10-09", "2025-10-10", "2025-10-13", "2025-10-14", "2025-10-15", "2025-10-16", "2025-10-17", "2025-10-20", "2025-10-21", "2025-10-23", "2025-10-24", "2025-10-27", "2025-10-28", "2025-10-29", "2025-10-30", "2025-10-31", "2025-11-03", "2025-11-04", "2025-11-06", "2025-11-07", "2025-11-10", "2025-11-11", "2025-11-12", "2025-11-13", "2025-11-14", "2025-11-17", "2025-11-18", "2025-11-19", "2025-11-20", "2025-11-21", "2025-11-24", "2025-11-25", "2025-11-26", "2025-11-27", "2025-11-28", "2025-12-01", "2025-12-02", "2025-12-03", "2025-12-04", "2025-12-05", "2025-12-08", "2025-12-09", "2025-12-10", "2025-12-11"], "chart1": {"trendOfStocks": [-310, -232, -224, -292, -284, -356, -268, -234, -148, -162, -4, 132, 162, 122, 12, 50, -196, -278, -278, -108, -12, 112, -68, -56, -16, 8, 152, 166, 176, 212, 284, 288, 304, 218, 70, -8, -112, -198, -382, -326, -270, -140, -30, 6, 26, -96, 2, 68, -34, -168, -18, 68, 0, 52, 144, 78, 20, 82, 38, 184, 118, -22, 58, -52, -208, -170, -120, -110, -8, -64, -70, 28, -102, -106, -128, -264, -266, -244, -64, -122, -104, -120, -172, -208, -204, -184, -358, -266, -286, -212], "e9_trendOfStocks": [-310.0, -294.4, -280.32, -282.656, -282.9248, -297.53984, -291.63187200000004, -280.10549760000004, -253.68439808000002, -235.34751846400005, -189.07801477120006, -124.86241181696005, -67.48992945356804, -29.59194356285443, -21.273554850283546, -7.018843880226836, -44.815075104181474, -91.45206008334517, -128.76164806667614, -124.60931845334093, -102.08745476267276, -59.26996381013821, -61.01597104811057, -60.01277683848846, -51.21022147079078, -39.36817717663262, -1.0945417413060952, 32.324366606955124, 61.0594932855641, 91.24759462845128, 129.79807570276103, 161.43846056220883, 189.95076844976708, 195.56061475981366, 170.44849180785093, 134.75879344628075, 85.4070347570246, 28.725627805619688, -53.41949775550425, -107.9355982044034, -140.34847856352275, -140.2787828508182, -118.22302628065457, -93.37842102452366, -69.50273681961893, -74.80218945569516, -59.44175156455613, -33.953401251644905, -33.96272100131593, -60.77017680105274, -52.2161414408422, -28.172913152673765, -22.538330522139013, -7.630664417711211, 22.69546846583103, 33.75637477266483, 31.005099818131864, 41.204079854505494, 40.5632638836044, 69.25061110688353, 79.00048888550683, 58.800391108405464, 58.640312886724374, 36.5122503093795, -12.390199752496397, -43.91215980199712, -59.1297278415977, -69.30378227327816, -57.04302581862253, -58.434420654898034, -60.74753652391843, -42.99802921913474, -54.79842337530779, -65.03873870024624, -77.630990960197, -114.9047927681576, -145.12383421452608, -164.89906737162087, -144.7192538972967, -140.17540311783736, -132.9403224942699, -130.35225799541593, -138.68180639633275, -152.5454451170662, -162.83635609365297, -167.0690848749224, -205.2552678999379, -217.4042143199503, -231.12337145596024, -227.2986971647682]}, "chart2": {"proportion": [-0.625, -0.46774193548387094, -0.45161290322580644, -0.5887096774193549, -0.5725806451612904, -0.717741935483871, -0.5403225806451613, -0.4717741935483871, -0.29838709677419356, -0.32661290322580644, -0.008064516129032258, 0.2661290322580645, 0.32661290322580644, 0.24596774193548387, 0.024193548387096774, 0.10080645161290322, -0.3951612903225806, -0.5604838709677419, -0.5604838709677419, -0.21774193548387097, -0.024193548387096774, 0.22580645161290322, -0.13709677419354838, -0.11290322580645161, -0.03225806451612903, 0.016129032258064516, 0.3064516129032258, 0.3346774193548387, 0.3548387096774194, 0.4274193548387097, 0.5725806451612904, 0.5806451612903226, 0.6129032258064516, 0.43951612903225806, 0.14112903225806453, -0.016129032258064516, -0.22580645161290322, -0.39919354838709675, -0.7701612903225806, -0.657258064516129, -0.5443548387096774, -0.28225806451612906, -0.06048387096774194, 0.012096774193548387, 0.05241935483870968, -0.1935483870967742, 0.004032258064516129, 0.13709677419354838, -0.06854838709677419, -0.3387096774193548, -0.036290322580645164, 0.13709677419354838, 0.0, 0.10483870967741936, 0.2903225806451613, 0.15725806451612903, 0.04032258064516129, 0.16532258064516128, 0.07661290322580645, 0.3709677419354839, 0.23790322580645162, -0.04435483870967742, 0.11693548387096774, -0.10483870967741936, -0.41935483870967744, -0.34274193548387094, -0.24193548387096775, -0.2217741935483871, -0.016129032258064516, -0.12903225806451613, -0.14112903225806453, 0.056451612903225805, -0.2056451612903226, -0.21370967741935484, -0.25806451612903225, -0.532258064516129, -0.5362903225806451, -0.49193548387096775, -0.12903225806451613, -0.24596774193548387, -0.20967741935483872, -0.24193548387096775, -0.3467741935483871, -0.41935483870967744, -0.4112903225806452, -0.3709677419354839, -0.7217741935483871, -0.5362903225806451, -0.5766129032258065, -0.4274193548387097], "e9_proportion": [-0.625, -0.5935483870967742, -0.5651612903225807, -0.5698709677419356, -0.5704129032258065, -0.5998787096774194, -0.5879674838709678, -0.5647288258064517, -0.5114604800000001, -0.4744909646451614, -0.3812056749419356, -0.2517387335019356, -0.1360684061563872, -0.059661176538013005, -0.04289023155299106, -0.0141508949198122, -0.0903529740003659, -0.1843791533938411, -0.2596000969086213, -0.2512284646236712, -0.20582148137635634, -0.11949589477850442, -0.12301607066151322, -0.12099350169050091, -0.10324641425562654, -0.07937132495288834, -0.002206737381665519, 0.06517009396563533, 0.12310381710799215, 0.18396692465413567, 0.26168966875556665, 0.32548076726251784, 0.3829652589713046, 0.3942754329834953, 0.34364615283840916, 0.2716911158191144, 0.1721916023327109, 0.057914572188749375, -0.10770060031351664, -0.21761209315403912, -0.2829606422651668, -0.2828201267153593, -0.23835287556583581, -0.18826294561395898, -0.14012648552342524, -0.15081086583809505, -0.11984224105757282, -0.06845443800734859, -0.06847322782523371, -0.12252051774405794, -0.1052744787113754, -0.05680022813039064, -0.04544018250431251, -0.01538440406796614, 0.045756992874659355, 0.0680572072029533, 0.0625102818913949, 0.08307274164214819, 0.08178077395887984, 0.13961816755420065, 0.15927517920465084, 0.1185491756217852, 0.11822643727162171, 0.0736134078818135, -0.024980241436484682, -0.08853258024596193, -0.1192131609709631, -0.13972536748644793, -0.11500610044077124, -0.11781133196552022, -0.1224748720240291, -0.08668957503857812, -0.11048069228892703, -0.1311264893150126, -0.15651409467781655, -0.23166288864547904, -0.29258837543251226, -0.3324577971202034, -0.29177268930906597, -0.28261169983434953, -0.26802484373844737, -0.26280697176495144, -0.27960041612163855, -0.30755130063924635, -0.32829910502752613, -0.3368328324091177, -0.41382110463697164, -0.4383149482257063, -0.4659745392257264, -0.4582635023483231]}, "chart3": {"abvEMA": [93, 132, 136, 102, 106, 70, 114, 131, 174, 167, 246, 314, 329, 309, 254, 273, 150, 109, 109, 194, 242, 304, 214, 220, 240, 252, 324, 331, 336, 354, 390, 392, 400, 357, 283, 244, 192, 149, 57, 85, 113, 178, 233, 251, 261, 200, 249, 282, 231, 164, 239, 282, 248, 274, 320, 287, 258, 289, 267, 340, 307, 237, 277, 222, 144, 163, 188, 193, 244, 216, 213, 262, 197, 195, 184, 116, 115, 126, 216, 187, 196, 188, 162, 144, 146, 156, 69, 115, 105, 142], "belEMA": [403, 364, 360, 394, 390, 426, 382, 365, 322, 329, 250, 182, 167, 187, 242, 223, 346, 387, 387, 302, 254, 192, 282, 276, 256, 244, 172, 165, 160, 142, 106, 104, 96, 139, 213, 252, 304, 347, 439, 411, 383, 318, 263, 245, 235, 296, 247, 214, 265, 332, 257, 214, 248, 222, 176, 209, 238, 207, 229, 156, 189, 259, 219, 274, 352, 333, 308, 303, 252, 280, 283, 234, 299, 301, 312, 380, 381, 370, 280, 309, 300, 308, 334, 352, 350, 340, 427, 381, 391, 354], "e9AbvEMA": [93.0, 100.80000000000001, 107.84000000000002, 106.67200000000003, 106.53760000000003, 99.23008000000003, 102.18406400000002, 107.94725120000003, 121.15780096000003, 130.32624076800002, 153.46099261440003, 185.56879409152003, 214.25503527321604, 233.20402821857286, 237.3632225748583, 244.49057805988664, 225.59246244790933, 202.27396995832748, 183.619175966662, 185.6953407733296, 196.9562726186637, 218.36501809493097, 217.4920144759448, 217.99361158075587, 222.3948892646047, 228.31591141168377, 247.452729129347, 264.1621833034776, 278.5297466427821, 293.62379731422567, 312.8990378513805, 328.7192302811044, 342.9753842248835, 345.78030737990684, 333.2242459039255, 315.3793967231404, 290.70351737851234, 262.3628139028099, 221.29025112224792, 194.03220089779836, 177.82576071823868, 177.86060857459094, 188.88848685967275, 201.3107894877382, 213.24863159019054, 210.59890527215245, 218.27912421772197, 231.02329937417758, 231.0186394993421, 217.61491159947371, 221.891929279579, 233.9135434236632, 236.73083473893058, 244.18466779114448, 259.3477342329156, 264.8781873863325, 263.50254990906603, 268.60203992725286, 268.2816319418023, 282.6253055534419, 287.5002444427535, 277.4001955542028, 277.3201564433623, 266.2561251546898, 241.80490012375188, 226.0439200990015, 218.43513607920121, 213.34810886336098, 219.47848709068882, 218.78278967255108, 217.62623173804087, 226.5009853904327, 220.60078831234617, 215.48063064987696, 209.1845045199016, 190.54760361592128, 175.43808289273701, 165.55046631418963, 175.64037305135173, 177.9122984410814, 181.52983875286515, 182.82387100229212, 178.6590968018337, 171.72727744146698, 166.58182195317357, 164.46545756253886, 145.3723660500311, 139.29789284002487, 132.4383142720199, 134.35065141761592], "netStocks": [496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496]}};
    </script>
    <script>
        
        (function() {
            const chartInstances = {};
            let isSyncing = false;

            document.querySelectorAll('.reset-zoom-btn').forEach(button => {
                button.addEventListener('click', (e) => {
                    const chartId = e.target.getAttribute('data-chart-id');
                    if (chartInstances[chartId]) {
                        chartInstances[chartId].resetZoom();
                    }
                });
            });

            function syncCharts(sourceChart) {
                if (isSyncing) return;
                isSyncing = true;
                const { min, max } = sourceChart.scales.x;
                for (const chartId in chartInstances) {
                    const targetChart = chartInstances[chartId];
                    if (targetChart.canvas.id !== sourceChart.canvas.id) {
                        targetChart.options.scales.x.min = min;
                        targetChart.options.scales.x.max = max;
                        targetChart.update('none');
                    }
                }
                isSyncing = false;
            }

            function createCharts(data) {
                const computedStyles = getComputedStyle(document.body);
                const colors = {
                    green: computedStyles.getPropertyValue('--green').trim(), red: computedStyles.getPropertyValue('--red').trim(),
                    blue: computedStyles.getPropertyValue('--blue').trim(), cyan: computedStyles.getPropertyValue('--cyan').trim(),
                    yellow: computedStyles.getPropertyValue('--yellow').trim(), magenta: computedStyles.getPropertyValue('--magenta').trim(),
                    text: computedStyles.getPropertyValue('--text-color').trim(), grid: computedStyles.getPropertyValue('--border-color').trim() + '80',
                };
                const commonOptions = {
                    responsive: true, maintainAspectRatio: false,
                    scales: {
                        x: { grid: { color: colors.grid }, ticks: { color: colors.text, maxRotation: 0, autoSkip: true, maxTicksLimit: 15 }, grace: '5%' },
                        y: { grid: { color: colors.grid }, ticks: { color: colors.text } }
                    },
                    plugins: {
                        legend: { labels: { color: colors.text, font: { size: 14 } } },
                        tooltip: {
                            backgroundColor: computedStyles.getPropertyValue('--card-bg-color').trim(),
                            titleFont: { size: 16 }, bodyFont: { size: 14 }, padding: 10,
                            borderColor: colors.grid, borderWidth: 1, titleColor: colors.text, bodyColor: colors.text,
                        },
                        zoom: {
                            pan: { enabled: true, mode: 'x', onPanComplete: ({ chart }) => syncCharts(chart) },
                            zoom: {
                                drag: { enabled: false },
                                wheel: { enabled: true }, 
                                pinch: { enabled: true },
                                mode: 'x',
                                onZoomComplete: ({ chart }) => syncCharts(chart)
                            }
                        }
                    },
                    elements: { point: { radius: 0 } },
                    interaction: { intersect: false, mode: 'index' }
                };
                const chartHeight = 450;
                document.querySelectorAll('.chart-card canvas').forEach(c => c.parentElement.style.height = chartHeight + 'px');
                
                chartInstances.chart1 = new Chart(document.getElementById('chart1'), { type: 'line', data: { labels: data.labels, datasets: [{ label: 'Trend Of Stks', data: data.chart1.trendOfStocks, borderColor: colors.magenta, borderWidth: 2, tension: 0.1 }, { label: 'e9 (EMA)', data: data.chart1.e9_trendOfStocks, borderColor: colors.blue, borderWidth: 2, tension: 0.1 }] }, options: commonOptions });
                chartInstances.chart2 = new Chart(document.getElementById('chart2'), { type: 'line', data: { labels: data.labels, datasets: [{ label: 'Proportion', data: data.chart2.proportion, borderColor: colors.yellow, borderWidth: 2, tension: 0.1 }, { label: 'e9 (EMA)', data: data.chart2.e9_proportion, borderColor: colors.blue, borderWidth: 2, tension: 0.1 }] }, options: commonOptions });
                chartInstances.chart3 = new Chart(document.getElementById('chart3'), { type: 'line', data: { labels: data.labels, datasets: [{ label: 'Stocks Above EMA', data: data.chart3.abvEMA, borderColor: colors.green, borderWidth: 2, tension: 0.1 }, { label: 'Stocks Below EMA', data: data.chart3.belEMA, borderColor: colors.red, borderWidth: 2, tension: 0.1 }, { label: 'Net Stocks', data: data.chart3.netStocks, borderColor: colors.text, borderWidth: 1, tension: 0.1, borderDash: [5, 5] }] }, options: commonOptions });
            }
            createCharts(window.chartData);
        })();
    
    </script>
</body>
</html>