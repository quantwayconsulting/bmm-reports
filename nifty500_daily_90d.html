<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nifty 500 - Broad Market Monitor</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/hammer.js/2.0.8/hammer.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-zoom@2.0.1/dist/chartjs-plugin-zoom.min.js"></script>
    <style>
        :root { --bg-color: #1a1b26; --card-bg-color: #24283b; --text-color: #c0caf5; --text-secondary-color: #a9b1d6; --border-color: #414868; --primary-color: #7aa2f7; --green: #9ece6a; --red: #f7768e; --blue: #7aa2f7; --cyan: #7dcfff; --yellow: #e0af68; --magenta: #bb9af7; }
        body[data-theme="bloomberg"] { --bg-color: #0d0d0d; --card-bg-color: #1a1a1a; --text-color: #e0e0e0; --text-secondary-color: #a0a0a0; --border-color: #333333; --primary-color: #ff9900; --green: #00e676; --red: #ff5252; --blue: #2979ff; --cyan: #00e5ff; --yellow: #ffd600; --magenta: #d500f9; }
        body[data-theme="light"] { --bg-color: #f5f7fa; --card-bg-color: #ffffff; --text-color: #1c2a42; --text-secondary-color: #5b6b85; --border-color: #e6e9f0; --primary-color: #0052cc; --green: #00875a; --red: #bf2600; --blue: #0052cc; --cyan: #00a3bf; --yellow: #ffab00; --magenta: #6554c0; }
        body { font-family: 'Segoe UI', 'Roboto', 'Helvetica', sans-serif; background-color: var(--bg-color); color: var(--text-color); margin: 0; padding: 10px; }
        .container { max-width: 1600px; margin: auto; }
        header { text-align: center; margin-bottom: 25px; border-bottom: 1px solid var(--border-color); padding-bottom: 20px; }
        h1 { font-size: 1.5rem; color: var(--text-color); margin: 0 0 5px 0; }
        h2 { margin: 0; color: var(--text-secondary-color); font-weight: 500; font-size: 1rem; }
        .card { background-color: var(--card-bg-color); border: 1px solid var(--border-color); border-radius: 8px; padding: 20px; margin-bottom: 20px; }
        .chart-header { display: flex; flex-direction: column; align-items: flex-start; gap: 10px; border-bottom: 1px solid var(--border-color); padding-bottom: 15px; margin-bottom: 15px; }
        .chart-title { font-size: 1.1rem; color: var(--text-secondary-color); font-weight: 500; }
        .zoom-hint { font-size: 0.8rem; font-style: italic; color: #6c707a; }
        .reset-zoom-btn { background: none; border: 1px solid var(--border-color); color: var(--text-secondary-color); padding: 5px 10px; border-radius: 4px; cursor: pointer; }
        @media (min-width: 600px) { 
            h1 {font-size: 1.8rem;} h2 {font-size: 1.2rem;}
            .chart-header { flex-direction: row; justify-content: space-between; align-items: center;}
        }
    </style>
</head>
<body data-theme="bloomberg">
    <div class="container">
        <header>
            <h1>Nifty 500</h1>
            <h2>Timeframe: Daily | Lookback: 90 Periods</h2>
        </header>
        <div id="charts">
            <div class="card chart-card"><div class="chart-header"><span class="chart-title">Market Trend (Sum)</span><div><span class="zoom-hint">Scroll/Drag to Zoom</span> <button class="reset-zoom-btn" data-chart-id="chart1">Reset</button></div></div><canvas id="chart1"></canvas></div>
            <div class="card chart-card"><div class="chart-header"><span class="chart-title">Market Proportion</span><div><span class="zoom-hint">Scroll/Drag to Zoom</span> <button class="reset-zoom-btn" data-chart-id="chart2">Reset</button></div></div><canvas id="chart2"></canvas></div>
            <div class="card chart-card"><div class="chart-header"><span class="chart-title">Market Breadth</span><div><span class="zoom-hint">Scroll/Drag to Zoom</span> <button class="reset-zoom-btn" data-chart-id="chart3">Reset</button></div></div><canvas id="chart3"></canvas></div>
        </div>
    </div>
    <script>
        window.chartData = {"labels": ["2025-07-07", "2025-07-08", "2025-07-09", "2025-07-10", "2025-07-11", "2025-07-14", "2025-07-15", "2025-07-16", "2025-07-17", "2025-07-18", "2025-07-21", "2025-07-22", "2025-07-23", "2025-07-24", "2025-07-25", "2025-07-28", "2025-07-29", "2025-07-30", "2025-07-31", "2025-08-01", "2025-08-04", "2025-08-05", "2025-08-06", "2025-08-07", "2025-08-08", "2025-08-11", "2025-08-12", "2025-08-13", "2025-08-14", "2025-08-18", "2025-08-19", "2025-08-20", "2025-08-21", "2025-08-22", "2025-08-25", "2025-08-26", "2025-08-28", "2025-08-29", "2025-09-01", "2025-09-02", "2025-09-03", "2025-09-04", "2025-09-05", "2025-09-08", "2025-09-09", "2025-09-10", "2025-09-11", "2025-09-12", "2025-09-15", "2025-09-16", "2025-09-17", "2025-09-18", "2025-09-19", "2025-09-22", "2025-09-23", "2025-09-24", "2025-09-25", "2025-09-26", "2025-09-29", "2025-09-30", "2025-10-01", "2025-10-03", "2025-10-06", "2025-10-07", "2025-10-08", "2025-10-09", "2025-10-10", "2025-10-13", "2025-10-14", "2025-10-15", "2025-10-16", "2025-10-17", "2025-10-20", "2025-10-21", "2025-10-23", "2025-10-24", "2025-10-27", "2025-10-28", "2025-10-29", "2025-10-30", "2025-10-31", "2025-11-03", "2025-11-04", "2025-11-06", "2025-11-07", "2025-11-10", "2025-11-11", "2025-11-12", "2025-11-13", "2025-11-14"], "chart1": {"trendOfStocks": [105, 57, 81, 41, -79, -31, 121, 115, 125, 3, 25, -49, -3, -35, -265, -333, -217, -161, -247, -311, -233, -225, -293, -285, -357, -269, -235, -147, -161, -3, 133, 163, 123, 13, 51, -195, -279, -279, -107, -11, 113, -67, -55, -15, 9, 153, 167, 177, 213, 285, 289, 305, 219, 69, -9, -113, -199, -383, -327, -271, -139, -29, 7, 25, -97, 1, 67, -35, -169, -19, 67, -1, 51, 144, 78, 20, 82, 38, 186, 122, -22, 58, -54, -208, -170, -120, -112, -8, -64, -70], "e9_trendOfStocks": [105.0, 95.4, 92.52000000000001, 82.21600000000001, 49.97280000000001, 33.778240000000004, 51.222592000000006, 63.97807360000001, 76.18245888000001, 61.54596710400001, 54.23677368320001, 33.589418946560016, 26.271535157248014, 14.017228125798411, -41.78621749936127, -100.02897399948903, -123.42317919959123, -130.938543359673, -154.1508346877384, -185.52066775019074, -195.0165342001526, -201.01322736012207, -219.41058188809765, -232.52846551047813, -257.4227724083825, -259.738217926706, -254.79057434136482, -233.23245947309186, -218.7859675784735, -175.6287740627788, -113.90301925022305, -58.52241540017845, -22.217932320142765, -15.174345856114213, -1.9394766848913694, -40.55158134791309, -88.24126507833049, -126.39301206266438, -122.51440965013151, -100.21152772010522, -57.56922217608419, -59.455377740867355, -58.56430219269389, -49.85144175415511, -38.081153403324095, 0.1350772773407236, 33.50806182187258, 62.20644945749807, 92.36515956599845, 130.89212765279876, 162.513702122239, 191.0109616977912, 196.608769358233, 171.0870154865864, 135.0696123892691, 85.4556899114153, 28.564551929132243, -53.74835845669421, -108.39868676535538, -140.9189494122843, -140.53515952982744, -118.22812762386195, -93.18250209908956, -69.54600167927165, -75.03680134341732, -59.82944107473386, -34.46355285978709, -34.57084228782968, -61.456673830263746, -52.965339064210994, -28.972271251368802, -23.377817001095043, -8.502253600876033, 21.998197119299174, 33.19855769543934, 30.558846156351475, 40.84707692508118, 40.27766154006495, 69.42212923205196, 79.93770338564157, 59.55016270851326, 59.240130166810616, 36.5921041334485, -12.3263166932412, -43.86105335459296, -59.08884268367437, -69.6710741469395, -57.33685931755161, -58.66948745404129, -60.935589963233035]}, "chart2": {"proportion": [0.2112676056338028, 0.11468812877263582, 0.16297786720321933, 0.08249496981891348, -0.158953722334004, -0.06237424547283702, 0.24346076458752516, 0.23138832997987926, 0.2515090543259557, 0.006036217303822937, 0.05030181086519115, -0.09859154929577464, -0.006036217303822937, -0.07042253521126761, -0.5331991951710262, -0.670020120724346, -0.43661971830985913, -0.323943661971831, -0.4969818913480885, -0.6257545271629779, -0.4688128772635815, -0.45271629778672035, -0.5895372233400402, -0.5734406438631791, -0.7183098591549296, -0.5412474849094567, -0.47283702213279677, -0.29577464788732394, -0.323943661971831, -0.006036217303822937, 0.2676056338028169, 0.32796780684104626, 0.24748490945674045, 0.026156941649899398, 0.10261569416498995, -0.39235412474849096, -0.5613682092555332, -0.5613682092555332, -0.2152917505030181, -0.022132796780684104, 0.22736418511066397, -0.13480885311871227, -0.11066398390342053, -0.030181086519114688, 0.018108651911468814, 0.30784708249496984, 0.33601609657947684, 0.3561368209255533, 0.42857142857142855, 0.5734406438631791, 0.5814889336016097, 0.613682092555332, 0.44064386317907445, 0.13883299798792756, -0.018108651911468814, -0.22736418511066397, -0.40040241448692154, -0.7706237424547284, -0.6579476861167002, -0.545271629778672, -0.2796780684104628, -0.05835010060362173, 0.014084507042253521, 0.05030181086519115, -0.19517102615694165, 0.002012072434607646, 0.13480885311871227, -0.07042253521126761, -0.34004024144869216, -0.03822937625754527, 0.13480885311871227, -0.002012072434607646, 0.10261569416498995, 0.2903225806451613, 0.15725806451612903, 0.04032258064516129, 0.16532258064516128, 0.07661290322580645, 0.375, 0.24596774193548387, -0.04435483870967742, 0.11693548387096774, -0.10887096774193548, -0.41935483870967744, -0.34274193548387094, -0.24193548387096775, -0.22580645161290322, -0.016129032258064516, -0.12903225806451613, -0.14112903225806453], "e9_proportion": [0.2112676056338028, 0.19195171026156943, 0.18615694164989943, 0.16542454728370226, 0.10054889336016101, 0.0679642655935614, 0.10306356539235416, 0.12872851830985918, 0.15328462551307848, 0.12383494387122737, 0.10912831727002013, 0.06758434395686118, 0.052860231704724356, 0.02820367832152596, -0.08407689637698448, -0.2012655412464568, -0.24833637665913727, -0.263457833721676, -0.3101626452469585, -0.3732810216301624, -0.39238739275684625, -0.4044531737628211, -0.44146998367826495, -0.4678641157152478, -0.5179532644031841, -0.5226121085044386, -0.5126570912301103, -0.469280602561553, -0.44021321444360867, -0.3533778150156515, -0.22918112525195788, -0.11775133883335707, -0.04470408917533757, -0.03053188301029018, -0.003902367575234156, -0.08159271900988553, -0.17754781705901507, -0.25431189549831873, -0.24650786649925863, -0.20163285255554372, -0.11583344502230218, -0.1196285266415842, -0.11783561809395147, -0.10030471177898412, -0.07662203904089354, 0.00027178526627913424, 0.06742064752891869, 0.12516388220824562, 0.18584539148088222, 0.2633644419573416, 0.32698934028619525, 0.38432789074002266, 0.39559108522783304, 0.3442394677798519, 0.2717698438415878, 0.17194303805113748, 0.057473947543525666, -0.10814559045612518, -0.2181060095882402, -0.28353913362632654, -0.2827669205831538, -0.23788355658724739, -0.1874899438613472, -0.13993159291603954, -0.15097947956421998, -0.12038116916445445, -0.0693431647078211, -0.06955903880851041, -0.12365527933654677, -0.10657009872074648, -0.058294308352854735, -0.04703786116920532, -0.017107150102366266, 0.044378796047139256, 0.06695464974093722, 0.061628235921782036, 0.08236710486645789, 0.0812162645383276, 0.13997301163066211, 0.16117195769162646, 0.1200665984113657, 0.11944037550328612, 0.07377810685424181, -0.02484848225854204, -0.08842717290360783, -0.1191288350970798, -0.14046435840024452, -0.11559729317180852, -0.11828428615035004, -0.12285323537189294]}, "chart3": {"abvEMA": [301, 277, 289, 269, 209, 233, 309, 306, 311, 250, 261, 224, 247, 231, 116, 82, 140, 168, 125, 93, 132, 136, 102, 106, 70, 114, 131, 175, 168, 247, 315, 330, 310, 255, 274, 151, 109, 109, 195, 243, 305, 215, 221, 241, 253, 325, 332, 337, 355, 391, 393, 401, 358, 283, 244, 192, 149, 57, 85, 113, 179, 234, 252, 261, 200, 249, 282, 231, 164, 239, 282, 248, 274, 320, 287, 258, 289, 267, 341, 309, 237, 277, 221, 144, 163, 188, 192, 244, 216, 213], "belEMA": [196, 220, 208, 228, 288, 264, 188, 191, 186, 247, 236, 273, 250, 266, 381, 415, 357, 329, 372, 404, 365, 361, 395, 391, 427, 383, 366, 322, 329, 250, 182, 167, 187, 242, 223, 346, 388, 388, 302, 254, 192, 282, 276, 256, 244, 172, 165, 160, 142, 106, 104, 96, 139, 214, 253, 305, 348, 440, 412, 384, 318, 263, 245, 236, 297, 248, 215, 266, 333, 258, 215, 249, 223, 176, 209, 238, 207, 229, 155, 187, 259, 219, 275, 352, 333, 308, 304, 252, 280, 283], "e9AbvEMA": [301.0, 296.20000000000005, 294.76000000000005, 289.60800000000006, 273.48640000000006, 265.38912000000005, 274.11129600000004, 280.48903680000006, 286.59122944000006, 279.272983552, 275.61838684160006, 265.2947094732801, 261.63576757862404, 255.50861406289926, 227.6068912503194, 198.48551300025554, 186.78841040020444, 183.03072832016355, 171.42458265613084, 155.73966612490466, 150.99173289992373, 147.993386319939, 138.7947090559512, 132.23576724476095, 119.78861379580877, 118.63089103664701, 121.10471282931762, 131.8837702634541, 139.10701621076328, 160.68561296861063, 191.5484903748885, 219.2387922999108, 237.39103383992867, 240.91282707194296, 247.53026165755438, 228.22420932604354, 204.37936746083486, 185.3034939686679, 187.24279517493434, 198.39423613994748, 219.715388911958, 218.77231112956642, 219.21784890365313, 223.57427912292252, 229.459423298338, 248.5675386386704, 265.2540309109363, 279.60322472874907, 294.68257978299926, 313.94606382639944, 329.75685106111956, 344.0054808488957, 346.8043846791166, 334.04350774329333, 316.0348061946347, 291.2278449557078, 262.7822759645662, 221.625820771653, 194.3006566173224, 178.04052529385794, 178.23242023508638, 189.3859361880691, 201.9087489504553, 213.72699916036424, 210.9815993282914, 218.58527946263314, 231.26822357010653, 231.2145788560852, 217.77166308486818, 222.01733046789457, 234.01386437431566, 236.81109149945254, 244.24887319956207, 259.3990985596497, 264.91927884771974, 263.5354230781758, 268.6283384625407, 268.3026707700326, 282.8421366160261, 288.07370929282087, 277.85896743425667, 277.6871739474053, 266.34973915792426, 241.87979132633944, 226.10383306107155, 218.48306644885724, 213.1864531590858, 219.34916252726867, 218.67933002181496, 217.54346401745198], "netStocks": [497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496]}};
    </script>
    <script>
        
        (function() {
            const chartInstances = {};
            let isSyncing = false;

            document.querySelectorAll('.reset-zoom-btn').forEach(button => {
                button.addEventListener('click', (e) => {
                    const chartId = e.target.getAttribute('data-chart-id');
                    if (chartInstances[chartId]) {
                        chartInstances[chartId].resetZoom();
                    }
                });
            });

            function syncCharts(sourceChart) {
                if (isSyncing) return;
                isSyncing = true;
                const { min, max } = sourceChart.scales.x;
                for (const chartId in chartInstances) {
                    const targetChart = chartInstances[chartId];
                    if (targetChart.canvas.id !== sourceChart.canvas.id) {
                        targetChart.options.scales.x.min = min;
                        targetChart.options.scales.x.max = max;
                        targetChart.update('none');
                    }
                }
                isSyncing = false;
            }

            function createCharts(data) {
                const computedStyles = getComputedStyle(document.body);
                const colors = {
                    green: computedStyles.getPropertyValue('--green').trim(), red: computedStyles.getPropertyValue('--red').trim(),
                    blue: computedStyles.getPropertyValue('--blue').trim(), cyan: computedStyles.getPropertyValue('--cyan').trim(),
                    yellow: computedStyles.getPropertyValue('--yellow').trim(), magenta: computedStyles.getPropertyValue('--magenta').trim(),
                    text: computedStyles.getPropertyValue('--text-color').trim(), grid: computedStyles.getPropertyValue('--border-color').trim() + '80',
                };
                const commonOptions = {
                    responsive: true, maintainAspectRatio: false,
                    scales: {
                        x: { grid: { color: colors.grid }, ticks: { color: colors.text, maxRotation: 0, autoSkip: true, maxTicksLimit: 15 }, grace: '5%' },
                        y: { grid: { color: colors.grid }, ticks: { color: colors.text } }
                    },
                    plugins: {
                        legend: { labels: { color: colors.text, font: { size: 14 } } },
                        tooltip: {
                            backgroundColor: computedStyles.getPropertyValue('--card-bg-color').trim(),
                            titleFont: { size: 16 }, bodyFont: { size: 14 }, padding: 10,
                            borderColor: colors.grid, borderWidth: 1, titleColor: colors.text, bodyColor: colors.text,
                        },
                        zoom: {
                            pan: { enabled: true, mode: 'x', onPanComplete: ({ chart }) => syncCharts(chart) },
                            zoom: {
                                drag: { enabled: false },
                                wheel: { enabled: true }, 
                                pinch: { enabled: true },
                                mode: 'x',
                                onZoomComplete: ({ chart }) => syncCharts(chart)
                            }
                        }
                    },
                    elements: { point: { radius: 0 } },
                    interaction: { intersect: false, mode: 'index' }
                };
                const chartHeight = 450;
                document.querySelectorAll('.chart-card canvas').forEach(c => c.parentElement.style.height = chartHeight + 'px');
                
                chartInstances.chart1 = new Chart(document.getElementById('chart1'), { type: 'line', data: { labels: data.labels, datasets: [{ label: 'Trend Of Stks', data: data.chart1.trendOfStocks, borderColor: colors.magenta, borderWidth: 2, tension: 0.1 }, { label: 'e9 (EMA)', data: data.chart1.e9_trendOfStocks, borderColor: colors.blue, borderWidth: 2, tension: 0.1 }] }, options: commonOptions });
                chartInstances.chart2 = new Chart(document.getElementById('chart2'), { type: 'line', data: { labels: data.labels, datasets: [{ label: 'Proportion', data: data.chart2.proportion, borderColor: colors.yellow, borderWidth: 2, tension: 0.1 }, { label: 'e9 (EMA)', data: data.chart2.e9_proportion, borderColor: colors.blue, borderWidth: 2, tension: 0.1 }] }, options: commonOptions });
                chartInstances.chart3 = new Chart(document.getElementById('chart3'), { type: 'line', data: { labels: data.labels, datasets: [{ label: 'Stocks Above EMA', data: data.chart3.abvEMA, borderColor: colors.green, borderWidth: 2, tension: 0.1 }, { label: 'Stocks Below EMA', data: data.chart3.belEMA, borderColor: colors.red, borderWidth: 2, tension: 0.1 }, { label: 'Net Stocks', data: data.chart3.netStocks, borderColor: colors.text, borderWidth: 1, tension: 0.1, borderDash: [5, 5] }] }, options: commonOptions });
            }
            createCharts(window.chartData);
        })();
    
    </script>
</body>
</html>