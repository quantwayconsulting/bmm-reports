<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nifty 500 - Broad Market Monitor</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/hammer.js/2.0.8/hammer.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-zoom@2.0.1/dist/chartjs-plugin-zoom.min.js"></script>
    <style>
        :root { --bg-color: #1a1b26; --card-bg-color: #24283b; --text-color: #c0caf5; --text-secondary-color: #a9b1d6; --border-color: #414868; --primary-color: #7aa2f7; --green: #9ece6a; --red: #f7768e; --blue: #7aa2f7; --cyan: #7dcfff; --yellow: #e0af68; --magenta: #bb9af7; }
        body[data-theme="bloomberg"] { --bg-color: #0d0d0d; --card-bg-color: #1a1a1a; --text-color: #e0e0e0; --text-secondary-color: #a0a0a0; --border-color: #333333; --primary-color: #ff9900; --green: #00e676; --red: #ff5252; --blue: #2979ff; --cyan: #00e5ff; --yellow: #ffd600; --magenta: #d500f9; }
        body[data-theme="light"] { --bg-color: #f5f7fa; --card-bg-color: #ffffff; --text-color: #1c2a42; --text-secondary-color: #5b6b85; --border-color: #e6e9f0; --primary-color: #0052cc; --green: #00875a; --red: #bf2600; --blue: #0052cc; --cyan: #00a3bf; --yellow: #ffab00; --magenta: #6554c0; }
        body { font-family: 'Segoe UI', 'Roboto', 'Helvetica', sans-serif; background-color: var(--bg-color); color: var(--text-color); margin: 0; padding: 10px; }
        .container { max-width: 1600px; margin: auto; }
        header { text-align: center; margin-bottom: 25px; border-bottom: 1px solid var(--border-color); padding-bottom: 20px; }
        h1 { font-size: 1.5rem; color: var(--text-color); margin: 0 0 5px 0; }
        h2 { margin: 0; color: var(--text-secondary-color); font-weight: 500; font-size: 1rem; }
        .card { background-color: var(--card-bg-color); border: 1px solid var(--border-color); border-radius: 8px; padding: 20px; margin-bottom: 20px; }
        .chart-header { display: flex; flex-direction: column; align-items: flex-start; gap: 10px; border-bottom: 1px solid var(--border-color); padding-bottom: 15px; margin-bottom: 15px; }
        .chart-title { font-size: 1.1rem; color: var(--text-secondary-color); font-weight: 500; }
        .zoom-hint { font-size: 0.8rem; font-style: italic; color: #6c707a; }
        .reset-zoom-btn { background: none; border: 1px solid var(--border-color); color: var(--text-secondary-color); padding: 5px 10px; border-radius: 4px; cursor: pointer; }
        @media (min-width: 600px) { 
            h1 {font-size: 1.8rem;} h2 {font-size: 1.2rem;}
            .chart-header { flex-direction: row; justify-content: space-between; align-items: center;}
        }
    </style>
</head>
<body data-theme="bloomberg">
    <div class="container">
        <header>
            <h1>Nifty 500</h1>
            <h2>Timeframe: Daily | Lookback: 90 Periods</h2>
        </header>
        <div id="charts">
            <div class="card chart-card"><div class="chart-header"><span class="chart-title">Market Trend (Sum)</span><div><span class="zoom-hint">Scroll/Drag to Zoom</span> <button class="reset-zoom-btn" data-chart-id="chart1">Reset</button></div></div><canvas id="chart1"></canvas></div>
            <div class="card chart-card"><div class="chart-header"><span class="chart-title">Market Proportion</span><div><span class="zoom-hint">Scroll/Drag to Zoom</span> <button class="reset-zoom-btn" data-chart-id="chart2">Reset</button></div></div><canvas id="chart2"></canvas></div>
            <div class="card chart-card"><div class="chart-header"><span class="chart-title">Market Breadth</span><div><span class="zoom-hint">Scroll/Drag to Zoom</span> <button class="reset-zoom-btn" data-chart-id="chart3">Reset</button></div></div><canvas id="chart3"></canvas></div>
        </div>
    </div>
    <script>
        window.chartData = {"labels": ["2025-06-27", "2025-06-30", "2025-07-01", "2025-07-02", "2025-07-03", "2025-07-04", "2025-07-07", "2025-07-08", "2025-07-09", "2025-07-10", "2025-07-11", "2025-07-14", "2025-07-15", "2025-07-16", "2025-07-17", "2025-07-18", "2025-07-21", "2025-07-22", "2025-07-23", "2025-07-24", "2025-07-25", "2025-07-28", "2025-07-29", "2025-07-30", "2025-07-31", "2025-08-01", "2025-08-04", "2025-08-05", "2025-08-06", "2025-08-07", "2025-08-08", "2025-08-11", "2025-08-12", "2025-08-13", "2025-08-14", "2025-08-18", "2025-08-19", "2025-08-20", "2025-08-21", "2025-08-22", "2025-08-25", "2025-08-26", "2025-08-28", "2025-08-29", "2025-09-01", "2025-09-02", "2025-09-03", "2025-09-04", "2025-09-05", "2025-09-08", "2025-09-09", "2025-09-10", "2025-09-11", "2025-09-12", "2025-09-15", "2025-09-16", "2025-09-17", "2025-09-18", "2025-09-19", "2025-09-22", "2025-09-23", "2025-09-24", "2025-09-25", "2025-09-26", "2025-09-29", "2025-09-30", "2025-10-01", "2025-10-03", "2025-10-06", "2025-10-07", "2025-10-08", "2025-10-09", "2025-10-10", "2025-10-13", "2025-10-14", "2025-10-15", "2025-10-16", "2025-10-17", "2025-10-20", "2025-10-21", "2025-10-23", "2025-10-24", "2025-10-27", "2025-10-28", "2025-10-29", "2025-10-30", "2025-10-31", "2025-11-03", "2025-11-04", "2025-11-06"], "chart1": {"trendOfStocks": [265, 271, 199, 163, 153, 141, 103, 53, 77, 37, -81, -33, 119, 113, 125, -1, 19, -51, -7, -41, -265, -335, -219, -161, -247, -311, -233, -225, -293, -285, -357, -269, -235, -147, -163, -7, 131, 159, 121, 11, 49, -197, -281, -281, -109, -13, 111, -69, -57, -17, 7, 151, 163, 173, 209, 277, 285, 299, 217, 67, -11, -115, -201, -385, -331, -273, -143, -33, -1, 19, -101, -5, 63, -39, -173, -25, 63, -7, 43, 136, 72, 18, 78, 34, 184, 120, -22, 56, -54, -208], "e9_trendOfStocks": [265.0, 266.2, 252.76000000000002, 234.80800000000002, 218.4464, 202.95712000000003, 182.96569600000004, 156.97255680000004, 140.97804544000005, 120.18243635200005, 79.94594908160005, 57.35675926528004, 69.68540741222404, 78.34832592977924, 87.6786607438234, 69.94292859505872, 59.75434287604698, 37.60347430083758, 28.682779440670068, 14.746223552536053, -41.20302115797116, -99.96241692637693, -123.76993354110155, -131.21594683288123, -154.372757466305, -185.698205973044, -195.1585647784352, -201.12685182274816, -219.50148145819853, -232.60118516655882, -257.48094813324707, -259.78475850659765, -254.82780680527813, -233.26224544422251, -219.20979635537802, -176.76783708430244, -115.21426966744197, -60.37141573395358, -24.097132587162868, -17.077706069730297, -3.862164855784238, -42.489731884627396, -90.19178550770192, -128.35342840616153, -124.48274272492922, -102.18619417994339, -59.54895534395472, -61.439164275163776, -60.55133142013102, -51.84106513610482, -40.07285210888386, -1.8582816871070875, 31.11337465031433, 59.49069972025147, 89.39255977620118, 126.91404782096096, 158.53123825676877, 186.62499060541504, 192.69999248433203, 167.55999398746565, 131.84799518997252, 82.47839615197802, 25.78271692158242, -56.37382646273406, -111.29906117018726, -143.6392489361498, -143.51139914891985, -121.40911931913588, -97.32729545530871, -74.06183636424699, -79.44946909139759, -64.55957527311807, -39.04766021849446, -39.03812817479557, -65.83050253983646, -57.66440203186917, -33.53152162549534, -28.22521730039627, -13.980173840317017, 16.015860927746388, 27.21268874219711, 25.37015099375769, 35.896120795006155, 35.51689663600493, 65.21351730880394, 76.17081384704315, 56.536651077634524, 56.42932086210762, 34.34345668968611, -14.125234648251116]}, "chart2": {"proportion": [0.5331991951710262, 0.545271629778672, 0.40040241448692154, 0.32796780684104626, 0.30784708249496984, 0.2837022132796781, 0.20724346076458752, 0.10663983903420524, 0.15492957746478872, 0.0744466800804829, -0.16297786720321933, -0.06639839034205232, 0.23943661971830985, 0.22736418511066397, 0.2515090543259557, -0.002012072434607646, 0.03822937625754527, -0.10261569416498995, -0.014084507042253521, -0.08249496981891348, -0.5331991951710262, -0.6740442655935613, -0.44064386317907445, -0.323943661971831, -0.4969818913480885, -0.6257545271629779, -0.4688128772635815, -0.45271629778672035, -0.5895372233400402, -0.5734406438631791, -0.7183098591549296, -0.5412474849094567, -0.47283702213279677, -0.29577464788732394, -0.32796780684104626, -0.014084507042253521, 0.2635814889336016, 0.3199195171026157, 0.24346076458752516, 0.022132796780684104, 0.09859154929577464, -0.3963782696177062, -0.5653923541247485, -0.5653923541247485, -0.2193158953722334, -0.026156941649899398, 0.22334004024144868, -0.13883299798792756, -0.11468812877263582, -0.03420523138832998, 0.014084507042253521, 0.3038229376257545, 0.32796780684104626, 0.34808853118712274, 0.42052313883299797, 0.5573440643863179, 0.5734406438631791, 0.6016096579476862, 0.43661971830985913, 0.13480885311871227, -0.022132796780684104, -0.23138832997987926, -0.4044265593561368, -0.7746478873239436, -0.6659959758551308, -0.5492957746478874, -0.28772635814889336, -0.06639839034205232, -0.002012072434607646, 0.03822937625754527, -0.20321931589537223, -0.01006036217303823, 0.1267605633802817, -0.07847082494969819, -0.34808853118712274, -0.05030181086519115, 0.1267605633802817, -0.014084507042253521, 0.08651911468812877, 0.27419354838709675, 0.14516129032258066, 0.036290322580645164, 0.15725806451612903, 0.06854838709677419, 0.3709677419354839, 0.24193548387096775, -0.04435483870967742, 0.11290322580645161, -0.10887096774193548, -0.41935483870967744], "e9_proportion": [0.5331991951710262, 0.5356136820925554, 0.5085714285714287, 0.47245070422535224, 0.4395299798792758, 0.4083644265593563, 0.3681402334004026, 0.31584015452716313, 0.2836580391146883, 0.2418157673078472, 0.1608570404056339, 0.11540595425609665, 0.1402120873485393, 0.15764250690096424, 0.17641581638596254, 0.14073023862184852, 0.12023006614898789, 0.07566091408619233, 0.057711829860503154, 0.02967046992461983, -0.08290346309450938, -0.2011316235943198, -0.24903407151127074, -0.2640159896033828, -0.31060916995232396, -0.3736382413944548, -0.39267316856828016, -0.4046817944119683, -0.4416528801975827, -0.468010432930702, -0.5180703181755475, -0.5227057515223293, -0.5127320056444229, -0.46934053409300314, -0.4410659886426118, -0.3556696923225402, -0.23181945607131182, -0.12147166143652634, -0.04848517623171604, -0.03436158162923602, -0.007770955444233885, -0.08549241827892835, -0.1814724054480924, -0.25825639518342364, -0.25046829522118563, -0.2056060245069284, -0.11981681155725299, -0.12362004884338791, -0.1218336648292375, -0.104307978141056, -0.08062948110439411, -0.0037389973583643876, 0.06260236348151774, 0.11969959702263874, 0.1798643053847106, 0.2553602571850321, 0.3189763345206615, 0.37550299920606645, 0.387726343026825, 0.3371428450452025, 0.26528771668002515, 0.1659525073480443, 0.051876694007208055, -0.1134282222590223, -0.223941772978244, -0.28901257331217267, -0.28875533027951683, -0.24428394229202394, -0.1958295683205407, -0.1490177794049235, -0.15985808670301327, -0.1298985417970183, -0.0785667207615583, -0.07854754159918628, -0.13245573951677359, -0.1160249537864571, -0.06746785035310934, -0.056791181690938185, -0.0281291224151248, 0.032335411745319516, 0.05490058746077175, 0.051178534484746435, 0.07239444049102296, 0.0716252298121732, 0.13149373223683536, 0.15358208256366185, 0.113994698308994, 0.11377640380848553, 0.06924692949840133, -0.028473424143214424]}, "chart3": {"abvEMA": [381, 384, 348, 330, 325, 319, 300, 275, 287, 267, 208, 232, 308, 305, 311, 248, 258, 223, 245, 228, 116, 81, 139, 168, 125, 93, 132, 136, 102, 106, 70, 114, 131, 175, 167, 245, 314, 328, 309, 254, 273, 150, 108, 108, 194, 242, 304, 214, 220, 240, 252, 324, 330, 335, 353, 387, 391, 398, 357, 282, 243, 191, 148, 56, 83, 112, 177, 232, 248, 258, 198, 246, 280, 229, 162, 236, 280, 245, 270, 316, 284, 257, 287, 265, 340, 308, 237, 276, 221, 144], "belEMA": [116, 113, 149, 167, 172, 178, 197, 222, 210, 230, 289, 265, 189, 192, 186, 249, 239, 274, 252, 269, 381, 416, 358, 329, 372, 404, 365, 361, 395, 391, 427, 383, 366, 322, 330, 252, 183, 169, 188, 243, 224, 347, 389, 389, 303, 255, 193, 283, 277, 257, 245, 173, 167, 162, 144, 110, 106, 99, 140, 215, 254, 306, 349, 441, 414, 385, 320, 265, 249, 239, 299, 251, 217, 268, 335, 261, 217, 252, 227, 180, 212, 239, 209, 231, 156, 188, 259, 220, 275, 352], "e9AbvEMA": [381.0, 381.6, 374.88000000000005, 365.90400000000005, 357.7232000000001, 349.9785600000001, 339.98284800000005, 326.98627840000006, 318.9890227200001, 308.5912181760001, 288.4729745408001, 277.17837963264014, 283.34270370611216, 287.6741629648898, 292.33933037191184, 283.4714642975295, 278.37717143802365, 267.30173715041894, 262.8413897203352, 255.87311177626816, 227.89848942101452, 198.51879153681162, 186.61503322944932, 182.89202658355947, 171.31362126684758, 155.65089701347807, 150.92071761078248, 147.936574088626, 138.7492592709008, 132.19940741672065, 119.75952593337652, 118.60762074670122, 121.08609659736098, 131.86887727788877, 138.89510182231103, 160.11608145784885, 190.8928651662791, 218.3142921330233, 236.45143370641864, 239.96114696513493, 246.56891757210795, 227.25513405768638, 203.4041072461491, 184.3232857969193, 186.25862863753545, 197.40690291002838, 218.72552232802272, 217.7804178624182, 218.22433428993457, 222.57946743194768, 228.46357394555815, 247.57085915644655, 264.0566873251572, 278.24534986012577, 293.19627988810066, 311.95702391048053, 327.76561912838446, 341.8124953027076, 344.84999624216607, 332.2799969937329, 314.42399759498636, 289.7391980759891, 261.3913584607913, 220.31308676863304, 192.85046941490643, 176.68037553192516, 176.74430042554013, 187.79544034043212, 199.8363522723457, 211.46908181787657, 208.77526545430126, 216.22021236344102, 228.97616989075283, 228.9809359126023, 215.58474873008186, 219.66779898406548, 231.7342391872524, 234.38739134980193, 241.50991307984157, 256.40793046387324, 261.9263443710986, 260.94107549687885, 266.1528603975031, 265.92228831800253, 280.73783065440205, 286.19026452352165, 276.35221161881736, 276.2817692950539, 265.22541543604314, 240.98033234883454], "netStocks": [497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496]}};
    </script>
    <script>
        
        (function() {
            const chartInstances = {};
            let isSyncing = false;

            document.querySelectorAll('.reset-zoom-btn').forEach(button => {
                button.addEventListener('click', (e) => {
                    const chartId = e.target.getAttribute('data-chart-id');
                    if (chartInstances[chartId]) {
                        chartInstances[chartId].resetZoom();
                    }
                });
            });

            function syncCharts(sourceChart) {
                if (isSyncing) return;
                isSyncing = true;
                const { min, max } = sourceChart.scales.x;
                for (const chartId in chartInstances) {
                    const targetChart = chartInstances[chartId];
                    if (targetChart.canvas.id !== sourceChart.canvas.id) {
                        targetChart.options.scales.x.min = min;
                        targetChart.options.scales.x.max = max;
                        targetChart.update('none');
                    }
                }
                isSyncing = false;
            }

            function createCharts(data) {
                const computedStyles = getComputedStyle(document.body);
                const colors = {
                    green: computedStyles.getPropertyValue('--green').trim(), red: computedStyles.getPropertyValue('--red').trim(),
                    blue: computedStyles.getPropertyValue('--blue').trim(), cyan: computedStyles.getPropertyValue('--cyan').trim(),
                    yellow: computedStyles.getPropertyValue('--yellow').trim(), magenta: computedStyles.getPropertyValue('--magenta').trim(),
                    text: computedStyles.getPropertyValue('--text-color').trim(), grid: computedStyles.getPropertyValue('--border-color').trim() + '80',
                };
                const commonOptions = {
                    responsive: true, maintainAspectRatio: false,
                    scales: {
                        x: { grid: { color: colors.grid }, ticks: { color: colors.text, maxRotation: 0, autoSkip: true, maxTicksLimit: 15 }, grace: '5%' },
                        y: { grid: { color: colors.grid }, ticks: { color: colors.text } }
                    },
                    plugins: {
                        legend: { labels: { color: colors.text, font: { size: 14 } } },
                        tooltip: {
                            backgroundColor: computedStyles.getPropertyValue('--card-bg-color').trim(),
                            titleFont: { size: 16 }, bodyFont: { size: 14 }, padding: 10,
                            borderColor: colors.grid, borderWidth: 1, titleColor: colors.text, bodyColor: colors.text,
                        },
                        zoom: {
                            pan: { enabled: true, mode: 'x', onPanComplete: ({ chart }) => syncCharts(chart) },
                            zoom: {
                                drag: { enabled: false },
                                wheel: { enabled: true }, 
                                pinch: { enabled: true },
                                mode: 'x',
                                onZoomComplete: ({ chart }) => syncCharts(chart)
                            }
                        }
                    },
                    elements: { point: { radius: 0 } },
                    interaction: { intersect: false, mode: 'index' }
                };
                const chartHeight = 450;
                document.querySelectorAll('.chart-card canvas').forEach(c => c.parentElement.style.height = chartHeight + 'px');
                
                chartInstances.chart1 = new Chart(document.getElementById('chart1'), { type: 'line', data: { labels: data.labels, datasets: [{ label: 'Trend Of Stks', data: data.chart1.trendOfStocks, borderColor: colors.magenta, borderWidth: 2, tension: 0.1 }, { label: 'e9 (EMA)', data: data.chart1.e9_trendOfStocks, borderColor: colors.blue, borderWidth: 2, tension: 0.1 }] }, options: commonOptions });
                chartInstances.chart2 = new Chart(document.getElementById('chart2'), { type: 'line', data: { labels: data.labels, datasets: [{ label: 'Proportion', data: data.chart2.proportion, borderColor: colors.yellow, borderWidth: 2, tension: 0.1 }, { label: 'e9 (EMA)', data: data.chart2.e9_proportion, borderColor: colors.blue, borderWidth: 2, tension: 0.1 }] }, options: commonOptions });
                chartInstances.chart3 = new Chart(document.getElementById('chart3'), { type: 'line', data: { labels: data.labels, datasets: [{ label: 'Stocks Above EMA', data: data.chart3.abvEMA, borderColor: colors.green, borderWidth: 2, tension: 0.1 }, { label: 'Stocks Below EMA', data: data.chart3.belEMA, borderColor: colors.red, borderWidth: 2, tension: 0.1 }, { label: 'Net Stocks', data: data.chart3.netStocks, borderColor: colors.text, borderWidth: 1, tension: 0.1, borderDash: [5, 5] }] }, options: commonOptions });
            }
            createCharts(window.chartData);
        })();
    
    </script>
</body>
</html>