<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nifty 500 - Broad Market Monitor</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/hammer.js/2.0.8/hammer.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-zoom@2.0.1/dist/chartjs-plugin-zoom.min.js"></script>
    <style>
        :root { --bg-color: #1a1b26; --card-bg-color: #24283b; --text-color: #c0caf5; --text-secondary-color: #a9b1d6; --border-color: #414868; --primary-color: #7aa2f7; --green: #9ece6a; --red: #f7768e; --blue: #7aa2f7; --cyan: #7dcfff; --yellow: #e0af68; --magenta: #bb9af7; }
        body[data-theme="bloomberg"] { --bg-color: #0d0d0d; --card-bg-color: #1a1a1a; --text-color: #e0e0e0; --text-secondary-color: #a0a0a0; --border-color: #333333; --primary-color: #ff9900; --green: #00e676; --red: #ff5252; --blue: #2979ff; --cyan: #00e5ff; --yellow: #ffd600; --magenta: #d500f9; }
        body[data-theme="light"] { --bg-color: #f5f7fa; --card-bg-color: #ffffff; --text-color: #1c2a42; --text-secondary-color: #5b6b85; --border-color: #e6e9f0; --primary-color: #0052cc; --green: #00875a; --red: #bf2600; --blue: #0052cc; --cyan: #00a3bf; --yellow: #ffab00; --magenta: #6554c0; }
        body { font-family: 'Segoe UI', 'Roboto', 'Helvetica', sans-serif; background-color: var(--bg-color); color: var(--text-color); margin: 0; padding: 10px; }
        .container { max-width: 1600px; margin: auto; }
        header { text-align: center; margin-bottom: 25px; border-bottom: 1px solid var(--border-color); padding-bottom: 20px; }
        h1 { font-size: 1.5rem; color: var(--text-color); margin: 0 0 5px 0; }
        h2 { margin: 0; color: var(--text-secondary-color); font-weight: 500; font-size: 1rem; }
        .card { background-color: var(--card-bg-color); border: 1px solid var(--border-color); border-radius: 8px; padding: 20px; margin-bottom: 20px; }
        .chart-header { display: flex; flex-direction: column; align-items: flex-start; gap: 10px; border-bottom: 1px solid var(--border-color); padding-bottom: 15px; margin-bottom: 15px; }
        .chart-title { font-size: 1.1rem; color: var(--text-secondary-color); font-weight: 500; }
        .zoom-hint { font-size: 0.8rem; font-style: italic; color: #6c707a; }
        .reset-zoom-btn { background: none; border: 1px solid var(--border-color); color: var(--text-secondary-color); padding: 5px 10px; border-radius: 4px; cursor: pointer; }
        @media (min-width: 600px) { 
            h1 {font-size: 1.8rem;} h2 {font-size: 1.2rem;}
            .chart-header { flex-direction: row; justify-content: space-between; align-items: center;}
        }
    </style>
</head>
<body data-theme="bloomberg">
    <div class="container">
        <header>
            <h1>Nifty 500</h1>
            <h2>Timeframe: Daily | Lookback: 90 Periods</h2>
        </header>
        <div id="charts">
            <div class="card chart-card"><div class="chart-header"><span class="chart-title">Market Trend (Sum)</span><div><span class="zoom-hint">Scroll/Drag to Zoom</span> <button class="reset-zoom-btn" data-chart-id="chart1">Reset</button></div></div><canvas id="chart1"></canvas></div>
            <div class="card chart-card"><div class="chart-header"><span class="chart-title">Market Proportion</span><div><span class="zoom-hint">Scroll/Drag to Zoom</span> <button class="reset-zoom-btn" data-chart-id="chart2">Reset</button></div></div><canvas id="chart2"></canvas></div>
            <div class="card chart-card"><div class="chart-header"><span class="chart-title">Market Breadth</span><div><span class="zoom-hint">Scroll/Drag to Zoom</span> <button class="reset-zoom-btn" data-chart-id="chart3">Reset</button></div></div><canvas id="chart3"></canvas></div>
        </div>
    </div>
    <script>
        window.chartData = {"labels": ["2025-06-30", "2025-07-01", "2025-07-02", "2025-07-03", "2025-07-04", "2025-07-07", "2025-07-08", "2025-07-09", "2025-07-10", "2025-07-11", "2025-07-14", "2025-07-15", "2025-07-16", "2025-07-17", "2025-07-18", "2025-07-21", "2025-07-22", "2025-07-23", "2025-07-24", "2025-07-25", "2025-07-28", "2025-07-29", "2025-07-30", "2025-07-31", "2025-08-01", "2025-08-04", "2025-08-05", "2025-08-06", "2025-08-07", "2025-08-08", "2025-08-11", "2025-08-12", "2025-08-13", "2025-08-14", "2025-08-18", "2025-08-19", "2025-08-20", "2025-08-21", "2025-08-22", "2025-08-25", "2025-08-26", "2025-08-28", "2025-08-29", "2025-09-01", "2025-09-02", "2025-09-03", "2025-09-04", "2025-09-05", "2025-09-08", "2025-09-09", "2025-09-10", "2025-09-11", "2025-09-12", "2025-09-15", "2025-09-16", "2025-09-17", "2025-09-18", "2025-09-19", "2025-09-22", "2025-09-23", "2025-09-24", "2025-09-25", "2025-09-26", "2025-09-29", "2025-09-30", "2025-10-01", "2025-10-03", "2025-10-06", "2025-10-07", "2025-10-08", "2025-10-09", "2025-10-10", "2025-10-13", "2025-10-14", "2025-10-15", "2025-10-16", "2025-10-17", "2025-10-20", "2025-10-21", "2025-10-23", "2025-10-24", "2025-10-27", "2025-10-28", "2025-10-29", "2025-10-30", "2025-10-31", "2025-11-03", "2025-11-04", "2025-11-06", "2025-11-07"], "chart1": {"trendOfStocks": [271, 199, 163, 153, 141, 103, 53, 77, 37, -81, -33, 119, 113, 125, -1, 19, -51, -7, -41, -265, -335, -219, -161, -247, -311, -233, -225, -293, -285, -357, -269, -235, -147, -163, -7, 131, 159, 121, 11, 49, -197, -281, -281, -109, -13, 111, -69, -57, -17, 7, 151, 163, 173, 209, 277, 285, 299, 217, 67, -11, -115, -201, -385, -331, -273, -143, -33, -1, 19, -101, -5, 63, -39, -173, -25, 63, -7, 43, 136, 72, 18, 78, 34, 184, 120, -22, 56, -54, -208, -170], "e9_trendOfStocks": [271.0, 256.6, 237.88000000000002, 220.90400000000002, 204.9232, 184.53856000000002, 158.230848, 141.9846784, 120.98774272000001, 80.59019417600001, 57.87215534080001, 70.09772427264001, 78.67817941811201, 87.9425435344896, 70.15403482759169, 59.92322786207335, 37.73858228965868, 28.790865831726947, 14.83269266538156, -41.13384586769475, -99.9070766941558, -123.72566135532466, -131.18052908425972, -154.3444232674078, -185.67553861392622, -195.14043089114097, -201.11234471291277, -219.48987577033023, -232.59190061626418, -257.4735204930114, -259.77881639440915, -254.82305311552733, -233.2584424924219, -219.20675399393753, -176.76540319515004, -115.21232255612004, -60.36985804489605, -24.09588643591684, -17.076709148733475, -3.8613673189867797, -42.48909385518943, -90.19127508415156, -128.35302006732127, -124.48241605385702, -102.18593284308562, -59.5487462744685, -61.4389970195748, -60.55119761565984, -51.84095809252787, -40.0727664740223, -1.8582131792178416, 31.113429456625727, 59.49074356530058, 89.39259485224048, 126.91407588179239, 158.5312607054339, 186.62500856434713, 192.70000685147772, 167.5600054811822, 131.84800438494577, 82.47840350795661, 25.782722806365285, -56.373821754907766, -111.29905740392621, -143.63924592314098, -143.5113967385128, -121.40911739081022, -97.32729391264819, -74.06183513011855, -79.44946810409485, -64.55957448327588, -39.0476595866207, -39.038127669296564, -65.83050213543726, -57.66440170834981, -33.53152136667985, -28.22521709334388, -13.980173674675106, 16.015861060259915, 27.212688848207932, 25.370151078566348, 35.89612086285308, 35.516896690282465, 65.21351735222598, 76.17081388178079, 56.53665110542463, 56.42932088433971, 34.34345670747177, -14.125234634022583, -45.300187707218065]}, "chart2": {"proportion": [0.545271629778672, 0.40040241448692154, 0.32796780684104626, 0.30784708249496984, 0.2837022132796781, 0.20724346076458752, 0.10663983903420524, 0.15492957746478872, 0.0744466800804829, -0.16297786720321933, -0.06639839034205232, 0.23943661971830985, 0.22736418511066397, 0.2515090543259557, -0.002012072434607646, 0.03822937625754527, -0.10261569416498995, -0.014084507042253521, -0.08249496981891348, -0.5331991951710262, -0.6740442655935613, -0.44064386317907445, -0.323943661971831, -0.4969818913480885, -0.6257545271629779, -0.4688128772635815, -0.45271629778672035, -0.5895372233400402, -0.5734406438631791, -0.7183098591549296, -0.5412474849094567, -0.47283702213279677, -0.29577464788732394, -0.32796780684104626, -0.014084507042253521, 0.2635814889336016, 0.3199195171026157, 0.24346076458752516, 0.022132796780684104, 0.09859154929577464, -0.3963782696177062, -0.5653923541247485, -0.5653923541247485, -0.2193158953722334, -0.026156941649899398, 0.22334004024144868, -0.13883299798792756, -0.11468812877263582, -0.03420523138832998, 0.014084507042253521, 0.3038229376257545, 0.32796780684104626, 0.34808853118712274, 0.42052313883299797, 0.5573440643863179, 0.5734406438631791, 0.6016096579476862, 0.43661971830985913, 0.13480885311871227, -0.022132796780684104, -0.23138832997987926, -0.4044265593561368, -0.7746478873239436, -0.6659959758551308, -0.5492957746478874, -0.28772635814889336, -0.06639839034205232, -0.002012072434607646, 0.03822937625754527, -0.20321931589537223, -0.01006036217303823, 0.1267605633802817, -0.07847082494969819, -0.34808853118712274, -0.05030181086519115, 0.1267605633802817, -0.014084507042253521, 0.08651911468812877, 0.27419354838709675, 0.14516129032258066, 0.036290322580645164, 0.15725806451612903, 0.06854838709677419, 0.3709677419354839, 0.24193548387096775, -0.04435483870967742, 0.11290322580645161, -0.10887096774193548, -0.41935483870967744, -0.34274193548387094], "e9_proportion": [0.545271629778672, 0.516297786720322, 0.4786317907444669, 0.44447484909456747, 0.41232032193158963, 0.3713049496981892, 0.31837192756539245, 0.28568345754527175, 0.24343610205231397, 0.16215330820120732, 0.1164429684925554, 0.14104169873770628, 0.15830619601229784, 0.17694676767502943, 0.14115499965310202, 0.12056987497399069, 0.07593276114619457, 0.05792930750850495, 0.029844452043021268, -0.08276427739978823, -0.20102027503854286, -0.24894499266664918, -0.2639447265276856, -0.3105521594917662, -0.37359263302600854, -0.3926366818735232, -0.40465260505616263, -0.4416295287129382, -0.46799175174298635, -0.518055373225375, -0.5226937955621913, -0.5127224408763125, -0.4693328822785148, -0.4410598671910211, -0.3556647951612676, -0.23181553834229374, -0.12146852725331185, -0.04848266888514445, -0.034359575751978746, -0.007769350742428068, -0.0854911345174837, -0.18147137843893668, -0.2582555735760991, -0.25046763793532595, -0.20560549867824066, -0.1198163908943028, -0.12361971231302775, -0.12183339560494937, -0.10430776276162548, -0.08062930880084969, -0.003738859515528853, 0.06260247375578616, 0.11969968524205349, 0.1798643759602424, 0.2553603136454575, 0.31897637968900183, 0.3755030353407387, 0.38772637193456283, 0.3371428681713927, 0.26528773518097737, 0.16595252214880604, 0.051876705847817464, -0.11342821278653478, -0.22394176540025398, -0.2890125672497807, -0.28875532542960325, -0.24428393841209306, -0.19582956521659597, -0.14901777692176774, -0.15985808471648866, -0.1298985402077986, -0.07856671949018254, -0.07854754058208567, -0.13245573870309307, -0.11602495313551268, -0.06746784983235382, -0.05679118127433377, -0.02812912208184126, 0.03233541201194635, 0.054900587674073215, 0.0511785346553876, 0.07239444062753589, 0.07162522992138355, 0.13149373232420364, 0.15358208263355647, 0.1139946983649097, 0.11377640385321809, 0.06924692953418739, -0.028473424114585574, -0.09132712638844265]}, "chart3": {"abvEMA": [384, 348, 330, 325, 319, 300, 275, 287, 267, 208, 232, 308, 305, 311, 248, 258, 223, 245, 228, 116, 81, 139, 168, 125, 93, 132, 136, 102, 106, 70, 114, 131, 175, 167, 245, 314, 328, 309, 254, 273, 150, 108, 108, 194, 242, 304, 214, 220, 240, 252, 324, 330, 335, 353, 387, 391, 398, 357, 282, 243, 191, 148, 56, 83, 112, 177, 232, 248, 258, 198, 246, 280, 229, 162, 236, 280, 245, 270, 316, 284, 257, 287, 265, 340, 308, 237, 276, 221, 144, 163], "belEMA": [113, 149, 167, 172, 178, 197, 222, 210, 230, 289, 265, 189, 192, 186, 249, 239, 274, 252, 269, 381, 416, 358, 329, 372, 404, 365, 361, 395, 391, 427, 383, 366, 322, 330, 252, 183, 169, 188, 243, 224, 347, 389, 389, 303, 255, 193, 283, 277, 257, 245, 173, 167, 162, 144, 110, 106, 99, 140, 215, 254, 306, 349, 441, 414, 385, 320, 265, 249, 239, 299, 251, 217, 268, 335, 261, 217, 252, 227, 180, 212, 239, 209, 231, 156, 188, 259, 220, 275, 352, 333], "e9AbvEMA": [384.0, 376.80000000000007, 367.44000000000005, 358.95200000000006, 350.9616000000001, 340.7692800000001, 327.6154240000001, 319.49233920000006, 308.99387136000007, 288.7950970880001, 277.4360776704001, 283.5488621363201, 287.8390897090561, 292.4712717672449, 283.57701741379594, 278.46161393103677, 267.36929114482945, 262.8954329158636, 255.91634633269086, 227.9330770661527, 198.54646165292215, 186.63716932233774, 182.9097354578702, 171.32778836629618, 155.66223069303695, 150.92978455442957, 147.94382764354367, 138.75506211483494, 132.20404969186797, 119.76323975349437, 118.6105918027955, 121.0884734422364, 131.87077875378912, 138.8966230030313, 160.11729840242504, 190.89383872194006, 218.31507097755207, 236.45205678204167, 239.96164542563335, 246.56931634050667, 227.25545307240534, 203.4043624579243, 184.32348996633945, 186.25879197307157, 197.40703357845726, 218.72562686276584, 217.78050149021269, 218.22440119217015, 222.57952095373614, 228.46361676298892, 247.57089341039114, 264.05671472831295, 278.2453717826504, 293.19629742612034, 311.95703794089627, 327.76563035271704, 341.8125042821737, 344.8500034257389, 332.28000274059116, 314.424002192473, 289.7392017539784, 261.39136140318277, 220.31308912254622, 192.85047129803698, 176.6803770384296, 176.7443016307437, 187.795441304595, 199.83635304367598, 211.4690824349408, 208.77526594795265, 216.22021275836215, 228.97617020668974, 228.9809361653518, 215.58474893228146, 219.6677991458252, 231.73423931666017, 234.38739145332815, 241.50991316266254, 256.40793053013005, 261.92634442410406, 260.94107553928325, 266.1528604314266, 265.9222883451413, 280.73783067611305, 286.19026454089044, 276.3522116327124, 276.2817693061699, 265.22541544493595, 240.98033235594878, 225.38426588475903], "netStocks": [497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496]}};
    </script>
    <script>
        
        (function() {
            const chartInstances = {};
            let isSyncing = false;

            document.querySelectorAll('.reset-zoom-btn').forEach(button => {
                button.addEventListener('click', (e) => {
                    const chartId = e.target.getAttribute('data-chart-id');
                    if (chartInstances[chartId]) {
                        chartInstances[chartId].resetZoom();
                    }
                });
            });

            function syncCharts(sourceChart) {
                if (isSyncing) return;
                isSyncing = true;
                const { min, max } = sourceChart.scales.x;
                for (const chartId in chartInstances) {
                    const targetChart = chartInstances[chartId];
                    if (targetChart.canvas.id !== sourceChart.canvas.id) {
                        targetChart.options.scales.x.min = min;
                        targetChart.options.scales.x.max = max;
                        targetChart.update('none');
                    }
                }
                isSyncing = false;
            }

            function createCharts(data) {
                const computedStyles = getComputedStyle(document.body);
                const colors = {
                    green: computedStyles.getPropertyValue('--green').trim(), red: computedStyles.getPropertyValue('--red').trim(),
                    blue: computedStyles.getPropertyValue('--blue').trim(), cyan: computedStyles.getPropertyValue('--cyan').trim(),
                    yellow: computedStyles.getPropertyValue('--yellow').trim(), magenta: computedStyles.getPropertyValue('--magenta').trim(),
                    text: computedStyles.getPropertyValue('--text-color').trim(), grid: computedStyles.getPropertyValue('--border-color').trim() + '80',
                };
                const commonOptions = {
                    responsive: true, maintainAspectRatio: false,
                    scales: {
                        x: { grid: { color: colors.grid }, ticks: { color: colors.text, maxRotation: 0, autoSkip: true, maxTicksLimit: 15 }, grace: '5%' },
                        y: { grid: { color: colors.grid }, ticks: { color: colors.text } }
                    },
                    plugins: {
                        legend: { labels: { color: colors.text, font: { size: 14 } } },
                        tooltip: {
                            backgroundColor: computedStyles.getPropertyValue('--card-bg-color').trim(),
                            titleFont: { size: 16 }, bodyFont: { size: 14 }, padding: 10,
                            borderColor: colors.grid, borderWidth: 1, titleColor: colors.text, bodyColor: colors.text,
                        },
                        zoom: {
                            pan: { enabled: true, mode: 'x', onPanComplete: ({ chart }) => syncCharts(chart) },
                            zoom: {
                                drag: { enabled: false },
                                wheel: { enabled: true }, 
                                pinch: { enabled: true },
                                mode: 'x',
                                onZoomComplete: ({ chart }) => syncCharts(chart)
                            }
                        }
                    },
                    elements: { point: { radius: 0 } },
                    interaction: { intersect: false, mode: 'index' }
                };
                const chartHeight = 450;
                document.querySelectorAll('.chart-card canvas').forEach(c => c.parentElement.style.height = chartHeight + 'px');
                
                chartInstances.chart1 = new Chart(document.getElementById('chart1'), { type: 'line', data: { labels: data.labels, datasets: [{ label: 'Trend Of Stks', data: data.chart1.trendOfStocks, borderColor: colors.magenta, borderWidth: 2, tension: 0.1 }, { label: 'e9 (EMA)', data: data.chart1.e9_trendOfStocks, borderColor: colors.blue, borderWidth: 2, tension: 0.1 }] }, options: commonOptions });
                chartInstances.chart2 = new Chart(document.getElementById('chart2'), { type: 'line', data: { labels: data.labels, datasets: [{ label: 'Proportion', data: data.chart2.proportion, borderColor: colors.yellow, borderWidth: 2, tension: 0.1 }, { label: 'e9 (EMA)', data: data.chart2.e9_proportion, borderColor: colors.blue, borderWidth: 2, tension: 0.1 }] }, options: commonOptions });
                chartInstances.chart3 = new Chart(document.getElementById('chart3'), { type: 'line', data: { labels: data.labels, datasets: [{ label: 'Stocks Above EMA', data: data.chart3.abvEMA, borderColor: colors.green, borderWidth: 2, tension: 0.1 }, { label: 'Stocks Below EMA', data: data.chart3.belEMA, borderColor: colors.red, borderWidth: 2, tension: 0.1 }, { label: 'Net Stocks', data: data.chart3.netStocks, borderColor: colors.text, borderWidth: 1, tension: 0.1, borderDash: [5, 5] }] }, options: commonOptions });
            }
            createCharts(window.chartData);
        })();
    
    </script>
</body>
</html>