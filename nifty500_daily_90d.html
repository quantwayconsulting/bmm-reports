<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nifty 500 - Broad Market Monitor</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/hammer.js/2.0.8/hammer.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-zoom@2.0.1/dist/chartjs-plugin-zoom.min.js"></script>
    <style>
        :root { --bg-color: #1a1b26; --card-bg-color: #24283b; --text-color: #c0caf5; --text-secondary-color: #a9b1d6; --border-color: #414868; --primary-color: #7aa2f7; --green: #9ece6a; --red: #f7768e; --blue: #7aa2f7; --cyan: #7dcfff; --yellow: #e0af68; --magenta: #bb9af7; }
        body[data-theme="bloomberg"] { --bg-color: #0d0d0d; --card-bg-color: #1a1a1a; --text-color: #e0e0e0; --text-secondary-color: #a0a0a0; --border-color: #333333; --primary-color: #ff9900; --green: #00e676; --red: #ff5252; --blue: #2979ff; --cyan: #00e5ff; --yellow: #ffd600; --magenta: #d500f9; }
        body[data-theme="light"] { --bg-color: #f5f7fa; --card-bg-color: #ffffff; --text-color: #1c2a42; --text-secondary-color: #5b6b85; --border-color: #e6e9f0; --primary-color: #0052cc; --green: #00875a; --red: #bf2600; --blue: #0052cc; --cyan: #00a3bf; --yellow: #ffab00; --magenta: #6554c0; }
        body { font-family: 'Segoe UI', 'Roboto', 'Helvetica', sans-serif; background-color: var(--bg-color); color: var(--text-color); margin: 0; padding: 10px; }
        .container { max-width: 1600px; margin: auto; }
        header { text-align: center; margin-bottom: 25px; border-bottom: 1px solid var(--border-color); padding-bottom: 20px; }
        h1 { font-size: 1.5rem; color: var(--text-color); margin: 0 0 5px 0; }
        h2 { margin: 0; color: var(--text-secondary-color); font-weight: 500; font-size: 1rem; }
        .card { background-color: var(--card-bg-color); border: 1px solid var(--border-color); border-radius: 8px; padding: 20px; margin-bottom: 20px; }
        .chart-header { display: flex; flex-direction: column; align-items: flex-start; gap: 10px; border-bottom: 1px solid var(--border-color); padding-bottom: 15px; margin-bottom: 15px; }
        .chart-title { font-size: 1.1rem; color: var(--text-secondary-color); font-weight: 500; }
        .zoom-hint { font-size: 0.8rem; font-style: italic; color: #6c707a; }
        .reset-zoom-btn { background: none; border: 1px solid var(--border-color); color: var(--text-secondary-color); padding: 5px 10px; border-radius: 4px; cursor: pointer; }
        @media (min-width: 600px) { 
            h1 {font-size: 1.8rem;} h2 {font-size: 1.2rem;}
            .chart-header { flex-direction: row; justify-content: space-between; align-items: center;}
        }
    </style>
</head>
<body data-theme="bloomberg">
    <div class="container">
        <header>
            <h1>Nifty 500</h1>
            <h2>Timeframe: Daily | Lookback: 90 Periods</h2>
        </header>
        <div id="charts">
            <div class="card chart-card"><div class="chart-header"><span class="chart-title">Market Trend (Sum)</span><div><span class="zoom-hint">Scroll/Drag to Zoom</span> <button class="reset-zoom-btn" data-chart-id="chart1">Reset</button></div></div><canvas id="chart1"></canvas></div>
            <div class="card chart-card"><div class="chart-header"><span class="chart-title">Market Proportion</span><div><span class="zoom-hint">Scroll/Drag to Zoom</span> <button class="reset-zoom-btn" data-chart-id="chart2">Reset</button></div></div><canvas id="chart2"></canvas></div>
            <div class="card chart-card"><div class="chart-header"><span class="chart-title">Market Breadth</span><div><span class="zoom-hint">Scroll/Drag to Zoom</span> <button class="reset-zoom-btn" data-chart-id="chart3">Reset</button></div></div><canvas id="chart3"></canvas></div>
        </div>
    </div>
    <script>
        window.chartData = {"labels": ["2025-06-25", "2025-06-26", "2025-06-27", "2025-06-30", "2025-07-01", "2025-07-02", "2025-07-03", "2025-07-04", "2025-07-07", "2025-07-08", "2025-07-09", "2025-07-10", "2025-07-11", "2025-07-14", "2025-07-15", "2025-07-16", "2025-07-17", "2025-07-18", "2025-07-21", "2025-07-22", "2025-07-23", "2025-07-24", "2025-07-25", "2025-07-28", "2025-07-29", "2025-07-30", "2025-07-31", "2025-08-01", "2025-08-04", "2025-08-05", "2025-08-06", "2025-08-07", "2025-08-08", "2025-08-11", "2025-08-12", "2025-08-13", "2025-08-14", "2025-08-18", "2025-08-19", "2025-08-20", "2025-08-21", "2025-08-22", "2025-08-25", "2025-08-26", "2025-08-28", "2025-08-29", "2025-09-01", "2025-09-02", "2025-09-03", "2025-09-04", "2025-09-05", "2025-09-08", "2025-09-09", "2025-09-10", "2025-09-11", "2025-09-12", "2025-09-15", "2025-09-16", "2025-09-17", "2025-09-18", "2025-09-19", "2025-09-22", "2025-09-23", "2025-09-24", "2025-09-25", "2025-09-26", "2025-09-29", "2025-09-30", "2025-10-01", "2025-10-03", "2025-10-06", "2025-10-07", "2025-10-08", "2025-10-09", "2025-10-10", "2025-10-13", "2025-10-14", "2025-10-15", "2025-10-16", "2025-10-17", "2025-10-20", "2025-10-21", "2025-10-23", "2025-10-24", "2025-10-27", "2025-10-28", "2025-10-29", "2025-10-30", "2025-10-31", "2025-11-03"], "chart1": {"trendOfStocks": [185, 213, 265, 271, 199, 163, 153, 141, 103, 53, 77, 37, -81, -33, 119, 113, 125, -1, 19, -51, -7, -41, -265, -335, -219, -161, -247, -311, -233, -225, -293, -285, -357, -269, -235, -147, -163, -7, 131, 159, 121, 11, 49, -197, -281, -281, -109, -13, 111, -69, -57, -17, 7, 151, 163, 173, 209, 277, 285, 299, 217, 67, -11, -115, -201, -385, -331, -273, -143, -33, -1, 19, -101, -5, 63, -39, -173, -25, 63, -7, 43, 136, 72, 18, 78, 34, 184, 120, -22, 56], "e9_trendOfStocks": [185.0, 190.6, 205.48, 218.584, 214.66720000000004, 204.33376000000004, 194.06700800000004, 183.45360640000007, 167.36288512000004, 144.49030809600004, 130.99224647680003, 112.19379718144003, 73.55503774515203, 52.24403019612163, 65.5952241568973, 75.07617932551784, 85.06094346041428, 67.84875476833142, 58.079003814665136, 36.263203051732106, 27.61056244138569, 13.88844995310855, -41.88924003751316, -100.51139203001054, -124.20911362400844, -131.56729089920674, -154.6538327193654, -185.92306617549232, -195.33845294039386, -201.2707623523151, -219.6166098818521, -232.6932879054817, -257.55463032438536, -259.8437042595083, -254.87496340760663, -233.29997072608532, -219.23997658086827, -176.79198126469464, -115.23358501175572, -60.38686800940458, -24.109494407523663, -17.087595526018934, -3.8700764208151472, -42.49606113665212, -90.1968489093217, -128.35747912745737, -124.4859833019659, -102.18878664157272, -59.551029313258184, -61.440823450606544, -60.55265876048524, -51.84212700838819, -40.07370160671056, -1.8589612853684443, 31.112830971705247, 59.4902647773642, 89.39221182189138, 126.91376945751311, 158.5310155660105, 186.6248124528084, 192.69984996224673, 167.5598799697974, 131.84790397583794, 82.47832318067036, 25.78265854453629, -56.37387316437096, -111.29909853149678, -143.63927882519744, -143.51142306015797, -121.40913844812637, -97.3273107585011, -74.0618486068009, -79.44947888544073, -64.55958310835258, -39.04766648668207, -39.03813318934566, -65.83050655147653, -57.66440524118123, -33.531524192944985, -28.22521935435599, -13.980175483484794, 16.015859613212164, 27.21268769056973, 25.370150152455786, 35.89612012196463, 35.5168960975717, 65.21351687805736, 76.1708135024459, 56.53665080195672, 56.42932064156538]}, "chart2": {"proportion": [0.3722334004024145, 0.42857142857142855, 0.5331991951710262, 0.545271629778672, 0.40040241448692154, 0.32796780684104626, 0.30784708249496984, 0.2837022132796781, 0.20724346076458752, 0.10663983903420524, 0.15492957746478872, 0.0744466800804829, -0.16297786720321933, -0.06639839034205232, 0.23943661971830985, 0.22736418511066397, 0.2515090543259557, -0.002012072434607646, 0.03822937625754527, -0.10261569416498995, -0.014084507042253521, -0.08249496981891348, -0.5331991951710262, -0.6740442655935613, -0.44064386317907445, -0.323943661971831, -0.4969818913480885, -0.6257545271629779, -0.4688128772635815, -0.45271629778672035, -0.5895372233400402, -0.5734406438631791, -0.7183098591549296, -0.5412474849094567, -0.47283702213279677, -0.29577464788732394, -0.32796780684104626, -0.014084507042253521, 0.2635814889336016, 0.3199195171026157, 0.24346076458752516, 0.022132796780684104, 0.09859154929577464, -0.3963782696177062, -0.5653923541247485, -0.5653923541247485, -0.2193158953722334, -0.026156941649899398, 0.22334004024144868, -0.13883299798792756, -0.11468812877263582, -0.03420523138832998, 0.014084507042253521, 0.3038229376257545, 0.32796780684104626, 0.34808853118712274, 0.42052313883299797, 0.5573440643863179, 0.5734406438631791, 0.6016096579476862, 0.43661971830985913, 0.13480885311871227, -0.022132796780684104, -0.23138832997987926, -0.4044265593561368, -0.7746478873239436, -0.6659959758551308, -0.5492957746478874, -0.28772635814889336, -0.06639839034205232, -0.002012072434607646, 0.03822937625754527, -0.20321931589537223, -0.01006036217303823, 0.1267605633802817, -0.07847082494969819, -0.34808853118712274, -0.05030181086519115, 0.1267605633802817, -0.014084507042253521, 0.08651911468812877, 0.27419354838709675, 0.14516129032258066, 0.036290322580645164, 0.15725806451612903, 0.06854838709677419, 0.3709677419354839, 0.24193548387096775, -0.04435483870967742, 0.11290322580645161], "e9_proportion": [0.3722334004024145, 0.3835010060362173, 0.41344064386317914, 0.43980684104627776, 0.4319259557344065, 0.4111343259557345, 0.3904768772635816, 0.36912194446680097, 0.3367462477263583, 0.2907249659879277, 0.2635658882832999, 0.2257420466427365, 0.14799806387354533, 0.10511877303042581, 0.13198234236800263, 0.1510587109165349, 0.17114877959841907, 0.13651660919181374, 0.11685916260496006, 0.07296419125097006, 0.055554451592325346, 0.027944567310077585, -0.08428418518614318, -0.20223620126762681, -0.24991773364991635, -0.2647229193142993, -0.31117471372105715, -0.37409067640944127, -0.39303511658026935, -0.4049713528215596, -0.44188452692525576, -0.46819575031284044, -0.5182185720812583, -0.522824354646898, -0.5128268881440778, -0.4694164400927271, -0.44112671344239096, -0.3557182721623635, -0.23185831994317052, -0.12150275253401328, -0.048510049109705605, -0.03438147993162767, -0.007786874086147207, -0.08550515319245901, -0.18148259337891692, -0.25826454552808326, -0.2504748154969133, -0.20561124072751052, -0.1198209845337187, -0.12362338722456048, -0.12183633553417555, -0.10431011470500644, -0.08063119035555445, -0.0037403647592926664, 0.06260126956077512, 0.11969872188604466, 0.17986360527543532, 0.25535969709761186, 0.3189758864507253, 0.37550264075011747, 0.3877260562620658, 0.3371426156333951, 0.26528753315057924, 0.16595236052448756, 0.05187657654836268, -0.1134283162260986, -0.22394184815190504, -0.2890126334511015, -0.2887553783906599, -0.24428398078093838, -0.19582959911167225, -0.14901780403782874, -0.15985810640933745, -0.12989855756207763, -0.07856673337360578, -0.07854755168882427, -0.13245574758848397, -0.1160249602438254, -0.067467855519004, -0.05679118582365391, -0.028129125721297377, 0.03233540910038145, 0.0549005853448213, 0.05117853279198607, 0.07239443913681468, 0.07162522872880658, 0.13149373137014206, 0.1535820818703072, 0.11399469775431029, 0.11377640336473856]}, "chart3": {"abvEMA": [341, 355, 381, 384, 348, 330, 325, 319, 300, 275, 287, 267, 208, 232, 308, 305, 311, 248, 258, 223, 245, 228, 116, 81, 139, 168, 125, 93, 132, 136, 102, 106, 70, 114, 131, 175, 167, 245, 314, 328, 309, 254, 273, 150, 108, 108, 194, 242, 304, 214, 220, 240, 252, 324, 330, 335, 353, 387, 391, 398, 357, 282, 243, 191, 148, 56, 83, 112, 177, 232, 248, 258, 198, 246, 280, 229, 162, 236, 280, 245, 270, 316, 284, 257, 287, 265, 340, 308, 237, 276], "belEMA": [156, 142, 116, 113, 149, 167, 172, 178, 197, 222, 210, 230, 289, 265, 189, 192, 186, 249, 239, 274, 252, 269, 381, 416, 358, 329, 372, 404, 365, 361, 395, 391, 427, 383, 366, 322, 330, 252, 183, 169, 188, 243, 224, 347, 389, 389, 303, 255, 193, 283, 277, 257, 245, 173, 167, 162, 144, 110, 106, 99, 140, 215, 254, 306, 349, 441, 414, 385, 320, 265, 249, 239, 299, 251, 217, 268, 335, 261, 217, 252, 227, 180, 212, 239, 209, 231, 156, 188, 259, 220], "e9AbvEMA": [341.0, 343.8, 351.24, 357.79200000000003, 355.83360000000005, 350.66688000000005, 345.53350400000005, 340.22680320000006, 332.18144256000005, 320.7451540480001, 313.99612323840006, 304.59689859072006, 285.2775188725761, 274.62201509806084, 281.2976120784487, 286.038089662759, 291.0304717302072, 282.4243773841658, 277.53950190733264, 266.63160152586613, 262.3052812206929, 255.44422497655432, 227.55537998124345, 198.24430398499476, 186.39544318799582, 182.71635455039666, 171.17308364031734, 155.53846691225388, 150.8307735298031, 147.86461882384248, 138.691695059074, 132.1533560472592, 119.72268483780736, 118.5781478702459, 121.06251829619673, 131.85001463695738, 138.8800117095659, 160.10400936765274, 190.88320749412222, 218.30656599529777, 236.44525279623824, 239.9562022369906, 246.5649617895925, 227.251969431674, 203.40157554533923, 184.3212604362714, 186.25700834901713, 197.40560667921372, 218.724485343371, 217.7795882746968, 218.22367061975746, 222.57893649580598, 228.4631491966448, 247.57051935731585, 264.05641548585265, 278.2451323886821, 293.19610591094573, 311.95688472875656, 327.76550778300526, 341.8124062264042, 344.8499249811234, 332.27993998489876, 314.42395198791905, 289.73916159033524, 261.3913292722682, 220.31306341781456, 192.85045073425167, 176.68036058740134, 176.7442884699211, 187.7954307759369, 199.83634462074951, 211.46907569659962, 208.7752605572797, 216.22020844582374, 228.976166756659, 228.98093340532722, 215.5847467242618, 219.66779737940948, 231.7342379035276, 234.38739032282209, 241.50991225825769, 256.40792980660615, 261.9263438452849, 260.94107507622795, 266.15286006098233, 265.92228804878584, 280.7378304390287, 286.190264351223, 276.35221148097844, 276.2817691847828], "netStocks": [497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 496, 496, 496, 496, 496, 496, 496, 496, 496]}};
    </script>
    <script>
        
        (function() {
            const chartInstances = {};
            let isSyncing = false;

            document.querySelectorAll('.reset-zoom-btn').forEach(button => {
                button.addEventListener('click', (e) => {
                    const chartId = e.target.getAttribute('data-chart-id');
                    if (chartInstances[chartId]) {
                        chartInstances[chartId].resetZoom();
                    }
                });
            });

            function syncCharts(sourceChart) {
                if (isSyncing) return;
                isSyncing = true;
                const { min, max } = sourceChart.scales.x;
                for (const chartId in chartInstances) {
                    const targetChart = chartInstances[chartId];
                    if (targetChart.canvas.id !== sourceChart.canvas.id) {
                        targetChart.options.scales.x.min = min;
                        targetChart.options.scales.x.max = max;
                        targetChart.update('none');
                    }
                }
                isSyncing = false;
            }

            function createCharts(data) {
                const computedStyles = getComputedStyle(document.body);
                const colors = {
                    green: computedStyles.getPropertyValue('--green').trim(), red: computedStyles.getPropertyValue('--red').trim(),
                    blue: computedStyles.getPropertyValue('--blue').trim(), cyan: computedStyles.getPropertyValue('--cyan').trim(),
                    yellow: computedStyles.getPropertyValue('--yellow').trim(), magenta: computedStyles.getPropertyValue('--magenta').trim(),
                    text: computedStyles.getPropertyValue('--text-color').trim(), grid: computedStyles.getPropertyValue('--border-color').trim() + '80',
                };
                const commonOptions = {
                    responsive: true, maintainAspectRatio: false,
                    scales: {
                        x: { grid: { color: colors.grid }, ticks: { color: colors.text, maxRotation: 0, autoSkip: true, maxTicksLimit: 15 }, grace: '5%' },
                        y: { grid: { color: colors.grid }, ticks: { color: colors.text } }
                    },
                    plugins: {
                        legend: { labels: { color: colors.text, font: { size: 14 } } },
                        tooltip: {
                            backgroundColor: computedStyles.getPropertyValue('--card-bg-color').trim(),
                            titleFont: { size: 16 }, bodyFont: { size: 14 }, padding: 10,
                            borderColor: colors.grid, borderWidth: 1, titleColor: colors.text, bodyColor: colors.text,
                        },
                        zoom: {
                            pan: { enabled: true, mode: 'x', onPanComplete: ({ chart }) => syncCharts(chart) },
                            zoom: {
                                drag: { enabled: false },
                                wheel: { enabled: true }, 
                                pinch: { enabled: true },
                                mode: 'x',
                                onZoomComplete: ({ chart }) => syncCharts(chart)
                            }
                        }
                    },
                    elements: { point: { radius: 0 } },
                    interaction: { intersect: false, mode: 'index' }
                };
                const chartHeight = 450;
                document.querySelectorAll('.chart-card canvas').forEach(c => c.parentElement.style.height = chartHeight + 'px');
                
                chartInstances.chart1 = new Chart(document.getElementById('chart1'), { type: 'line', data: { labels: data.labels, datasets: [{ label: 'Trend Of Stks', data: data.chart1.trendOfStocks, borderColor: colors.magenta, borderWidth: 2, tension: 0.1 }, { label: 'e9 (EMA)', data: data.chart1.e9_trendOfStocks, borderColor: colors.blue, borderWidth: 2, tension: 0.1 }] }, options: commonOptions });
                chartInstances.chart2 = new Chart(document.getElementById('chart2'), { type: 'line', data: { labels: data.labels, datasets: [{ label: 'Proportion', data: data.chart2.proportion, borderColor: colors.yellow, borderWidth: 2, tension: 0.1 }, { label: 'e9 (EMA)', data: data.chart2.e9_proportion, borderColor: colors.blue, borderWidth: 2, tension: 0.1 }] }, options: commonOptions });
                chartInstances.chart3 = new Chart(document.getElementById('chart3'), { type: 'line', data: { labels: data.labels, datasets: [{ label: 'Stocks Above EMA', data: data.chart3.abvEMA, borderColor: colors.green, borderWidth: 2, tension: 0.1 }, { label: 'Stocks Below EMA', data: data.chart3.belEMA, borderColor: colors.red, borderWidth: 2, tension: 0.1 }, { label: 'Net Stocks', data: data.chart3.netStocks, borderColor: colors.text, borderWidth: 1, tension: 0.1, borderDash: [5, 5] }] }, options: commonOptions });
            }
            createCharts(window.chartData);
        })();
    
    </script>
</body>
</html>