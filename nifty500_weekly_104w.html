<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nifty 500 - Broad Market Monitor</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/hammer.js/2.0.8/hammer.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-zoom@2.0.1/dist/chartjs-plugin-zoom.min.js"></script>
    <style>
        :root { --bg-color: #1a1b26; --card-bg-color: #24283b; --text-color: #c0caf5; --text-secondary-color: #a9b1d6; --border-color: #414868; --primary-color: #7aa2f7; --green: #9ece6a; --red: #f7768e; --blue: #7aa2f7; --cyan: #7dcfff; --yellow: #e0af68; --magenta: #bb9af7; }
        body[data-theme="bloomberg"] { --bg-color: #0d0d0d; --card-bg-color: #1a1a1a; --text-color: #e0e0e0; --text-secondary-color: #a0a0a0; --border-color: #333333; --primary-color: #ff9900; --green: #00e676; --red: #ff5252; --blue: #2979ff; --cyan: #00e5ff; --yellow: #ffd600; --magenta: #d500f9; }
        body[data-theme="light"] { --bg-color: #f5f7fa; --card-bg-color: #ffffff; --text-color: #1c2a42; --text-secondary-color: #5b6b85; --border-color: #e6e9f0; --primary-color: #0052cc; --green: #00875a; --red: #bf2600; --blue: #0052cc; --cyan: #00a3bf; --yellow: #ffab00; --magenta: #6554c0; }
        body { font-family: 'Segoe UI', 'Roboto', 'Helvetica', sans-serif; background-color: var(--bg-color); color: var(--text-color); margin: 0; padding: 10px; }
        .container { max-width: 1600px; margin: auto; }
        header { text-align: center; margin-bottom: 25px; border-bottom: 1px solid var(--border-color); padding-bottom: 20px; }
        h1 { font-size: 1.5rem; color: var(--text-color); margin: 0 0 5px 0; }
        h2 { margin: 0; color: var(--text-secondary-color); font-weight: 500; font-size: 1rem; }
        .card { background-color: var(--card-bg-color); border: 1px solid var(--border-color); border-radius: 8px; padding: 20px; margin-bottom: 20px; }
        .chart-header { display: flex; flex-direction: column; align-items: flex-start; gap: 10px; border-bottom: 1px solid var(--border-color); padding-bottom: 15px; margin-bottom: 15px; }
        .chart-title { font-size: 1.1rem; color: var(--text-secondary-color); font-weight: 500; }
        .zoom-hint { font-size: 0.8rem; font-style: italic; color: #6c707a; }
        .reset-zoom-btn { background: none; border: 1px solid var(--border-color); color: var(--text-secondary-color); padding: 5px 10px; border-radius: 4px; cursor: pointer; }
        @media (min-width: 600px) { 
            h1 {font-size: 1.8rem;} h2 {font-size: 1.2rem;}
            .chart-header { flex-direction: row; justify-content: space-between; align-items: center;}
        }
    </style>
</head>
<body data-theme="bloomberg">
    <div class="container">
        <header>
            <h1>Nifty 500</h1>
            <h2>Timeframe: Weekly | Lookback: 104 Periods</h2>
        </header>
        <div id="charts">
            <div class="card chart-card"><div class="chart-header"><span class="chart-title">Market Trend (Sum)</span><div><span class="zoom-hint">Scroll/Drag to Zoom</span> <button class="reset-zoom-btn" data-chart-id="chart1">Reset</button></div></div><canvas id="chart1"></canvas></div>
            <div class="card chart-card"><div class="chart-header"><span class="chart-title">Market Proportion</span><div><span class="zoom-hint">Scroll/Drag to Zoom</span> <button class="reset-zoom-btn" data-chart-id="chart2">Reset</button></div></div><canvas id="chart2"></canvas></div>
            <div class="card chart-card"><div class="chart-header"><span class="chart-title">Market Breadth</span><div><span class="zoom-hint">Scroll/Drag to Zoom</span> <button class="reset-zoom-btn" data-chart-id="chart3">Reset</button></div></div><canvas id="chart3"></canvas></div>
        </div>
    </div>
    <script>
        window.chartData = {"labels": ["2023-10-19", "2023-10-27", "2023-11-03", "2023-11-10", "2023-11-17", "2023-11-24", "2023-12-04", "2023-12-11", "2023-12-18", "2023-12-26", "2024-01-02", "2024-01-09", "2024-01-16", "2024-01-23", "2024-01-31", "2024-02-07", "2024-02-14", "2024-02-21", "2024-02-28", "2024-03-05", "2024-03-13", "2024-03-20", "2024-03-28", "2024-04-05", "2024-04-15", "2024-04-23", "2024-04-30", "2024-05-08", "2024-05-15", "2024-05-22", "2024-05-29", "2024-06-05", "2024-06-12", "2024-06-20", "2024-06-27", "2024-07-04", "2024-07-11", "2024-07-19", "2024-07-26", "2024-08-02", "2024-08-09", "2024-08-19", "2024-08-26", "2024-09-02", "2024-09-09", "2024-09-16", "2024-09-23", "2024-09-30", "2024-10-08", "2024-10-15", "2024-10-22", "2024-10-29", "2024-11-05", "2024-11-12", "2024-11-21", "2024-11-28", "2024-12-05", "2024-12-12", "2024-12-19", "2024-12-27", "2025-01-03", "2025-01-10", "2025-01-17", "2025-01-24", "2025-01-31", "2025-02-06", "2025-02-13", "2025-02-20", "2025-02-28", "2025-03-07", "2025-03-17", "2025-03-24", "2025-04-01", "2025-04-08", "2025-04-17", "2025-04-25", "2025-05-05", "2025-05-12", "2025-05-19", "2025-05-26", "2025-06-02", "2025-06-09", "2025-06-16", "2025-06-23", "2025-06-30", "2025-07-07", "2025-07-14", "2025-07-21", "2025-07-28", "2025-08-04", "2025-08-11", "2025-08-19", "2025-08-26", "2025-09-03", "2025-09-10", "2025-09-17", "2025-09-24", "2025-10-01", "2025-10-09", "2025-10-16", "2025-10-24", "2025-10-31", "2025-11-10", "2025-11-17"], "chart1": {"trendOfStocks": [234, -48, 43, 134, 224, 234, 368, 366, 380, 326, 354, 334, 339, 181, 277, 250, 166, 196, 124, 173, -189, -109, 109, 281, 184, 211, 283, 155, 130, 204, 145, 11, 365, 379, 307, 353, 332, 226, 314, 292, 128, 143, 209, 205, 129, 220, 180, 158, -28, 46, -221, -220, -151, -202, -283, -108, 82, 98, -65, -138, -64, -288, -306, -356, -324, -258, -394, -392, -437, -377, -367, -37, -133, -235, 41, 61, 63, 133, 349, 299, 267, 339, 259, 119, 309, 261, 207, 237, -41, -81, -159, -27, -135, -61, 1, 143, 3, -111, -45, -3, 11, 5, -65, 1], "e9_trendOfStocks": [234.0, 177.60000000000002, 150.68, 147.34400000000002, 162.67520000000002, 176.94016000000002, 215.152128, 245.3217024, 272.25736192, 283.005889536, 297.2047116288, 304.56376930304003, 311.45101544243204, 285.3608123539456, 283.6886498831565, 276.9509199065252, 254.76073592522016, 243.00858874017615, 219.20687099214095, 209.96549679371276, 130.1723974349702, 82.33791794797618, 87.67033435838094, 126.33626748670476, 137.86901398936382, 152.49521119149108, 178.59616895319286, 173.8769351625543, 165.10154813004345, 172.88123850403477, 167.3049908032278, 136.04399264258225, 181.8351941140658, 221.26815529125264, 238.41452423300214, 261.3316193864017, 275.46529550912135, 265.5722364072971, 275.2577891258377, 278.6062313006702, 248.48498504053615, 227.38798803242892, 223.71039042594316, 219.96831234075455, 201.77464987260367, 205.41971989808295, 200.33577591846637, 191.8686207347731, 147.8948965878185, 127.5159172702548, 57.812733816203846, 2.250187052963078, -28.39985035762954, -63.11988028610364, -107.09590422888292, -107.27672338310634, -69.42137870648507, -35.93710296518806, -41.749682372150446, -60.99974589772036, -61.59979671817629, -106.87983737454104, -146.70386989963282, -188.56309591970626, -215.65047673576498, -224.120381388612, -258.0963051108896, -284.8770440887117, -315.3016352709694, -327.64130821677554, -335.5130465734204, -275.81043725873633, -247.24834980698907, -244.79867984559127, -187.63894387647304, -137.91115510117845, -97.72892408094276, -51.583139264754216, 28.53348858819662, 82.6267908705573, 119.50143269644585, 163.4011461571567, 182.52091692572537, 169.81673354058032, 197.65338683246426, 210.3227094659714, 209.65816757277713, 215.12653405822172, 163.9012272465774, 114.92098179726192, 60.136785437809536, 42.709428350247634, 7.16754268019811, -6.465965855841512, -4.97277268467321, 24.621781852261435, 20.29742548180915, -5.9620596145526825, -13.769647691642145, -11.615718153313717, -7.092574522650973, -4.674059618120779, -16.739247694496623, -13.1913981555973]}, "chart2": {"proportion": [0.508695652173913, -0.10434782608695652, 0.09327548806941431, 0.29004329004329005, 0.48484848484848486, 0.5064935064935064, 0.7931034482758621, 0.7887931034482759, 0.8189655172413793, 0.6995708154506438, 0.759656652360515, 0.7167381974248928, 0.7259100642398287, 0.3875802997858672, 0.5931477516059958, 0.5341880341880342, 0.3547008547008547, 0.4188034188034188, 0.26495726495726496, 0.36886993603411516, -0.40298507462686567, -0.232409381663113, 0.232409381663113, 0.5966029723991507, 0.3898305084745763, 0.44608879492600423, 0.5983086680761099, 0.3276955602536998, 0.27310924369747897, 0.42857142857142855, 0.3039832285115304, 0.023060796645702306, 0.7651991614255765, 0.7945492662473794, 0.6436058700209644, 0.740041928721174, 0.694560669456067, 0.47280334728033474, 0.6569037656903766, 0.6108786610878661, 0.26666666666666666, 0.2972972972972973, 0.43451143451143454, 0.4261954261954262, 0.2670807453416149, 0.45454545454545453, 0.371900826446281, 0.32644628099173556, -0.05785123966942149, 0.09504132231404959, -0.4556701030927835, -0.45267489711934156, -0.31006160164271046, -0.4139344262295082, -0.5763747454175153, -0.21951219512195122, 0.16666666666666666, 0.1991869918699187, -0.13131313131313133, -0.2782258064516129, -0.12903225806451613, -0.5806451612903226, -0.6169354838709677, -0.717741935483871, -0.6532258064516129, -0.5201612903225806, -0.7943548387096774, -0.7903225806451613, -0.8792756539235412, -0.7585513078470825, -0.738430583501006, -0.0744466800804829, -0.2676056338028169, -0.47283702213279677, 0.08249496981891348, 0.1227364185110664, 0.1267605633802817, 0.2676056338028169, 0.7022132796780685, 0.6016096579476862, 0.5372233400402414, 0.682092555331992, 0.5211267605633803, 0.23943661971830985, 0.6217303822937625, 0.5251509054325956, 0.4164989939637827, 0.4768611670020121, -0.08249496981891348, -0.16297786720321933, -0.3199195171026157, -0.05432595573440644, -0.2716297786720322, -0.1227364185110664, 0.002012072434607646, 0.28772635814889336, 0.006036217303822937, -0.22334004024144868, -0.09054325955734406, -0.006036217303822937, 0.022132796780684104, 0.01006036217303823, -0.13078470824949698, 0.002012072434607646], "e9_proportion": [0.508695652173913, 0.38608695652173913, 0.3275246628312742, 0.32002838827367736, 0.35299240758863887, 0.3836926273696124, 0.46557479155086234, 0.5302184539303451, 0.587967866592552, 0.6102884563641704, 0.6401620955634394, 0.6554773159357301, 0.6695638655965498, 0.6131671524344133, 0.6091632722687299, 0.5941682246525908, 0.5462747506622436, 0.5207804842904787, 0.469615840423836, 0.4494666595458918, 0.2789763127113403, 0.17669917383644967, 0.18784121540178234, 0.269593566801256, 0.2936409551359201, 0.3241305230939369, 0.37896615209037154, 0.36871203372303724, 0.3495914757179256, 0.3653874662886262, 0.35310661873320703, 0.2870974543157061, 0.38271779573768017, 0.46508408983962, 0.5007884458758889, 0.5486391424449459, 0.5778234478471702, 0.5568194277338032, 0.5768362953251179, 0.5836447684776677, 0.5202491481154675, 0.4756587779518335, 0.4674293092637537, 0.45918253265008824, 0.4207621751883936, 0.4275188310598058, 0.4163952301371009, 0.3984054403080279, 0.30715410431253803, 0.26473154791284037, 0.1206512177117156, 0.005985994745504167, -0.05722352453213876, -0.12856570487161267, -0.2181275129807932, -0.21840444940902481, -0.14139022619388653, -0.07327478258112548, -0.08488245232752664, -0.1235511231523439, -0.12464735013477835, -0.2158469123658872, -0.29606462666690336, -0.38040008843029693, -0.43496523203456017, -0.4520044436921643, -0.520474522695667, -0.5744441342855658, -0.6354104382131609, -0.6600386121399452, -0.6757170064121574, -0.5554629411458225, -0.4978914796772214, -0.4928805881683365, -0.37780547657088653, -0.277697097554496, -0.19680556536754049, -0.10392332553346902, 0.05730399550883848, 0.16616512799660804, 0.24037677040533473, 0.3287199273906662, 0.36720129402520907, 0.34164835916382924, 0.3976647637898159, 0.42316199211837185, 0.42182939248745405, 0.4328357473903657, 0.3297696039485099, 0.23122010971816406, 0.12099218435400812, 0.08592855633632521, 0.01441688933465373, -0.013013772234490295, -0.010008603300670707, 0.04953838898924211, 0.04083795465215828, -0.011997644326563119, -0.027706767372719307, -0.023372657358940032, -0.014271566531015203, -0.009405180790204519, -0.03368108628206301, -0.02654245453872888]}, "chart3": {"abvEMA": [347, 206, 252, 298, 343, 348, 416, 415, 422, 396, 410, 400, 403, 324, 372, 359, 317, 332, 296, 321, 140, 180, 289, 376, 328, 342, 378, 314, 303, 340, 311, 244, 421, 428, 392, 415, 405, 352, 396, 385, 304, 312, 345, 343, 306, 352, 332, 321, 228, 265, 132, 133, 168, 143, 104, 192, 287, 295, 215, 179, 216, 104, 95, 70, 86, 119, 51, 52, 30, 60, 65, 230, 182, 131, 269, 279, 280, 315, 423, 398, 382, 418, 378, 308, 403, 379, 352, 367, 228, 208, 169, 235, 181, 218, 249, 320, 250, 193, 226, 247, 254, 251, 216, 249], "belEMA": [113, 254, 209, 164, 119, 114, 48, 49, 42, 70, 56, 66, 64, 143, 95, 109, 151, 136, 172, 148, 329, 289, 180, 95, 144, 131, 95, 159, 173, 136, 166, 233, 56, 49, 85, 62, 73, 126, 82, 93, 176, 169, 136, 138, 177, 132, 152, 163, 256, 219, 353, 353, 319, 345, 387, 300, 205, 197, 280, 317, 280, 392, 401, 426, 410, 377, 445, 444, 467, 437, 432, 267, 315, 366, 228, 218, 217, 182, 74, 99, 115, 79, 119, 189, 94, 118, 145, 130, 269, 289, 328, 262, 316, 279, 248, 177, 247, 304, 271, 250, 243, 246, 281, 248], "e9AbvEMA": [347.0, 318.8, 305.44000000000005, 303.95200000000006, 311.76160000000004, 319.00928000000005, 338.40742400000005, 353.7259392, 367.3807513600001, 373.1046010880001, 380.48368087040006, 384.3869446963201, 388.1095557570561, 375.2876446056449, 374.630115684516, 371.5040925476128, 360.60327403809026, 354.8826192304722, 343.10609538437774, 338.6848763075022, 298.94790104600173, 275.1583208368014, 277.9266566694411, 297.5413253355529, 303.63306026844236, 311.3064482147539, 324.64515857180317, 322.51612685744254, 318.61290148595407, 322.89032118876327, 320.5122569510106, 305.2098055608085, 328.3678444486468, 348.2942755589175, 357.035420447134, 368.6283363577072, 375.90266908616576, 371.12213526893265, 376.0977082151461, 377.87816657211687, 363.1025332576935, 352.8820266061548, 351.30562128492386, 349.6444970279391, 340.9155976223513, 343.13247809788106, 340.90598247830485, 336.92478598264387, 315.1398287861151, 305.1118630288921, 270.4894904231137, 242.99159233849096, 227.99327387079276, 210.9946190966342, 189.59569527730739, 190.07655622184592, 209.46124497747675, 226.5689959819814, 224.25519678558513, 215.20415742846814, 215.3633259427745, 193.09066075421964, 173.47252860337574, 152.77802288270058, 139.42241830616047, 135.3379346449284, 118.47034771594272, 105.1762781727542, 90.14102253820336, 84.11281803056269, 80.29025442445015, 110.23220353956013, 124.58576283164811, 125.8686102653185, 154.4948882122548, 179.39591056980385, 199.5167284558431, 222.6133827646745, 262.6907062117396, 289.7525649693917, 308.20205197551337, 330.16164158041073, 339.7293132643286, 333.38345061146293, 347.30676048917036, 353.64540839133633, 353.3163267130691, 356.05306137045534, 330.4424490963643, 305.9539592770915, 278.5631674216732, 269.8505339373386, 252.0804271498709, 245.26434171989672, 246.0114733759174, 260.8091787007339, 258.64734296058714, 245.5178743684697, 241.61429949477576, 242.69143959582064, 244.95315167665655, 246.16252134132526, 240.13001707306023, 241.9040136584482], "netStocks": [460, 460, 461, 462, 462, 462, 464, 464, 464, 466, 466, 466, 467, 467, 467, 468, 468, 468, 468, 469, 469, 469, 469, 471, 472, 473, 473, 473, 476, 476, 477, 477, 477, 477, 477, 477, 478, 478, 478, 478, 480, 481, 481, 481, 483, 484, 484, 484, 484, 484, 485, 486, 487, 488, 491, 492, 492, 492, 495, 496, 496, 496, 496, 496, 496, 496, 496, 496, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497]}};
    </script>
    <script>
        
        (function() {
            const chartInstances = {};
            let isSyncing = false;

            document.querySelectorAll('.reset-zoom-btn').forEach(button => {
                button.addEventListener('click', (e) => {
                    const chartId = e.target.getAttribute('data-chart-id');
                    if (chartInstances[chartId]) {
                        chartInstances[chartId].resetZoom();
                    }
                });
            });

            function syncCharts(sourceChart) {
                if (isSyncing) return;
                isSyncing = true;
                const { min, max } = sourceChart.scales.x;
                for (const chartId in chartInstances) {
                    const targetChart = chartInstances[chartId];
                    if (targetChart.canvas.id !== sourceChart.canvas.id) {
                        targetChart.options.scales.x.min = min;
                        targetChart.options.scales.x.max = max;
                        targetChart.update('none');
                    }
                }
                isSyncing = false;
            }

            function createCharts(data) {
                const computedStyles = getComputedStyle(document.body);
                const colors = {
                    green: computedStyles.getPropertyValue('--green').trim(), red: computedStyles.getPropertyValue('--red').trim(),
                    blue: computedStyles.getPropertyValue('--blue').trim(), cyan: computedStyles.getPropertyValue('--cyan').trim(),
                    yellow: computedStyles.getPropertyValue('--yellow').trim(), magenta: computedStyles.getPropertyValue('--magenta').trim(),
                    text: computedStyles.getPropertyValue('--text-color').trim(), grid: computedStyles.getPropertyValue('--border-color').trim() + '80',
                };
                const commonOptions = {
                    responsive: true, maintainAspectRatio: false,
                    scales: {
                        x: { grid: { color: colors.grid }, ticks: { color: colors.text, maxRotation: 0, autoSkip: true, maxTicksLimit: 15 }, grace: '5%' },
                        y: { grid: { color: colors.grid }, ticks: { color: colors.text } }
                    },
                    plugins: {
                        legend: { labels: { color: colors.text, font: { size: 14 } } },
                        tooltip: {
                            backgroundColor: computedStyles.getPropertyValue('--card-bg-color').trim(),
                            titleFont: { size: 16 }, bodyFont: { size: 14 }, padding: 10,
                            borderColor: colors.grid, borderWidth: 1, titleColor: colors.text, bodyColor: colors.text,
                        },
                        zoom: {
                            pan: { enabled: true, mode: 'x', onPanComplete: ({ chart }) => syncCharts(chart) },
                            zoom: {
                                drag: { enabled: false },
                                wheel: { enabled: true }, 
                                pinch: { enabled: true },
                                mode: 'x',
                                onZoomComplete: ({ chart }) => syncCharts(chart)
                            }
                        }
                    },
                    elements: { point: { radius: 0 } },
                    interaction: { intersect: false, mode: 'index' }
                };
                const chartHeight = 450;
                document.querySelectorAll('.chart-card canvas').forEach(c => c.parentElement.style.height = chartHeight + 'px');
                
                chartInstances.chart1 = new Chart(document.getElementById('chart1'), { type: 'line', data: { labels: data.labels, datasets: [{ label: 'Trend Of Stks', data: data.chart1.trendOfStocks, borderColor: colors.magenta, borderWidth: 2, tension: 0.1 }, { label: 'e9 (EMA)', data: data.chart1.e9_trendOfStocks, borderColor: colors.blue, borderWidth: 2, tension: 0.1 }] }, options: commonOptions });
                chartInstances.chart2 = new Chart(document.getElementById('chart2'), { type: 'line', data: { labels: data.labels, datasets: [{ label: 'Proportion', data: data.chart2.proportion, borderColor: colors.yellow, borderWidth: 2, tension: 0.1 }, { label: 'e9 (EMA)', data: data.chart2.e9_proportion, borderColor: colors.blue, borderWidth: 2, tension: 0.1 }] }, options: commonOptions });
                chartInstances.chart3 = new Chart(document.getElementById('chart3'), { type: 'line', data: { labels: data.labels, datasets: [{ label: 'Stocks Above EMA', data: data.chart3.abvEMA, borderColor: colors.green, borderWidth: 2, tension: 0.1 }, { label: 'Stocks Below EMA', data: data.chart3.belEMA, borderColor: colors.red, borderWidth: 2, tension: 0.1 }, { label: 'Net Stocks', data: data.chart3.netStocks, borderColor: colors.text, borderWidth: 1, tension: 0.1, borderDash: [5, 5] }] }, options: commonOptions });
            }
            createCharts(window.chartData);
        })();
    
    </script>
</body>
</html>