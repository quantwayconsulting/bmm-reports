<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nifty 500 - Broad Market Monitor</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/hammer.js/2.0.8/hammer.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-zoom@2.0.1/dist/chartjs-plugin-zoom.min.js"></script>
    <style>
        :root { --bg-color: #1a1b26; --card-bg-color: #24283b; --text-color: #c0caf5; --text-secondary-color: #a9b1d6; --border-color: #414868; --primary-color: #7aa2f7; --green: #9ece6a; --red: #f7768e; --blue: #7aa2f7; --cyan: #7dcfff; --yellow: #e0af68; --magenta: #bb9af7; }
        body[data-theme="bloomberg"] { --bg-color: #0d0d0d; --card-bg-color: #1a1a1a; --text-color: #e0e0e0; --text-secondary-color: #a0a0a0; --border-color: #333333; --primary-color: #ff9900; --green: #00e676; --red: #ff5252; --blue: #2979ff; --cyan: #00e5ff; --yellow: #ffd600; --magenta: #d500f9; }
        body[data-theme="light"] { --bg-color: #f5f7fa; --card-bg-color: #ffffff; --text-color: #1c2a42; --text-secondary-color: #5b6b85; --border-color: #e6e9f0; --primary-color: #0052cc; --green: #00875a; --red: #bf2600; --blue: #0052cc; --cyan: #00a3bf; --yellow: #ffab00; --magenta: #6554c0; }
        body { font-family: 'Segoe UI', 'Roboto', 'Helvetica', sans-serif; background-color: var(--bg-color); color: var(--text-color); margin: 0; padding: 10px; }
        .container { max-width: 1600px; margin: auto; }
        header { text-align: center; margin-bottom: 25px; border-bottom: 1px solid var(--border-color); padding-bottom: 20px; }
        h1 { font-size: 1.5rem; color: var(--text-color); margin: 0 0 5px 0; }
        h2 { margin: 0; color: var(--text-secondary-color); font-weight: 500; font-size: 1rem; }
        .card { background-color: var(--card-bg-color); border: 1px solid var(--border-color); border-radius: 8px; padding: 20px; margin-bottom: 20px; }
        .chart-header { display: flex; flex-direction: column; align-items: flex-start; gap: 10px; border-bottom: 1px solid var(--border-color); padding-bottom: 15px; margin-bottom: 15px; }
        .chart-title { font-size: 1.1rem; color: var(--text-secondary-color); font-weight: 500; }
        .zoom-hint { font-size: 0.8rem; font-style: italic; color: #6c707a; }
        .reset-zoom-btn { background: none; border: 1px solid var(--border-color); color: var(--text-secondary-color); padding: 5px 10px; border-radius: 4px; cursor: pointer; }
        @media (min-width: 600px) { 
            h1 {font-size: 1.8rem;} h2 {font-size: 1.2rem;}
            .chart-header { flex-direction: row; justify-content: space-between; align-items: center;}
        }
    </style>
</head>
<body data-theme="bloomberg">
    <div class="container">
        <header>
            <h1>Nifty 500</h1>
            <h2>Timeframe: Weekly | Lookback: 104 Periods</h2>
        </header>
        <div id="charts">
            <div class="card chart-card"><div class="chart-header"><span class="chart-title">Market Trend (Sum)</span><div><span class="zoom-hint">Scroll/Drag to Zoom</span> <button class="reset-zoom-btn" data-chart-id="chart1">Reset</button></div></div><canvas id="chart1"></canvas></div>
            <div class="card chart-card"><div class="chart-header"><span class="chart-title">Market Proportion</span><div><span class="zoom-hint">Scroll/Drag to Zoom</span> <button class="reset-zoom-btn" data-chart-id="chart2">Reset</button></div></div><canvas id="chart2"></canvas></div>
            <div class="card chart-card"><div class="chart-header"><span class="chart-title">Market Breadth</span><div><span class="zoom-hint">Scroll/Drag to Zoom</span> <button class="reset-zoom-btn" data-chart-id="chart3">Reset</button></div></div><canvas id="chart3"></canvas></div>
        </div>
    </div>
    <script>
        window.chartData = {"labels": ["2023-10-16", "2023-10-23", "2023-10-31", "2023-11-07", "2023-11-13", "2023-11-21", "2023-11-29", "2023-12-06", "2023-12-13", "2023-12-20", "2023-12-28", "2024-01-04", "2024-01-11", "2024-01-18", "2024-01-25", "2024-02-02", "2024-02-09", "2024-02-16", "2024-02-23", "2024-03-01", "2024-03-07", "2024-03-15", "2024-03-22", "2024-04-02", "2024-04-09", "2024-04-18", "2024-04-25", "2024-05-03", "2024-05-10", "2024-05-17", "2024-05-24", "2024-05-31", "2024-06-07", "2024-06-14", "2024-06-24", "2024-07-01", "2024-07-08", "2024-07-15", "2024-07-23", "2024-07-30", "2024-08-06", "2024-08-13", "2024-08-21", "2024-08-28", "2024-09-04", "2024-09-11", "2024-09-18", "2024-09-25", "2024-10-03", "2024-10-10", "2024-10-17", "2024-10-24", "2024-10-31", "2024-11-07", "2024-11-14", "2024-11-25", "2024-12-02", "2024-12-09", "2024-12-16", "2024-12-23", "2024-12-31", "2025-01-07", "2025-01-14", "2025-01-21", "2025-01-28", "2025-02-03", "2025-02-10", "2025-02-17", "2025-02-24", "2025-03-04", "2025-03-11", "2025-03-19", "2025-03-26", "2025-04-03", "2025-04-11", "2025-04-22", "2025-04-29", "2025-05-07", "2025-05-14", "2025-05-21", "2025-05-28", "2025-06-04", "2025-06-11", "2025-06-18", "2025-06-25", "2025-07-02", "2025-07-09", "2025-07-16", "2025-07-23", "2025-07-30", "2025-08-06", "2025-08-13", "2025-08-21", "2025-08-29", "2025-09-05", "2025-09-12", "2025-09-19", "2025-09-26", "2025-10-06", "2025-10-13", "2025-10-20", "2025-10-28", "2025-11-04", "2025-11-12"], "chart1": {"trendOfStocks": [258, -8, -10, 146, 170, 238, 275, 382, 370, 291, 356, 378, 352, 267, 225, 267, 212, 212, 222, 176, 107, -95, -37, 211, 239, 116, 239, 225, 55, 186, 187, 61, 243, 375, 331, 343, 319, 340, 214, 342, 37, 67, 205, 229, 226, 129, 150, 188, 94, 28, 0, -217, -150, -119, -291, -157, -52, 108, 68, -176, -138, -124, -360, -328, -406, -308, -296, -414, -397, -415, -363, -213, -111, -7, -163, 189, 75, 13, 225, 311, 277, 275, 361, 167, 251, 275, 271, 299, 199, -1, -135, -143, -15, -219, -91, 31, 165, -161, -7, -9, -9, 44, 2, -18], "e9_trendOfStocks": [258.0, 204.8, 161.84000000000003, 158.67200000000003, 160.93760000000003, 176.35008000000002, 196.08006400000002, 233.26405120000004, 260.61124096000003, 266.68899276800005, 284.5511942144, 303.24095537152004, 312.992764297216, 303.7942114377728, 288.03536915021823, 283.82829532017456, 269.46263625613966, 257.9701090049117, 250.7760872039294, 235.82086976314355, 210.05669581051487, 149.0453566484119, 111.83628531872952, 131.66902825498363, 153.1352226039869, 145.70817808318952, 164.36654246655164, 176.4932339732413, 152.19458717859305, 158.95566974287445, 164.56453579429956, 143.85162863543965, 163.68130290835174, 205.9450423266814, 230.95603386134513, 253.36482708907613, 266.4918616712609, 281.1934893370087, 267.75479146960697, 282.6038331756856, 233.48306654054852, 200.18645323243882, 201.14916258595107, 206.71933006876088, 210.5754640550087, 194.260371244007, 185.4082969952056, 185.92663759616448, 167.5413100769316, 139.63304806154528, 111.70643844923623, 45.96515075938899, 6.772120607511191, -18.382303513991047, -72.90584281119284, -89.72467424895427, -82.17973939916342, -44.14379151933074, -21.715033215464594, -52.57202657237168, -69.65762125789735, -80.52609700631788, -136.42087760505433, -174.7367020840435, -220.9893616672348, -238.39148933378783, -249.9131914670303, -282.73055317362423, -305.5844425388994, -327.46755403111956, -334.57404322489566, -310.25923457991655, -270.40738766393326, -217.72591013114663, -206.7807281049173, -127.62458248393384, -87.09966598714708, -67.07973278971767, -8.66378623177414, 55.26897101458069, 99.61517681166455, 134.69214144933164, 179.95371315946534, 177.3629705275723, 192.09037642205783, 208.6723011376463, 221.13784091011706, 236.71027272809368, 229.16821818247496, 183.13457454598, 119.50765963678401, 67.0061277094272, 50.604902167541766, -3.3160782659665884, -20.852862612773272, -10.48229009021862, 24.614167927825104, -12.508665657739918, -11.406932526191936, -10.925546020953549, -10.54043681676284, 0.3676505465897275, 0.694120437271782, -3.0447036501825746]}, "chart2": {"proportion": [0.5608695652173913, -0.017391304347826087, -0.021739130434782608, 0.31601731601731603, 0.36796536796536794, 0.5151515151515151, 0.593952483801296, 0.8232758620689655, 0.7974137931034483, 0.6258064516129033, 0.7639484978540773, 0.8111587982832618, 0.7553648068669528, 0.5717344753747323, 0.4817987152034261, 0.5717344753747323, 0.452991452991453, 0.452991452991453, 0.47435897435897434, 0.37606837606837606, 0.2281449893390192, -0.2025586353944563, -0.07889125799573561, 0.44798301486199577, 0.5074309978768577, 0.2457627118644068, 0.5052854122621564, 0.47568710359408034, 0.11627906976744186, 0.3907563025210084, 0.3920335429769392, 0.1278825995807128, 0.5094339622641509, 0.7861635220125787, 0.6939203354297694, 0.7190775681341719, 0.6687631027253669, 0.7112970711297071, 0.4476987447698745, 0.7154811715481172, 0.07724425887265135, 0.1392931392931393, 0.4261954261954262, 0.4760914760914761, 0.46887966804979253, 0.2670807453416149, 0.30991735537190085, 0.3884297520661157, 0.19421487603305784, 0.05785123966942149, 0.0, -0.44742268041237115, -0.30864197530864196, -0.24435318275154005, -0.5926680244399185, -0.319755600814664, -0.10569105691056911, 0.21951219512195122, 0.13821138211382114, -0.3548387096774194, -0.2782258064516129, -0.25, -0.7258064516129032, -0.6612903225806451, -0.8185483870967742, -0.6209677419354839, -0.5967741935483871, -0.8346774193548387, -0.7987927565392354, -0.8350100603621731, -0.7303822937625755, -0.42857142857142855, -0.22334004024144868, -0.014084507042253521, -0.32796780684104626, 0.38028169014084506, 0.15090543259557343, 0.026156941649899398, 0.45271629778672035, 0.6257545271629779, 0.5573440643863179, 0.5533199195171026, 0.7263581488933601, 0.33601609657947684, 0.5050301810865191, 0.5533199195171026, 0.545271629778672, 0.6016096579476862, 0.40040241448692154, -0.002012072434607646, -0.2716297786720322, -0.28772635814889336, -0.030181086519114688, -0.44064386317907445, -0.18309859154929578, 0.06237424547283702, 0.3319919517102616, -0.323943661971831, -0.014084507042253521, -0.018108651911468814, -0.018108651911468814, 0.08870967741935484, 0.004032258064516129, -0.036290322580645164], "e9_proportion": [0.5608695652173913, 0.44521739130434784, 0.3518260869565218, 0.34466433276868064, 0.34932453980801814, 0.38248993487671756, 0.4247824446616333, 0.5044811281430998, 0.5630676611351695, 0.5756154192307164, 0.6132820349553886, 0.6528573876209632, 0.6733588714701612, 0.6530339922510754, 0.6187869368415455, 0.6093764445481828, 0.578099446236837, 0.5530778475877602, 0.5373340729420031, 0.5050809335672777, 0.449693744721626, 0.3192432686984095, 0.2396163633595805, 0.28128969366006357, 0.3265179545034224, 0.3103669059756193, 0.3493506072329267, 0.37461790650515747, 0.32295013915761434, 0.33651137183029317, 0.3476158060596224, 0.3036691647638405, 0.3448221242639026, 0.43309040381363784, 0.48525639013686417, 0.5320206257363258, 0.5593691211341341, 0.5897547111332487, 0.5613435178605739, 0.5921710485980826, 0.48918569065299633, 0.41920718038102495, 0.4206048295439052, 0.4317021588534194, 0.43913766069269405, 0.40472627762247826, 0.38576449317236283, 0.3862975449511134, 0.3478810111675023, 0.2898750568678861, 0.2319000454943089, 0.09603550031297288, 0.015100005188649915, -0.03679063239938808, -0.14796611080749417, -0.18232400880892813, -0.16699741842925633, -0.0896954957190148, -0.04411412015244762, -0.10625903805744197, -0.14065239173627617, -0.16252191338902094, -0.2751788210337974, -0.352401121343167, -0.44563057449388843, -0.4806980079822076, -0.5039132450954436, -0.5700660799473226, -0.6158114152657053, -0.6596511442849988, -0.6737973741805141, -0.624752185058697, -0.5444697560952474, -0.43839270628464866, -0.4163077263959282, -0.2569898430885736, -0.1754107879517442, -0.1350972420314155, -0.01753453406778832, 0.11112327817836493, 0.20036743541995553, 0.27095793223938497, 0.36203797557018, 0.35683359977203943, 0.3864729160349354, 0.41984231673136885, 0.4449281793408295, 0.4762644750622009, 0.461092062947145, 0.3684712358707945, 0.24045103296222917, 0.13481555474000467, 0.10181622648818081, -0.006675791445270238, -0.041960351466075345, -0.021093432078292874, 0.049523644679418014, -0.025169816650831796, -0.02295275472911614, -0.021983934165586676, -0.021208877714763104, 0.0007748333120604842, 0.001426318262551613, -0.006117009906087743]}, "chart3": {"abvEMA": [359, 226, 225, 304, 316, 350, 369, 423, 417, 378, 411, 422, 409, 367, 346, 367, 340, 340, 345, 322, 288, 187, 216, 341, 355, 294, 356, 349, 264, 331, 332, 269, 360, 426, 404, 410, 398, 409, 346, 410, 258, 274, 343, 355, 354, 306, 317, 336, 289, 256, 242, 134, 168, 184, 100, 167, 220, 300, 280, 160, 179, 186, 68, 84, 45, 94, 100, 41, 50, 41, 67, 142, 193, 245, 167, 343, 286, 255, 361, 404, 387, 386, 429, 332, 374, 386, 384, 398, 348, 248, 181, 177, 241, 139, 203, 264, 331, 168, 245, 244, 244, 270, 249, 239], "belEMA": [101, 234, 235, 158, 146, 112, 94, 41, 47, 87, 55, 44, 57, 100, 121, 100, 128, 128, 123, 146, 181, 282, 253, 130, 116, 178, 117, 124, 209, 145, 145, 208, 117, 51, 73, 67, 79, 69, 132, 68, 221, 207, 138, 126, 128, 177, 167, 148, 195, 228, 242, 351, 318, 303, 391, 324, 272, 192, 212, 336, 317, 310, 428, 412, 451, 402, 396, 455, 447, 456, 430, 355, 304, 252, 330, 154, 211, 242, 136, 93, 110, 111, 68, 165, 123, 111, 113, 99, 149, 249, 316, 320, 256, 358, 294, 233, 166, 329, 252, 253, 253, 226, 247, 257], "e9AbvEMA": [359.0, 332.4, 310.92, 309.536, 310.8288, 318.66304, 328.730432, 347.58434560000006, 361.4674764800001, 364.7739811840001, 374.0191849472001, 383.61534795776004, 388.69227836620803, 384.35382269296645, 376.68305815437316, 374.74644652349855, 367.7971572187989, 362.2377257750391, 358.7901806200313, 351.4321444960251, 338.7457155968201, 308.39657247745606, 289.91725798196484, 300.13380638557186, 311.1070451084575, 307.685636086766, 317.3485088694128, 323.67880709553026, 311.74304567642423, 315.5944365411394, 318.8755492329115, 308.9004393863292, 319.12035150906337, 340.4962812072507, 353.1970249658006, 364.5576199726405, 371.24609597811246, 378.79687678249, 372.23750142599204, 379.79000114079366, 355.432000912635, 339.145600730108, 339.91648058408646, 342.9331844672692, 345.1465475738154, 337.31723805905233, 333.25379044724184, 333.8030323577935, 324.8424258862348, 311.07394070898783, 297.2591525671903, 264.6073220537523, 245.28585764300183, 233.0286861144015, 206.4229488915212, 198.53835911321698, 202.8306872905736, 222.2645498324589, 233.81163986596712, 219.04931189277372, 211.039449514219, 206.0315596113752, 178.42524768910016, 159.54019815128015, 136.6321585210241, 128.1057268168193, 122.48458145345545, 106.18766516276436, 94.9501321302115, 84.16010570416921, 80.72808456333537, 92.98246765066831, 112.98597412053465, 139.38877929642774, 144.9110234371422, 184.52881874971376, 204.82305499977105, 214.85844399981684, 244.08675519985349, 276.0694041598828, 298.2555233279063, 315.8044186623251, 338.4435349298601, 337.1548279438881, 344.5238623551105, 352.8190898840884, 359.0552719072707, 366.8442175258166, 363.0753740206533, 340.0602992165227, 308.24823937321815, 281.9985914985745, 273.7988731988596, 246.83909855908772, 238.07127884727018, 243.25702307781617, 260.80561846225294, 242.24449476980234, 242.7955958158419, 243.03647665267354, 243.22918132213886, 248.58334505771109, 248.6666760461689, 246.73334083693516], "netStocks": [460, 460, 460, 462, 462, 462, 463, 464, 464, 465, 466, 466, 466, 467, 467, 467, 468, 468, 468, 468, 469, 469, 469, 471, 471, 472, 473, 473, 473, 476, 477, 477, 477, 477, 477, 477, 477, 478, 478, 478, 479, 481, 481, 481, 482, 483, 484, 484, 484, 484, 484, 485, 486, 487, 491, 491, 492, 492, 492, 496, 496, 496, 496, 496, 496, 496, 496, 496, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 496, 496, 496]}};
    </script>
    <script>
        
        (function() {
            const chartInstances = {};
            let isSyncing = false;

            document.querySelectorAll('.reset-zoom-btn').forEach(button => {
                button.addEventListener('click', (e) => {
                    const chartId = e.target.getAttribute('data-chart-id');
                    if (chartInstances[chartId]) {
                        chartInstances[chartId].resetZoom();
                    }
                });
            });

            function syncCharts(sourceChart) {
                if (isSyncing) return;
                isSyncing = true;
                const { min, max } = sourceChart.scales.x;
                for (const chartId in chartInstances) {
                    const targetChart = chartInstances[chartId];
                    if (targetChart.canvas.id !== sourceChart.canvas.id) {
                        targetChart.options.scales.x.min = min;
                        targetChart.options.scales.x.max = max;
                        targetChart.update('none');
                    }
                }
                isSyncing = false;
            }

            function createCharts(data) {
                const computedStyles = getComputedStyle(document.body);
                const colors = {
                    green: computedStyles.getPropertyValue('--green').trim(), red: computedStyles.getPropertyValue('--red').trim(),
                    blue: computedStyles.getPropertyValue('--blue').trim(), cyan: computedStyles.getPropertyValue('--cyan').trim(),
                    yellow: computedStyles.getPropertyValue('--yellow').trim(), magenta: computedStyles.getPropertyValue('--magenta').trim(),
                    text: computedStyles.getPropertyValue('--text-color').trim(), grid: computedStyles.getPropertyValue('--border-color').trim() + '80',
                };
                const commonOptions = {
                    responsive: true, maintainAspectRatio: false,
                    scales: {
                        x: { grid: { color: colors.grid }, ticks: { color: colors.text, maxRotation: 0, autoSkip: true, maxTicksLimit: 15 }, grace: '5%' },
                        y: { grid: { color: colors.grid }, ticks: { color: colors.text } }
                    },
                    plugins: {
                        legend: { labels: { color: colors.text, font: { size: 14 } } },
                        tooltip: {
                            backgroundColor: computedStyles.getPropertyValue('--card-bg-color').trim(),
                            titleFont: { size: 16 }, bodyFont: { size: 14 }, padding: 10,
                            borderColor: colors.grid, borderWidth: 1, titleColor: colors.text, bodyColor: colors.text,
                        },
                        zoom: {
                            pan: { enabled: true, mode: 'x', onPanComplete: ({ chart }) => syncCharts(chart) },
                            zoom: {
                                drag: { enabled: false },
                                wheel: { enabled: true }, 
                                pinch: { enabled: true },
                                mode: 'x',
                                onZoomComplete: ({ chart }) => syncCharts(chart)
                            }
                        }
                    },
                    elements: { point: { radius: 0 } },
                    interaction: { intersect: false, mode: 'index' }
                };
                const chartHeight = 450;
                document.querySelectorAll('.chart-card canvas').forEach(c => c.parentElement.style.height = chartHeight + 'px');
                
                chartInstances.chart1 = new Chart(document.getElementById('chart1'), { type: 'line', data: { labels: data.labels, datasets: [{ label: 'Trend Of Stks', data: data.chart1.trendOfStocks, borderColor: colors.magenta, borderWidth: 2, tension: 0.1 }, { label: 'e9 (EMA)', data: data.chart1.e9_trendOfStocks, borderColor: colors.blue, borderWidth: 2, tension: 0.1 }] }, options: commonOptions });
                chartInstances.chart2 = new Chart(document.getElementById('chart2'), { type: 'line', data: { labels: data.labels, datasets: [{ label: 'Proportion', data: data.chart2.proportion, borderColor: colors.yellow, borderWidth: 2, tension: 0.1 }, { label: 'e9 (EMA)', data: data.chart2.e9_proportion, borderColor: colors.blue, borderWidth: 2, tension: 0.1 }] }, options: commonOptions });
                chartInstances.chart3 = new Chart(document.getElementById('chart3'), { type: 'line', data: { labels: data.labels, datasets: [{ label: 'Stocks Above EMA', data: data.chart3.abvEMA, borderColor: colors.green, borderWidth: 2, tension: 0.1 }, { label: 'Stocks Below EMA', data: data.chart3.belEMA, borderColor: colors.red, borderWidth: 2, tension: 0.1 }, { label: 'Net Stocks', data: data.chart3.netStocks, borderColor: colors.text, borderWidth: 1, tension: 0.1, borderDash: [5, 5] }] }, options: commonOptions });
            }
            createCharts(window.chartData);
        })();
    
    </script>
</body>
</html>