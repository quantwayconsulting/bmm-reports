<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nifty 500 - Broad Market Monitor</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/hammer.js/2.0.8/hammer.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-zoom@2.0.1/dist/chartjs-plugin-zoom.min.js"></script>
    <style>
        :root { --bg-color: #1a1b26; --card-bg-color: #24283b; --text-color: #c0caf5; --text-secondary-color: #a9b1d6; --border-color: #414868; --primary-color: #7aa2f7; --green: #9ece6a; --red: #f7768e; --blue: #7aa2f7; --cyan: #7dcfff; --yellow: #e0af68; --magenta: #bb9af7; }
        body[data-theme="bloomberg"] { --bg-color: #0d0d0d; --card-bg-color: #1a1a1a; --text-color: #e0e0e0; --text-secondary-color: #a0a0a0; --border-color: #333333; --primary-color: #ff9900; --green: #00e676; --red: #ff5252; --blue: #2979ff; --cyan: #00e5ff; --yellow: #ffd600; --magenta: #d500f9; }
        body[data-theme="light"] { --bg-color: #f5f7fa; --card-bg-color: #ffffff; --text-color: #1c2a42; --text-secondary-color: #5b6b85; --border-color: #e6e9f0; --primary-color: #0052cc; --green: #00875a; --red: #bf2600; --blue: #0052cc; --cyan: #00a3bf; --yellow: #ffab00; --magenta: #6554c0; }
        body { font-family: 'Segoe UI', 'Roboto', 'Helvetica', sans-serif; background-color: var(--bg-color); color: var(--text-color); margin: 0; padding: 10px; }
        .container { max-width: 1600px; margin: auto; }
        header { text-align: center; margin-bottom: 25px; border-bottom: 1px solid var(--border-color); padding-bottom: 20px; }
        h1 { font-size: 1.5rem; color: var(--text-color); margin: 0 0 5px 0; }
        h2 { margin: 0; color: var(--text-secondary-color); font-weight: 500; font-size: 1rem; }
        .card { background-color: var(--card-bg-color); border: 1px solid var(--border-color); border-radius: 8px; padding: 20px; margin-bottom: 20px; }
        .chart-header { display: flex; flex-direction: column; align-items: flex-start; gap: 10px; border-bottom: 1px solid var(--border-color); padding-bottom: 15px; margin-bottom: 15px; }
        .chart-title { font-size: 1.1rem; color: var(--text-secondary-color); font-weight: 500; }
        .zoom-hint { font-size: 0.8rem; font-style: italic; color: #6c707a; }
        .reset-zoom-btn { background: none; border: 1px solid var(--border-color); color: var(--text-secondary-color); padding: 5px 10px; border-radius: 4px; cursor: pointer; }
        @media (min-width: 600px) { 
            h1 {font-size: 1.8rem;} h2 {font-size: 1.2rem;}
            .chart-header { flex-direction: row; justify-content: space-between; align-items: center;}
        }
    </style>
</head>
<body data-theme="bloomberg">
    <div class="container">
        <header>
            <h1>Nifty 500</h1>
            <h2>Timeframe: Weekly | Lookback: 104 Periods</h2>
        </header>
        <div id="charts">
            <div class="card chart-card"><div class="chart-header"><span class="chart-title">Market Trend (Sum)</span><div><span class="zoom-hint">Scroll/Drag to Zoom</span> <button class="reset-zoom-btn" data-chart-id="chart1">Reset</button></div></div><canvas id="chart1"></canvas></div>
            <div class="card chart-card"><div class="chart-header"><span class="chart-title">Market Proportion</span><div><span class="zoom-hint">Scroll/Drag to Zoom</span> <button class="reset-zoom-btn" data-chart-id="chart2">Reset</button></div></div><canvas id="chart2"></canvas></div>
            <div class="card chart-card"><div class="chart-header"><span class="chart-title">Market Breadth</span><div><span class="zoom-hint">Scroll/Drag to Zoom</span> <button class="reset-zoom-btn" data-chart-id="chart3">Reset</button></div></div><canvas id="chart3"></canvas></div>
        </div>
    </div>
    <script>
        window.chartData = {"labels": ["2023-10-09", "2023-10-16", "2023-10-23", "2023-10-31", "2023-11-07", "2023-11-13", "2023-11-21", "2023-11-29", "2023-12-06", "2023-12-13", "2023-12-20", "2023-12-28", "2024-01-04", "2024-01-11", "2024-01-18", "2024-01-25", "2024-02-02", "2024-02-09", "2024-02-16", "2024-02-23", "2024-03-01", "2024-03-07", "2024-03-15", "2024-03-22", "2024-04-02", "2024-04-09", "2024-04-18", "2024-04-25", "2024-05-03", "2024-05-10", "2024-05-17", "2024-05-24", "2024-05-31", "2024-06-07", "2024-06-14", "2024-06-24", "2024-07-01", "2024-07-08", "2024-07-15", "2024-07-23", "2024-07-30", "2024-08-06", "2024-08-13", "2024-08-21", "2024-08-28", "2024-09-04", "2024-09-11", "2024-09-18", "2024-09-25", "2024-10-03", "2024-10-10", "2024-10-17", "2024-10-24", "2024-10-31", "2024-11-07", "2024-11-14", "2024-11-25", "2024-12-02", "2024-12-09", "2024-12-16", "2024-12-23", "2024-12-31", "2025-01-07", "2025-01-14", "2025-01-21", "2025-01-28", "2025-02-03", "2025-02-10", "2025-02-17", "2025-02-24", "2025-03-04", "2025-03-11", "2025-03-19", "2025-03-26", "2025-04-03", "2025-04-11", "2025-04-22", "2025-04-29", "2025-05-07", "2025-05-14", "2025-05-21", "2025-05-28", "2025-06-04", "2025-06-11", "2025-06-18", "2025-06-25", "2025-07-02", "2025-07-09", "2025-07-16", "2025-07-23", "2025-07-30", "2025-08-06", "2025-08-13", "2025-08-21", "2025-08-29", "2025-09-05", "2025-09-12", "2025-09-19", "2025-09-26", "2025-10-06", "2025-10-13", "2025-10-20", "2025-10-28", "2025-11-04"], "chart1": {"trendOfStocks": [177, 252, -10, -14, 140, 164, 230, 267, 378, 364, 283, 350, 374, 344, 257, 219, 259, 206, 206, 212, 168, 97, -99, -41, 207, 235, 112, 233, 225, 51, 186, 179, 53, 231, 363, 321, 335, 313, 324, 200, 324, 21, 55, 191, 213, 208, 111, 128, 172, 78, 10, -16, -225, -160, -129, -297, -167, -62, 86, 54, -188, -152, -136, -368, -334, -412, -314, -300, -416, -401, -421, -375, -231, -123, -19, -175, 173, 65, 3, 205, 289, 255, 253, 337, 143, 233, 261, 255, 283, 179, -5, -137, -149, -27, -225, -101, 15, 147, -173, -27, -25, -31, 20, -20], "e9_trendOfStocks": [177.0, 192.0, 151.60000000000002, 118.48000000000003, 122.78400000000003, 131.02720000000005, 150.82176000000004, 174.05740800000004, 214.84592640000005, 244.67674112000003, 252.34139289600003, 271.87311431680007, 292.2984914534401, 302.63879316275205, 293.51103453020164, 278.60882762416134, 274.68706209932907, 260.9496496794633, 249.95971974357064, 242.36777579485653, 227.49422063588523, 201.3953765087082, 141.31630120696656, 104.85304096557324, 125.2824327724586, 147.2259462179669, 140.18075697437354, 158.74460557949882, 171.99568446359905, 147.79654757087923, 155.4372380567034, 160.14979044536273, 138.71983235629017, 157.17586588503212, 198.3406927080257, 222.87255416642057, 245.29804333313646, 258.8384346665092, 271.8707477332074, 257.49659818656596, 270.7972785492528, 220.83782283940224, 187.6702582715218, 188.33620661721744, 193.26896529377396, 196.21517223501917, 179.17213778801533, 168.93771023041228, 169.55016818432983, 151.24013454746387, 122.9921076379711, 95.19368611037689, 31.15494888830152, -7.076040889358783, -31.46083271148703, -84.56866616918963, -101.0549329353517, -93.24394634828137, -57.39515707862509, -35.116125662900075, -65.69290053032006, -82.95432042425605, -93.56345633940485, -148.4507650715239, -185.56061205721915, -230.84848964577532, -247.47879171662026, -257.9830333732962, -289.586426698637, -311.86914135890964, -333.6953130871277, -341.9562504697022, -319.76500037576176, -280.4120003006094, -228.12960024048755, -217.50368019239005, -139.40294415391205, -98.52235532312964, -78.21788425850373, -21.574307406802987, 40.54055407455762, 83.4324432596461, 117.34595460771689, 161.27676368617352, 157.62141094893883, 172.69712875915107, 190.35770300732088, 203.28616240585671, 219.2289299246854, 211.18314393974833, 167.94651515179868, 106.95721212143894, 55.76576969715116, 39.21261575772093, -13.629907393823252, -31.103925915058603, -21.883140732046883, 11.893487414362497, -25.08521006851, -25.468168054808004, -25.374534443846404, -26.499627555077122, -17.1997020440617, -17.75976163524936]}, "chart2": {"proportion": [0.38562091503267976, 0.5478260869565217, -0.021739130434782608, -0.030434782608695653, 0.30303030303030304, 0.354978354978355, 0.49783549783549785, 0.5766738660907127, 0.8146551724137931, 0.7844827586206896, 0.6086021505376344, 0.7510729613733905, 0.8025751072961373, 0.7381974248927039, 0.550321199143469, 0.4689507494646681, 0.5546038543897216, 0.44017094017094016, 0.44017094017094016, 0.452991452991453, 0.358974358974359, 0.2068230277185501, -0.21108742004264391, -0.08742004264392324, 0.4394904458598726, 0.4989384288747346, 0.23728813559322035, 0.492600422832981, 0.47568710359408034, 0.10782241014799154, 0.3907563025210084, 0.3752620545073375, 0.1111111111111111, 0.48427672955974843, 0.7610062893081762, 0.6729559748427673, 0.7023060796645703, 0.6561844863731656, 0.6778242677824268, 0.41841004184100417, 0.6778242677824268, 0.04384133611691023, 0.11434511434511435, 0.3970893970893971, 0.44282744282744285, 0.4315352697095436, 0.22981366459627328, 0.2644628099173554, 0.35537190082644626, 0.16115702479338842, 0.02066115702479339, -0.03305785123966942, -0.4639175257731959, -0.3292181069958848, -0.2648870636550308, -0.604887983706721, -0.34012219959266804, -0.12601626016260162, 0.17479674796747968, 0.10975609756097561, -0.3790322580645161, -0.3064516129032258, -0.27419354838709675, -0.7419354838709677, -0.6733870967741935, -0.8306451612903226, -0.6330645161290323, -0.6048387096774194, -0.8387096774193549, -0.806841046277666, -0.8470824949698189, -0.7545271629778671, -0.4647887323943662, -0.24748490945674045, -0.03822937625754527, -0.352112676056338, 0.34808853118712274, 0.13078470824949698, 0.006036217303822937, 0.4124748490945674, 0.5814889336016097, 0.5130784708249497, 0.5090543259557344, 0.6780684104627767, 0.28772635814889336, 0.4688128772635815, 0.5251509054325956, 0.5130784708249497, 0.5694164989939637, 0.36016096579476864, -0.01006036217303823, -0.27565392354124746, -0.29979879275653926, -0.05432595573440644, -0.45271629778672035, -0.20321931589537223, 0.030181086519114688, 0.29577464788732394, -0.34808853118712274, -0.05432595573440644, -0.05030181086519115, -0.06237424547283702, 0.04032258064516129, -0.04032258064516129], "e9_proportion": [0.38562091503267976, 0.4180619494174481, 0.330101733447002, 0.2579944302358625, 0.2670016047947506, 0.2845969548314715, 0.3272446634322768, 0.377130503963964, 0.4646354376539299, 0.5286049018472819, 0.5446043515853525, 0.5858980735429601, 0.6292334802935955, 0.6510262692134172, 0.6308852551994276, 0.5984983540524758, 0.5897194541199249, 0.559809751330128, 0.5358819890982904, 0.519303881876923, 0.4872379772964102, 0.43115498738083824, 0.3027065058961418, 0.2246811961881288, 0.2676430461224776, 0.313902122672929, 0.29857932525698727, 0.337383544772186, 0.3650442565365649, 0.31359988725885024, 0.3290311703112819, 0.338277347150493, 0.2928440999426166, 0.331130625866043, 0.4171057585544697, 0.46827580181212924, 0.5150818573826175, 0.5433023831807271, 0.5702067601010671, 0.5398474164490545, 0.567442786715729, 0.46272249659596526, 0.3930470201457951, 0.39385549553451554, 0.403649884993101, 0.4092269619363896, 0.37334430246836636, 0.3515680039581642, 0.3523287833318206, 0.3140944316241342, 0.255407776704266, 0.19771465111547895, 0.065388215737744, -0.013533048808981755, -0.06380385177819156, -0.17202067816389746, -0.20564098244965157, -0.1897160379922416, -0.11681348080029735, -0.07149956512804276, -0.13300610371533744, -0.16769520555291512, -0.18899487411975147, -0.2995829960699947, -0.37434381621083446, -0.4656040852267321, -0.4990961714071921, -0.5202446790612376, -0.5839376787328611, -0.6285183522418221, -0.6722311807874215, -0.6886903772255106, -0.6439100482592818, -0.5646250204987735, -0.45934589165052786, -0.43789924853168993, -0.28070169258792743, -0.19840441242044254, -0.15751628647558946, -0.0435180593615581, 0.08148333923107545, 0.1678023655498503, 0.23605275763102712, 0.32445588819737703, 0.31710998218768033, 0.3474505612028606, 0.3829906300488076, 0.40900819820403606, 0.44108985836202164, 0.42490407984857104, 0.3379111914442492, 0.21519816844714984, 0.11219877620641203, 0.07889382981824833, -0.027428195702745406, -0.06258641974127077, -0.04403291848919368, 0.02392859478610985, -0.050474830408536675, -0.05124505547371063, -0.05105640655200674, -0.0533199743361728, -0.03459146333990598, -0.03573768680095704]}, "chart3": {"abvEMA": [318, 356, 225, 223, 301, 313, 346, 365, 421, 414, 374, 408, 420, 405, 362, 343, 363, 337, 337, 340, 318, 283, 185, 214, 339, 353, 292, 353, 349, 262, 331, 328, 265, 354, 420, 399, 406, 395, 401, 339, 401, 250, 268, 336, 347, 345, 297, 306, 328, 281, 247, 234, 130, 163, 179, 97, 162, 215, 289, 273, 154, 172, 180, 64, 81, 42, 91, 98, 40, 48, 38, 61, 133, 187, 239, 161, 335, 281, 250, 351, 393, 376, 375, 417, 320, 365, 379, 376, 390, 338, 246, 180, 174, 235, 136, 198, 256, 322, 162, 235, 236, 233, 258, 238], "belEMA": [141, 104, 235, 237, 161, 149, 116, 98, 43, 50, 91, 58, 46, 61, 105, 124, 104, 131, 131, 128, 150, 186, 284, 255, 132, 118, 180, 120, 124, 211, 145, 149, 212, 123, 57, 78, 71, 82, 77, 139, 77, 229, 213, 145, 134, 137, 186, 178, 156, 203, 237, 250, 355, 323, 308, 394, 329, 277, 203, 219, 342, 324, 316, 432, 415, 454, 405, 398, 456, 449, 459, 436, 364, 310, 258, 336, 162, 216, 247, 146, 104, 121, 122, 80, 177, 132, 118, 121, 107, 159, 251, 317, 323, 262, 361, 299, 241, 175, 335, 262, 261, 264, 238, 258], "e9AbvEMA": [318.0, 325.6, 305.48, 288.98400000000004, 291.38720000000006, 295.7097600000001, 305.76780800000006, 317.61424640000007, 338.29139712000006, 353.43311769600007, 357.54649415680007, 367.6371953254401, 378.10975626035207, 383.48780500828167, 379.19024400662533, 371.9521952053003, 370.1617561642403, 363.52940493139226, 358.2235239451138, 354.5788191560911, 347.2630553248729, 334.4104442598983, 304.5283554079187, 286.42268432633495, 296.93814746106796, 308.1505179688544, 304.9204143750835, 314.5363315000668, 321.42906520005346, 309.5432521600428, 313.8346017280343, 316.6676813824274, 306.33414510594196, 315.86731608475355, 336.6938528678029, 349.15508229424233, 360.52406583539386, 367.4192526683151, 374.13540213465205, 367.10832170772164, 373.8866573661773, 349.10932589294185, 332.8874607143535, 333.5099685714828, 336.2079748571863, 337.96637988574906, 329.7731039085993, 325.01848312687946, 325.6147865015036, 316.6918292012029, 302.7534633609623, 289.0027706887699, 257.2022165510159, 238.36177324081274, 226.48941859265022, 200.59153487412019, 192.87322789929615, 197.29858231943695, 215.63886585554957, 227.11109268443965, 212.48887414755174, 204.3910993180414, 199.51287945443312, 172.4103035635465, 154.1282428508372, 131.70259428066979, 123.56207542453583, 118.44966033962868, 102.75972827170295, 91.80778261736236, 81.04622609388989, 77.03698087511191, 88.22958470008953, 107.98366776007163, 134.18693420805732, 139.54954736644586, 178.6396378931567, 199.1117103145254, 209.28936825162032, 237.63149460129625, 268.705195681037, 290.1641565448296, 307.1313252358637, 329.10506018869097, 327.2840481509528, 334.82723852076225, 343.6617908166098, 350.12943265328784, 358.1035461226303, 354.0828368981043, 332.46626951848344, 301.9730156147868, 276.37841249182947, 268.1027299934636, 241.68218399477087, 232.9457471958167, 237.5565977566534, 254.44527820532272, 235.95622256425818, 235.76497805140656, 235.81198244112528, 235.24958595290022, 239.79966876232018, 239.43973500985615], "netStocks": [459, 460, 460, 460, 462, 462, 462, 463, 464, 464, 465, 466, 466, 466, 467, 467, 467, 468, 468, 468, 468, 469, 469, 469, 471, 471, 472, 473, 473, 473, 476, 477, 477, 477, 477, 477, 477, 477, 478, 478, 478, 479, 481, 481, 481, 482, 483, 484, 484, 484, 484, 484, 485, 486, 487, 491, 491, 492, 492, 492, 496, 496, 496, 496, 496, 496, 496, 496, 496, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 496, 496]}};
    </script>
    <script>
        
        (function() {
            const chartInstances = {};
            let isSyncing = false;

            document.querySelectorAll('.reset-zoom-btn').forEach(button => {
                button.addEventListener('click', (e) => {
                    const chartId = e.target.getAttribute('data-chart-id');
                    if (chartInstances[chartId]) {
                        chartInstances[chartId].resetZoom();
                    }
                });
            });

            function syncCharts(sourceChart) {
                if (isSyncing) return;
                isSyncing = true;
                const { min, max } = sourceChart.scales.x;
                for (const chartId in chartInstances) {
                    const targetChart = chartInstances[chartId];
                    if (targetChart.canvas.id !== sourceChart.canvas.id) {
                        targetChart.options.scales.x.min = min;
                        targetChart.options.scales.x.max = max;
                        targetChart.update('none');
                    }
                }
                isSyncing = false;
            }

            function createCharts(data) {
                const computedStyles = getComputedStyle(document.body);
                const colors = {
                    green: computedStyles.getPropertyValue('--green').trim(), red: computedStyles.getPropertyValue('--red').trim(),
                    blue: computedStyles.getPropertyValue('--blue').trim(), cyan: computedStyles.getPropertyValue('--cyan').trim(),
                    yellow: computedStyles.getPropertyValue('--yellow').trim(), magenta: computedStyles.getPropertyValue('--magenta').trim(),
                    text: computedStyles.getPropertyValue('--text-color').trim(), grid: computedStyles.getPropertyValue('--border-color').trim() + '80',
                };
                const commonOptions = {
                    responsive: true, maintainAspectRatio: false,
                    scales: {
                        x: { grid: { color: colors.grid }, ticks: { color: colors.text, maxRotation: 0, autoSkip: true, maxTicksLimit: 15 }, grace: '5%' },
                        y: { grid: { color: colors.grid }, ticks: { color: colors.text } }
                    },
                    plugins: {
                        legend: { labels: { color: colors.text, font: { size: 14 } } },
                        tooltip: {
                            backgroundColor: computedStyles.getPropertyValue('--card-bg-color').trim(),
                            titleFont: { size: 16 }, bodyFont: { size: 14 }, padding: 10,
                            borderColor: colors.grid, borderWidth: 1, titleColor: colors.text, bodyColor: colors.text,
                        },
                        zoom: {
                            pan: { enabled: true, mode: 'x', onPanComplete: ({ chart }) => syncCharts(chart) },
                            zoom: {
                                drag: { enabled: false },
                                wheel: { enabled: true }, 
                                pinch: { enabled: true },
                                mode: 'x',
                                onZoomComplete: ({ chart }) => syncCharts(chart)
                            }
                        }
                    },
                    elements: { point: { radius: 0 } },
                    interaction: { intersect: false, mode: 'index' }
                };
                const chartHeight = 450;
                document.querySelectorAll('.chart-card canvas').forEach(c => c.parentElement.style.height = chartHeight + 'px');
                
                chartInstances.chart1 = new Chart(document.getElementById('chart1'), { type: 'line', data: { labels: data.labels, datasets: [{ label: 'Trend Of Stks', data: data.chart1.trendOfStocks, borderColor: colors.magenta, borderWidth: 2, tension: 0.1 }, { label: 'e9 (EMA)', data: data.chart1.e9_trendOfStocks, borderColor: colors.blue, borderWidth: 2, tension: 0.1 }] }, options: commonOptions });
                chartInstances.chart2 = new Chart(document.getElementById('chart2'), { type: 'line', data: { labels: data.labels, datasets: [{ label: 'Proportion', data: data.chart2.proportion, borderColor: colors.yellow, borderWidth: 2, tension: 0.1 }, { label: 'e9 (EMA)', data: data.chart2.e9_proportion, borderColor: colors.blue, borderWidth: 2, tension: 0.1 }] }, options: commonOptions });
                chartInstances.chart3 = new Chart(document.getElementById('chart3'), { type: 'line', data: { labels: data.labels, datasets: [{ label: 'Stocks Above EMA', data: data.chart3.abvEMA, borderColor: colors.green, borderWidth: 2, tension: 0.1 }, { label: 'Stocks Below EMA', data: data.chart3.belEMA, borderColor: colors.red, borderWidth: 2, tension: 0.1 }, { label: 'Net Stocks', data: data.chart3.netStocks, borderColor: colors.text, borderWidth: 1, tension: 0.1, borderDash: [5, 5] }] }, options: commonOptions });
            }
            createCharts(window.chartData);
        })();
    
    </script>
</body>
</html>