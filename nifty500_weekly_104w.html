<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nifty 500 - Broad Market Monitor</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/hammer.js/2.0.8/hammer.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-zoom@2.0.1/dist/chartjs-plugin-zoom.min.js"></script>
    <style>
        :root { --bg-color: #1a1b26; --card-bg-color: #24283b; --text-color: #c0caf5; --text-secondary-color: #a9b1d6; --border-color: #414868; --primary-color: #7aa2f7; --green: #9ece6a; --red: #f7768e; --blue: #7aa2f7; --cyan: #7dcfff; --yellow: #e0af68; --magenta: #bb9af7; }
        body[data-theme="bloomberg"] { --bg-color: #0d0d0d; --card-bg-color: #1a1a1a; --text-color: #e0e0e0; --text-secondary-color: #a0a0a0; --border-color: #333333; --primary-color: #ff9900; --green: #00e676; --red: #ff5252; --blue: #2979ff; --cyan: #00e5ff; --yellow: #ffd600; --magenta: #d500f9; }
        body[data-theme="light"] { --bg-color: #f5f7fa; --card-bg-color: #ffffff; --text-color: #1c2a42; --text-secondary-color: #5b6b85; --border-color: #e6e9f0; --primary-color: #0052cc; --green: #00875a; --red: #bf2600; --blue: #0052cc; --cyan: #00a3bf; --yellow: #ffab00; --magenta: #6554c0; }
        body { font-family: 'Segoe UI', 'Roboto', 'Helvetica', sans-serif; background-color: var(--bg-color); color: var(--text-color); margin: 0; padding: 10px; }
        .container { max-width: 1600px; margin: auto; }
        header { text-align: center; margin-bottom: 25px; border-bottom: 1px solid var(--border-color); padding-bottom: 20px; }
        h1 { font-size: 1.5rem; color: var(--text-color); margin: 0 0 5px 0; }
        h2 { margin: 0; color: var(--text-secondary-color); font-weight: 500; font-size: 1rem; }
        .card { background-color: var(--card-bg-color); border: 1px solid var(--border-color); border-radius: 8px; padding: 20px; margin-bottom: 20px; }
        .chart-header { display: flex; flex-direction: column; align-items: flex-start; gap: 10px; border-bottom: 1px solid var(--border-color); padding-bottom: 15px; margin-bottom: 15px; }
        .chart-title { font-size: 1.1rem; color: var(--text-secondary-color); font-weight: 500; }
        .zoom-hint { font-size: 0.8rem; font-style: italic; color: #6c707a; }
        .reset-zoom-btn { background: none; border: 1px solid var(--border-color); color: var(--text-secondary-color); padding: 5px 10px; border-radius: 4px; cursor: pointer; }
        @media (min-width: 600px) { 
            h1 {font-size: 1.8rem;} h2 {font-size: 1.2rem;}
            .chart-header { flex-direction: row; justify-content: space-between; align-items: center;}
        }
    </style>
</head>
<body data-theme="bloomberg">
    <div class="container">
        <header>
            <h1>Nifty 500</h1>
            <h2>Timeframe: Weekly | Lookback: 104 Periods</h2>
        </header>
        <div id="charts">
            <div class="card chart-card"><div class="chart-header"><span class="chart-title">Market Trend (Sum)</span><div><span class="zoom-hint">Scroll/Drag to Zoom</span> <button class="reset-zoom-btn" data-chart-id="chart1">Reset</button></div></div><canvas id="chart1"></canvas></div>
            <div class="card chart-card"><div class="chart-header"><span class="chart-title">Market Proportion</span><div><span class="zoom-hint">Scroll/Drag to Zoom</span> <button class="reset-zoom-btn" data-chart-id="chart2">Reset</button></div></div><canvas id="chart2"></canvas></div>
            <div class="card chart-card"><div class="chart-header"><span class="chart-title">Market Breadth</span><div><span class="zoom-hint">Scroll/Drag to Zoom</span> <button class="reset-zoom-btn" data-chart-id="chart3">Reset</button></div></div><canvas id="chart3"></canvas></div>
        </div>
    </div>
    <script>
        window.chartData = {"labels": ["2023-12-06", "2023-12-13", "2023-12-20", "2023-12-28", "2024-01-04", "2024-01-11", "2024-01-18", "2024-01-25", "2024-02-02", "2024-02-09", "2024-02-16", "2024-02-23", "2024-03-01", "2024-03-07", "2024-03-15", "2024-03-22", "2024-04-02", "2024-04-09", "2024-04-18", "2024-04-25", "2024-05-03", "2024-05-10", "2024-05-17", "2024-05-24", "2024-05-31", "2024-06-07", "2024-06-14", "2024-06-24", "2024-07-01", "2024-07-08", "2024-07-15", "2024-07-23", "2024-07-30", "2024-08-06", "2024-08-13", "2024-08-21", "2024-08-28", "2024-09-04", "2024-09-11", "2024-09-18", "2024-09-25", "2024-10-03", "2024-10-10", "2024-10-17", "2024-10-24", "2024-10-31", "2024-11-07", "2024-11-14", "2024-11-25", "2024-12-02", "2024-12-09", "2024-12-16", "2024-12-23", "2024-12-31", "2025-01-07", "2025-01-14", "2025-01-21", "2025-01-28", "2025-02-03", "2025-02-10", "2025-02-17", "2025-02-24", "2025-03-04", "2025-03-11", "2025-03-19", "2025-03-26", "2025-04-03", "2025-04-11", "2025-04-22", "2025-04-29", "2025-05-07", "2025-05-14", "2025-05-21", "2025-05-28", "2025-06-04", "2025-06-11", "2025-06-18", "2025-06-25", "2025-07-02", "2025-07-09", "2025-07-16", "2025-07-23", "2025-07-30", "2025-08-06", "2025-08-13", "2025-08-21", "2025-08-29", "2025-09-05", "2025-09-12", "2025-09-19", "2025-09-26", "2025-10-06", "2025-10-13", "2025-10-20", "2025-10-28", "2025-11-04", "2025-11-12", "2025-11-19", "2025-11-26", "2025-12-03", "2025-12-10", "2025-12-17", "2025-12-24", "2026-01-01"], "chart1": {"trendOfStocks": [381, 369, 290, 355, 377, 351, 266, 224, 266, 211, 211, 221, 175, 106, -96, -38, 210, 238, 115, 238, 224, 54, 187, 188, 62, 242, 374, 332, 342, 318, 339, 213, 341, 36, 66, 204, 228, 225, 130, 151, 189, 95, 29, 1, -216, -149, -118, -290, -156, -51, 109, 69, -175, -137, -123, -359, -327, -405, -307, -295, -413, -396, -414, -362, -212, -110, -6, -162, 190, 76, 12, 224, 310, 276, 274, 360, 168, 252, 276, 270, 300, 200, 0, -134, -142, -16, -218, -92, 30, 164, -160, -8, -8, -8, 44, 2, -20, -58, -80, -158, -228, -192, -72, -76], "e9_trendOfStocks": [381.0, 378.6, 360.88000000000005, 359.70400000000006, 363.1632000000001, 360.7305600000001, 341.78444800000005, 318.2275584000001, 307.7820467200001, 288.4256373760001, 272.9405099008001, 262.5524079206401, 245.04192633651212, 217.2335410692097, 154.5868328553678, 116.06946628429424, 134.8555730274354, 155.48445842194835, 147.3875667375587, 165.51005339004698, 177.2080427120376, 152.5664341696301, 159.45314733570407, 165.16251786856327, 144.53001429485062, 164.0240114358805, 206.01920914870442, 231.21536731896356, 253.37229385517085, 266.2978350841367, 280.83826806730934, 267.2706144538475, 282.016491563078, 232.81319325046238, 199.4505546003699, 200.36044368029596, 205.88835494423677, 209.7106839553894, 193.76854716431154, 185.21483773144922, 185.9718701851594, 167.7774961481275, 140.02199691850203, 112.21759753480163, 46.57407802784131, 7.459262422273046, -17.632590062181563, -72.10607204974525, -88.88485763979621, -81.30788611183698, -43.24630888946959, -20.79704711157567, -51.637637689260536, -68.71011015140843, -79.56808812112675, -135.4544704969014, -173.76357639752112, -220.0108611180169, -237.40868889441353, -248.92695111553084, -281.7415608924247, -304.5932487139398, -326.47459897115186, -333.57967917692156, -309.2637433415373, -269.4109946732299, -216.7287957385839, -205.78303659086714, -126.62642927269371, -86.10114341815498, -66.48091473452398, -8.384731787619181, 55.29221456990466, 99.43377165592374, 134.347017324739, 179.4776138597912, 177.18209108783296, 192.14567287026637, 208.9165382962131, 221.1332306369705, 236.90658450957642, 229.52526760766114, 183.62021408612893, 120.09617126890315, 67.67693701512252, 50.941549612098015, -2.846760310321585, -20.67740824825727, -10.541926598605816, 24.36645872111535, -12.506833023107717, -11.605466418486174, -10.88437313478894, -10.307498507831152, 0.5540011937350791, 0.8432009549880632, -3.3254392360095495, -14.260351388807642, -27.408281111046115, -53.52662488883689, -88.42129991106953, -109.13703992885563, -101.70963194308452, -96.56770555446762]}, "chart2": {"proportion": [0.8228941684665226, 0.796976241900648, 0.625, 0.7634408602150538, 0.810752688172043, 0.7548387096774194, 0.5708154506437768, 0.48068669527896996, 0.5708154506437768, 0.4518201284796574, 0.4518201284796574, 0.4732334047109208, 0.3747323340471092, 0.2264957264957265, -0.20512820512820512, -0.0811965811965812, 0.44680851063829785, 0.5063829787234042, 0.24416135881104034, 0.5042372881355932, 0.4745762711864407, 0.11440677966101695, 0.3936842105263158, 0.3949579831932773, 0.13025210084033614, 0.5084033613445378, 0.7857142857142857, 0.6974789915966386, 0.7184873949579832, 0.6680672268907563, 0.710691823899371, 0.44654088050314467, 0.7148846960167715, 0.07531380753138076, 0.1375, 0.425, 0.475, 0.4677754677754678, 0.2697095435684647, 0.31262939958592134, 0.391304347826087, 0.19668737060041408, 0.060041407867494824, 0.002070393374741201, -0.4462809917355372, -0.30721649484536084, -0.24279835390946503, -0.5918367346938775, -0.3183673469387755, -0.10386965376782077, 0.2219959266802444, 0.14052953156822812, -0.35353535353535354, -0.2767676767676768, -0.24848484848484848, -0.7252525252525253, -0.6606060606060606, -0.8181818181818182, -0.6202020202020202, -0.5959595959595959, -0.8343434343434344, -0.7983870967741935, -0.8346774193548387, -0.7298387096774194, -0.4274193548387097, -0.2217741935483871, -0.012096774193548387, -0.32661290322580644, 0.38306451612903225, 0.1532258064516129, 0.024193548387096774, 0.45161290322580644, 0.625, 0.5564516129032258, 0.5524193548387096, 0.7258064516129032, 0.3387096774193548, 0.5080645161290323, 0.5564516129032258, 0.5443548387096774, 0.6048387096774194, 0.4032258064516129, 0.0, -0.2701612903225806, -0.2862903225806452, -0.03225806451612903, -0.43951612903225806, -0.18548387096774194, 0.06048387096774194, 0.33064516129032256, -0.3225806451612903, -0.016129032258064516, -0.016129032258064516, -0.016129032258064516, 0.08870967741935484, 0.004032258064516129, -0.04032258064516129, -0.11693548387096774, -0.16129032258064516, -0.3185483870967742, -0.4596774193548387, -0.3870967741935484, -0.14516129032258066, -0.1532258064516129], "e9_proportion": [0.8228941684665226, 0.8177105831533478, 0.7791684665226782, 0.7760229452611535, 0.7829688938433315, 0.7773428570101492, 0.7360373757368748, 0.6849672396452938, 0.6621368818449904, 0.6200735311719239, 0.5864228506334705, 0.5637849614489606, 0.5259744359685904, 0.46607869407401764, 0.3318373142335731, 0.24923053514754223, 0.2887461302456934, 0.33227349994123556, 0.3146510717151965, 0.3525683149992759, 0.37696990623670884, 0.32445728092157045, 0.33830266684251953, 0.34963373011267107, 0.30575740425820414, 0.3462865956754709, 0.4341721336832339, 0.48683350526591485, 0.5331642832043285, 0.5601448719416141, 0.5902542623331655, 0.5615115859671613, 0.5921862079770834, 0.4888117278879429, 0.4185493823103544, 0.41983950584828356, 0.43087160467862684, 0.43825237729799504, 0.404543810552089, 0.3861609283588555, 0.3871896122523018, 0.3490891639219243, 0.2912796127110384, 0.23343776884377898, 0.09749401672791576, 0.016551914413260448, -0.03531813925128465, -0.14662185833980323, -0.18097095605959768, -0.1655506956012423, -0.08804137114494495, -0.04232719060231034, -0.10456882318891897, -0.13900859390467055, -0.16090384482070613, -0.27377358090707, -0.35114007684686815, -0.44454842511385817, -0.4796791441314906, -0.5029352344971116, -0.5692168744663761, -0.6150509189279396, -0.6589762190133195, -0.6731487171461396, -0.6240028446846536, -0.5435571144574003, -0.43726504640462993, -0.41513461776886523, -0.2554947909892858, -0.17375067150110607, -0.1341618275234655, -0.017006881373611116, 0.11139449490111111, 0.20040591850153405, 0.27080860576896915, 0.36180817493775597, 0.3571884754340758, 0.3873636835730671, 0.42118126943909884, 0.4458159832932146, 0.47762052857005555, 0.462741584146367, 0.3701932673170936, 0.2421223557891588, 0.136439820115198, 0.1027002431889326, -0.005743031255305522, -0.04169119919779281, -0.02125618516468586, 0.04912408412631583, -0.025216861731205395, -0.02339929583657722, -0.02194524312087468, -0.02078200094831265, 0.0011163347252208487, 0.0016995193930799048, -0.0067049006145683335, -0.028751017265848215, -0.055258878328807604, -0.10791678008240092, -0.1782689079368885, -0.22003448118822047, -0.2050598430150925, -0.1946930357023966]}, "chart3": {"abvEMA": [422, 416, 377, 410, 421, 408, 366, 345, 366, 339, 339, 344, 321, 287, 186, 215, 340, 354, 293, 355, 348, 263, 331, 332, 269, 359, 425, 404, 409, 397, 408, 345, 409, 257, 273, 342, 354, 353, 306, 317, 336, 289, 256, 242, 134, 168, 184, 100, 167, 220, 300, 280, 160, 179, 186, 68, 84, 45, 94, 100, 41, 50, 41, 67, 142, 193, 245, 167, 343, 286, 254, 360, 403, 386, 385, 428, 332, 374, 386, 383, 398, 348, 248, 181, 177, 240, 139, 202, 263, 330, 168, 244, 244, 244, 270, 249, 238, 219, 208, 169, 134, 152, 212, 210], "belEMA": [41, 47, 87, 55, 44, 57, 100, 121, 100, 128, 128, 123, 146, 181, 282, 253, 130, 116, 178, 117, 124, 209, 144, 144, 207, 117, 51, 72, 67, 79, 69, 132, 68, 221, 207, 138, 126, 128, 176, 166, 147, 194, 227, 241, 350, 317, 302, 390, 323, 271, 191, 211, 335, 316, 309, 427, 411, 450, 401, 395, 454, 446, 455, 429, 354, 303, 251, 329, 153, 210, 242, 136, 93, 110, 111, 68, 164, 122, 110, 113, 98, 148, 248, 315, 319, 256, 357, 294, 233, 166, 328, 252, 252, 252, 226, 247, 258, 277, 288, 327, 362, 344, 284, 286], "e9AbvEMA": [422.0, 420.8, 412.0400000000001, 411.63200000000006, 413.5056000000001, 412.4044800000001, 403.1235840000001, 391.4988672000001, 386.3990937600001, 376.9192750080001, 369.3354200064001, 364.2683360051201, 355.6146688040961, 341.89173504327687, 310.7133880346215, 291.57071042769724, 301.25656834215783, 311.80525467372627, 308.044203738981, 317.43536299118483, 323.5482903929479, 311.43863231435836, 315.3509058514867, 318.68072468118936, 308.7445797449515, 318.7956637959612, 340.036531036769, 352.82922482941524, 364.0633798635322, 370.65070389082575, 378.12056311266065, 371.49645049012855, 378.99716039210284, 354.5977283136823, 338.2781826509459, 339.0225461207567, 342.0180368966054, 344.2144295172844, 336.5715436138275, 332.657234891062, 333.3257879128496, 324.4606303302797, 310.76850426422374, 297.01480341137903, 264.4118427291032, 245.12947418328258, 232.9035793466261, 206.32286347730087, 198.4582907818407, 202.76663262547257, 222.21330610037808, 233.77064488030248, 219.016515904242, 211.01321272339362, 206.0105701787149, 178.40845614297191, 159.52676491437754, 136.62141193150205, 128.09712954520165, 122.47770363616132, 106.18216290892907, 94.94573032714327, 84.15658426171461, 80.7252674093717, 92.98021392749736, 112.9841711419979, 139.38733691359835, 144.9098695308787, 184.52789562470298, 204.8223164997624, 214.65785319980995, 243.72628255984796, 275.58102604787837, 297.6648208383027, 315.13185667064215, 337.70548533651373, 336.564388269211, 344.05151061536884, 352.44120849229506, 358.5529667938361, 366.44237343506893, 362.7538987480552, 339.8031189984442, 308.0424951987553, 281.83399615900424, 273.4671969272034, 246.57375754176275, 237.6590060334102, 242.72720482672818, 260.1817638613826, 241.74541108910609, 242.1963288712849, 242.55706309702794, 242.84565047762237, 248.2765203820979, 248.42121630567834, 246.33697304454267, 240.86957843563417, 234.29566274850734, 221.2365301988059, 203.78922415904475, 193.43137932723582, 197.14510346178866, 199.71608276943095], "netStocks": [463, 463, 464, 465, 465, 465, 466, 466, 466, 467, 467, 467, 467, 468, 468, 468, 470, 470, 471, 472, 472, 472, 475, 476, 476, 476, 476, 476, 476, 476, 477, 477, 477, 478, 480, 480, 480, 481, 482, 483, 483, 483, 483, 483, 484, 485, 486, 490, 490, 491, 491, 491, 495, 495, 495, 495, 495, 495, 495, 495, 495, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496]}};
    </script>
    <script>
        
        (function() {
            const chartInstances = {};
            let isSyncing = false;

            document.querySelectorAll('.reset-zoom-btn').forEach(button => {
                button.addEventListener('click', (e) => {
                    const chartId = e.target.getAttribute('data-chart-id');
                    if (chartInstances[chartId]) {
                        chartInstances[chartId].resetZoom();
                    }
                });
            });

            function syncCharts(sourceChart) {
                if (isSyncing) return;
                isSyncing = true;
                const { min, max } = sourceChart.scales.x;
                for (const chartId in chartInstances) {
                    const targetChart = chartInstances[chartId];
                    if (targetChart.canvas.id !== sourceChart.canvas.id) {
                        targetChart.options.scales.x.min = min;
                        targetChart.options.scales.x.max = max;
                        targetChart.update('none');
                    }
                }
                isSyncing = false;
            }

            function createCharts(data) {
                const computedStyles = getComputedStyle(document.body);
                const colors = {
                    green: computedStyles.getPropertyValue('--green').trim(), red: computedStyles.getPropertyValue('--red').trim(),
                    blue: computedStyles.getPropertyValue('--blue').trim(), cyan: computedStyles.getPropertyValue('--cyan').trim(),
                    yellow: computedStyles.getPropertyValue('--yellow').trim(), magenta: computedStyles.getPropertyValue('--magenta').trim(),
                    text: computedStyles.getPropertyValue('--text-color').trim(), grid: computedStyles.getPropertyValue('--border-color').trim() + '80',
                };
                const commonOptions = {
                    responsive: true, maintainAspectRatio: false,
                    scales: {
                        x: { grid: { color: colors.grid }, ticks: { color: colors.text, maxRotation: 0, autoSkip: true, maxTicksLimit: 15 }, grace: '5%' },
                        y: { grid: { color: colors.grid }, ticks: { color: colors.text } }
                    },
                    plugins: {
                        legend: { labels: { color: colors.text, font: { size: 14 } } },
                        tooltip: {
                            backgroundColor: computedStyles.getPropertyValue('--card-bg-color').trim(),
                            titleFont: { size: 16 }, bodyFont: { size: 14 }, padding: 10,
                            borderColor: colors.grid, borderWidth: 1, titleColor: colors.text, bodyColor: colors.text,
                        },
                        zoom: {
                            pan: { enabled: true, mode: 'x', onPanComplete: ({ chart }) => syncCharts(chart) },
                            zoom: {
                                drag: { enabled: false },
                                wheel: { enabled: true }, 
                                pinch: { enabled: true },
                                mode: 'x',
                                onZoomComplete: ({ chart }) => syncCharts(chart)
                            }
                        }
                    },
                    elements: { point: { radius: 0 } },
                    interaction: { intersect: false, mode: 'index' }
                };
                const chartHeight = 450;
                document.querySelectorAll('.chart-card canvas').forEach(c => c.parentElement.style.height = chartHeight + 'px');
                
                chartInstances.chart1 = new Chart(document.getElementById('chart1'), { type: 'line', data: { labels: data.labels, datasets: [{ label: 'Trend Of Stks', data: data.chart1.trendOfStocks, borderColor: colors.magenta, borderWidth: 2, tension: 0.1 }, { label: 'e9 (EMA)', data: data.chart1.e9_trendOfStocks, borderColor: colors.blue, borderWidth: 2, tension: 0.1 }] }, options: commonOptions });
                chartInstances.chart2 = new Chart(document.getElementById('chart2'), { type: 'line', data: { labels: data.labels, datasets: [{ label: 'Proportion', data: data.chart2.proportion, borderColor: colors.yellow, borderWidth: 2, tension: 0.1 }, { label: 'e9 (EMA)', data: data.chart2.e9_proportion, borderColor: colors.blue, borderWidth: 2, tension: 0.1 }] }, options: commonOptions });
                chartInstances.chart3 = new Chart(document.getElementById('chart3'), { type: 'line', data: { labels: data.labels, datasets: [{ label: 'Stocks Above EMA', data: data.chart3.abvEMA, borderColor: colors.green, borderWidth: 2, tension: 0.1 }, { label: 'Stocks Below EMA', data: data.chart3.belEMA, borderColor: colors.red, borderWidth: 2, tension: 0.1 }, { label: 'Net Stocks', data: data.chart3.netStocks, borderColor: colors.text, borderWidth: 1, tension: 0.1, borderDash: [5, 5] }] }, options: commonOptions });
            }
            createCharts(window.chartData);
        })();
    
    </script>
</body>
</html>