<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nifty 500 - Broad Market Monitor</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/hammer.js/2.0.8/hammer.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-zoom@2.0.1/dist/chartjs-plugin-zoom.min.js"></script>
    <style>
        :root { --bg-color: #1a1b26; --card-bg-color: #24283b; --text-color: #c0caf5; --text-secondary-color: #a9b1d6; --border-color: #414868; --primary-color: #7aa2f7; --green: #9ece6a; --red: #f7768e; --blue: #7aa2f7; --cyan: #7dcfff; --yellow: #e0af68; --magenta: #bb9af7; }
        body[data-theme="bloomberg"] { --bg-color: #0d0d0d; --card-bg-color: #1a1a1a; --text-color: #e0e0e0; --text-secondary-color: #a0a0a0; --border-color: #333333; --primary-color: #ff9900; --green: #00e676; --red: #ff5252; --blue: #2979ff; --cyan: #00e5ff; --yellow: #ffd600; --magenta: #d500f9; }
        body[data-theme="light"] { --bg-color: #f5f7fa; --card-bg-color: #ffffff; --text-color: #1c2a42; --text-secondary-color: #5b6b85; --border-color: #e6e9f0; --primary-color: #0052cc; --green: #00875a; --red: #bf2600; --blue: #0052cc; --cyan: #00a3bf; --yellow: #ffab00; --magenta: #6554c0; }
        body { font-family: 'Segoe UI', 'Roboto', 'Helvetica', sans-serif; background-color: var(--bg-color); color: var(--text-color); margin: 0; padding: 10px; }
        .container { max-width: 1600px; margin: auto; }
        header { text-align: center; margin-bottom: 25px; border-bottom: 1px solid var(--border-color); padding-bottom: 20px; }
        h1 { font-size: 1.5rem; color: var(--text-color); margin: 0 0 5px 0; }
        h2 { margin: 0; color: var(--text-secondary-color); font-weight: 500; font-size: 1rem; }
        .card { background-color: var(--card-bg-color); border: 1px solid var(--border-color); border-radius: 8px; padding: 20px; margin-bottom: 20px; }
        .chart-header { display: flex; flex-direction: column; align-items: flex-start; gap: 10px; border-bottom: 1px solid var(--border-color); padding-bottom: 15px; margin-bottom: 15px; }
        .chart-title { font-size: 1.1rem; color: var(--text-secondary-color); font-weight: 500; }
        .zoom-hint { font-size: 0.8rem; font-style: italic; color: #6c707a; }
        .reset-zoom-btn { background: none; border: 1px solid var(--border-color); color: var(--text-secondary-color); padding: 5px 10px; border-radius: 4px; cursor: pointer; }
        @media (min-width: 600px) { 
            h1 {font-size: 1.8rem;} h2 {font-size: 1.2rem;}
            .chart-header { flex-direction: row; justify-content: space-between; align-items: center;}
        }
    </style>
</head>
<body data-theme="bloomberg">
    <div class="container">
        <header>
            <h1>Nifty 500</h1>
            <h2>Timeframe: Weekly | Lookback: 104 Periods</h2>
        </header>
        <div id="charts">
            <div class="card chart-card"><div class="chart-header"><span class="chart-title">Market Trend (Sum)</span><div><span class="zoom-hint">Scroll/Drag to Zoom</span> <button class="reset-zoom-btn" data-chart-id="chart1">Reset</button></div></div><canvas id="chart1"></canvas></div>
            <div class="card chart-card"><div class="chart-header"><span class="chart-title">Market Proportion</span><div><span class="zoom-hint">Scroll/Drag to Zoom</span> <button class="reset-zoom-btn" data-chart-id="chart2">Reset</button></div></div><canvas id="chart2"></canvas></div>
            <div class="card chart-card"><div class="chart-header"><span class="chart-title">Market Breadth</span><div><span class="zoom-hint">Scroll/Drag to Zoom</span> <button class="reset-zoom-btn" data-chart-id="chart3">Reset</button></div></div><canvas id="chart3"></canvas></div>
        </div>
    </div>
    <script>
        window.chartData = {"labels": ["2023-10-06", "2023-10-13", "2023-10-20", "2023-10-30", "2023-11-06", "2023-11-12", "2023-11-20", "2023-11-28", "2023-12-05", "2023-12-12", "2023-12-19", "2023-12-27", "2024-01-03", "2024-01-10", "2024-01-17", "2024-01-24", "2024-02-01", "2024-02-08", "2024-02-15", "2024-02-22", "2024-02-29", "2024-03-06", "2024-03-14", "2024-03-21", "2024-04-01", "2024-04-08", "2024-04-16", "2024-04-24", "2024-05-02", "2024-05-09", "2024-05-16", "2024-05-23", "2024-05-30", "2024-06-06", "2024-06-13", "2024-06-21", "2024-06-28", "2024-07-05", "2024-07-12", "2024-07-22", "2024-07-29", "2024-08-05", "2024-08-12", "2024-08-20", "2024-08-27", "2024-09-03", "2024-09-10", "2024-09-17", "2024-09-24", "2024-10-01", "2024-10-09", "2024-10-16", "2024-10-23", "2024-10-30", "2024-11-06", "2024-11-13", "2024-11-22", "2024-11-29", "2024-12-06", "2024-12-13", "2024-12-20", "2024-12-30", "2025-01-06", "2025-01-13", "2025-01-20", "2025-01-27", "2025-02-01", "2025-02-07", "2025-02-14", "2025-02-21", "2025-03-03", "2025-03-10", "2025-03-18", "2025-03-25", "2025-04-02", "2025-04-09", "2025-04-21", "2025-04-28", "2025-05-06", "2025-05-13", "2025-05-20", "2025-05-27", "2025-06-03", "2025-06-10", "2025-06-17", "2025-06-24", "2025-07-01", "2025-07-08", "2025-07-15", "2025-07-22", "2025-07-29", "2025-08-05", "2025-08-12", "2025-08-20", "2025-08-28", "2025-09-04", "2025-09-11", "2025-09-18", "2025-09-25", "2025-10-03", "2025-10-10", "2025-10-17", "2025-10-27", "2025-11-03"], "chart1": {"trendOfStocks": [258, 239, 165, -27, 112, 171, 199, 247, 355, 349, 373, 329, 351, 319, 274, 222, 262, 215, 189, 197, 143, 106, -100, -38, 176, 262, 131, 210, 252, 28, 151, 196, 52, 128, 368, 348, 310, 354, 321, 249, 323, 61, 131, 156, 212, 205, 162, 173, 161, 149, -17, 23, -242, -205, -102, -329, -252, -89, 73, 55, -171, -161, -181, -377, -257, -407, -277, -225, -435, -381, -430, -380, -304, -86, -70, -256, 150, 108, -68, 162, 270, 284, 250, 360, 200, 174, 280, 272, 258, 204, -2, -110, -166, -26, -220, -102, 14, 142, -50, -68, -26, -64, 26, 28], "e9_trendOfStocks": [258.0, 254.20000000000002, 236.36, 183.68800000000002, 169.35040000000004, 169.68032000000005, 175.54425600000005, 189.83540480000005, 222.86832384000004, 248.09465907200007, 273.0757272576001, 284.2605818060801, 297.60846544486407, 301.88677235589125, 296.309417884713, 281.4475343077704, 277.55802744621633, 265.04642195697306, 249.83713756557847, 239.26971005246278, 220.01576804197023, 197.21261443357622, 137.77009154686098, 102.61607323748879, 117.29285858999104, 146.23428687199285, 143.18742949759428, 156.54994359807543, 175.63995487846034, 146.11196390276828, 147.08957112221464, 156.87165689777171, 135.89732551821737, 134.31786041457391, 181.05428833165917, 214.44343066532736, 233.5547445322619, 257.64379562580956, 270.31503650064764, 266.0520292005181, 277.4416233604145, 234.1532986883316, 213.52263895066528, 202.01811116053221, 204.01448892842578, 204.21159114274064, 195.76927291419253, 191.21541833135402, 185.1723346650832, 177.9378677320666, 138.95029418565326, 115.76023534852261, 44.208188278818085, -5.633449376945528, -24.906759501556426, -85.72540760124514, -118.98032608099612, -112.9842608647969, -75.78740869183753, -49.629926953470026, -73.90394156277603, -91.32315325022083, -109.25852260017666, -162.80681808014134, -181.64545446411307, -226.71636357129046, -236.77309085703237, -234.41847268562591, -274.5347781485008, -295.82782251880064, -322.6622580150405, -334.1298064120324, -328.10384512962594, -279.6830761037007, -237.7464608829606, -241.39716870636852, -163.11773496509483, -108.89418797207588, -100.71535037766071, -48.17228030212858, 15.462175758297136, 69.16974060663772, 105.33579248531018, 156.26863398824815, 165.01490719059854, 166.81192575247886, 189.4495406019831, 205.95963248158648, 216.3677059852692, 213.8941647882154, 170.71533183057232, 114.57226546445787, 58.457812371566305, 41.566249897253044, -10.747000082197566, -28.997600065758057, -20.398080052606446, 12.081535957914845, -0.334771233668123, -13.8678169869345, -16.2942535895476, -25.83540287163808, -15.468322297310468, -6.774657837848374]}, "chart2": {"proportion": [0.5633187772925764, 0.5206971677559913, 0.35947712418300654, -0.058823529411764705, 0.24347826086956523, 0.37093275488069416, 0.4316702819956616, 0.5357917570498916, 0.7667386609071274, 0.7537796976241901, 0.8056155507559395, 0.7075268817204301, 0.7548387096774194, 0.6860215053763441, 0.5879828326180258, 0.47639484978540775, 0.5622317596566524, 0.4603854389721627, 0.40471092077087795, 0.42184154175588867, 0.30620985010706636, 0.2264957264957265, -0.21367521367521367, -0.0811965811965812, 0.37446808510638296, 0.5574468085106383, 0.2781316348195329, 0.4449152542372881, 0.5338983050847458, 0.059322033898305086, 0.3178947368421053, 0.4117647058823529, 0.1092436974789916, 0.2689075630252101, 0.773109243697479, 0.7310924369747899, 0.6512605042016807, 0.7436974789915967, 0.6729559748427673, 0.5220125786163522, 0.6771488469601677, 0.1278825995807128, 0.27348643006263046, 0.325, 0.44166666666666665, 0.4261954261954262, 0.3360995850622407, 0.3581780538302277, 0.3333333333333333, 0.3084886128364389, -0.035196687370600416, 0.047619047619047616, -0.5, -0.422680412371134, -0.20987654320987653, -0.6728016359918201, -0.5142857142857142, -0.18126272912423624, 0.14867617107942974, 0.1120162932790224, -0.34545454545454546, -0.32525252525252524, -0.3656565656565657, -0.7616161616161616, -0.5191919191919192, -0.8222222222222222, -0.5595959595959596, -0.45454545454545453, -0.8787878787878788, -0.7696969696969697, -0.8669354838709677, -0.7661290322580645, -0.6129032258064516, -0.17338709677419356, -0.14112903225806453, -0.5161290322580645, 0.3024193548387097, 0.21774193548387097, -0.13709677419354838, 0.32661290322580644, 0.5443548387096774, 0.5725806451612904, 0.5040322580645161, 0.7258064516129032, 0.4032258064516129, 0.35080645161290325, 0.5645161290322581, 0.5483870967741935, 0.5201612903225806, 0.4112903225806452, -0.004032258064516129, -0.2217741935483871, -0.3346774193548387, -0.05241935483870968, -0.4435483870967742, -0.2056451612903226, 0.028225806451612902, 0.2862903225806452, -0.10080645161290322, -0.13709677419354838, -0.05241935483870968, -0.12903225806451613, 0.05241935483870968, 0.056451612903225805], "e9_proportion": [0.5633187772925764, 0.5547944553852594, 0.5157309891448089, 0.4008200854334942, 0.3693517205207084, 0.3696679273927056, 0.3820683983132968, 0.4128130700606158, 0.4835981882299182, 0.5376344901087726, 0.591230702238206, 0.6144899381346508, 0.6425596924432045, 0.6512520550298325, 0.6385982105474712, 0.6061575383950585, 0.5973723826473772, 0.5699749939123344, 0.5369221792840431, 0.5139060517784122, 0.47236681144414305, 0.4231925944544598, 0.2958190328285251, 0.22041591002350386, 0.2512263450400797, 0.3124704377341914, 0.3056026771512597, 0.3334651925684654, 0.3735518150717215, 0.3107058588370382, 0.31214363443805165, 0.3320678487269119, 0.28750301847732784, 0.2837839273869043, 0.38164899064901925, 0.4515376799141734, 0.4914822447716749, 0.5419252916156593, 0.5681314282610809, 0.5589076583321352, 0.5825558960577417, 0.491621236762336, 0.4479942754223949, 0.42339542033791594, 0.4270496696036661, 0.4268788209220181, 0.4087229737500626, 0.39861398976609563, 0.38555785847954316, 0.37014400935092234, 0.28907587000661783, 0.2407845055291038, 0.09262760442328305, -0.010433998935600361, -0.0503225077904556, -0.1748183334307285, -0.24271180960172567, -0.2304219935062278, -0.1546023605890963, -0.10127862981547256, -0.15011381294328713, -0.18514155540513477, -0.221244557455421, -0.3293188782875691, -0.3672934864684391, -0.45827923361919576, -0.47854257881454854, -0.47374315396072975, -0.5547520989261596, -0.5977410730803216, -0.6515799552384509, -0.6744897706423736, -0.6621724616751892, -0.5644153886949901, -0.479758117407605, -0.4870323003776969, -0.3291419693344156, -0.21976518837075829, -0.20323150553531633, -0.09726262378309179, 0.031060868715462042, 0.1393648240046277, 0.2122983108166054, 0.314999938975865, 0.3326451124710146, 0.33627738029939236, 0.3819251300459655, 0.41521752339161117, 0.4362062767778051, 0.43122308593837316, 0.3441720171377953, 0.23098277500055886, 0.11785073612947934, 0.08379671793584155, -0.021672303070681603, -0.058466874714609804, -0.04112833848136527, 0.024355393731036824, -0.0006769753377511845, -0.027960935108910626, -0.03285261905487044, -0.052088546856799575, -0.03118696651769773, -0.013659250633513021]}, "chart3": {"abvEMA": [358, 349, 312, 216, 286, 316, 330, 354, 409, 406, 418, 397, 408, 392, 370, 344, 364, 341, 328, 332, 305, 287, 184, 215, 323, 366, 301, 341, 362, 250, 313, 336, 264, 302, 422, 412, 393, 415, 399, 363, 400, 269, 305, 318, 346, 343, 322, 328, 322, 316, 233, 253, 121, 140, 192, 80, 119, 201, 282, 273, 162, 167, 157, 59, 119, 44, 109, 135, 30, 57, 33, 58, 96, 205, 213, 120, 323, 302, 214, 329, 383, 390, 373, 428, 348, 335, 388, 384, 377, 350, 247, 193, 165, 235, 138, 197, 255, 319, 223, 214, 235, 216, 261, 262], "belEMA": [100, 110, 147, 243, 174, 145, 131, 107, 54, 57, 45, 68, 57, 73, 96, 122, 102, 126, 139, 135, 162, 181, 284, 253, 147, 104, 170, 131, 110, 222, 162, 140, 212, 174, 54, 64, 83, 61, 78, 114, 77, 208, 174, 162, 134, 138, 160, 155, 161, 167, 250, 230, 363, 345, 294, 409, 371, 290, 209, 218, 333, 328, 338, 436, 376, 451, 386, 360, 465, 438, 463, 438, 400, 291, 283, 376, 173, 194, 282, 167, 113, 106, 123, 68, 148, 161, 108, 112, 119, 146, 249, 303, 331, 261, 358, 299, 241, 177, 273, 282, 261, 280, 235, 234], "e9AbvEMA": [358.0, 356.20000000000005, 347.36, 321.088, 314.0704, 314.45632, 317.565056, 324.85204480000004, 341.68163584000007, 354.54530867200003, 367.2362469376001, 373.1889975500801, 380.1511980400641, 382.5209584320513, 380.01676674564106, 372.8134133965129, 371.05073071721034, 365.0405845737683, 357.63246765901465, 352.50597412721174, 343.0047793017694, 331.8038234414156, 302.2430587531325, 284.794447002506, 292.4355576020048, 307.1484460816038, 305.91875686528306, 312.9350054922265, 322.74800439378123, 308.198403515025, 309.15872281202, 314.52697824961604, 304.42158259969284, 303.9372660797543, 327.5498128638035, 344.43985029104283, 354.1518802328343, 366.3215041862674, 372.85720334901396, 370.8857626792112, 376.70861014336896, 355.1668881146952, 345.13351049175617, 339.70680839340497, 340.96544671472395, 341.3723573717792, 337.4978858974233, 335.59830871793866, 332.878646974351, 329.5029175794808, 310.2023340635847, 298.7618672508678, 263.20949380069425, 238.5675950405554, 229.25407603244435, 199.4032608259555, 183.32260866076442, 186.85808692861156, 205.88646954288924, 219.3091756343114, 207.84734050744913, 199.67787240595933, 191.1422979247675, 164.713838339814, 155.57107067185123, 133.25685653748099, 128.4054852299848, 129.72438818398786, 109.77951054719028, 99.22360843775223, 85.97888675020178, 80.38310940016143, 83.50648752012916, 107.80519001610332, 128.84415201288266, 127.07532161030613, 166.26025728824493, 193.40820583059596, 197.52656466447678, 223.8212517315814, 255.65700138526518, 282.5256011082122, 300.6204808865698, 326.09638470925586, 330.47710776740473, 331.3816862139238, 342.7053489711391, 350.9642791769113, 356.171423341529, 354.9371386732232, 333.3497109385786, 305.2797687508629, 277.22381500069037, 268.77905200055227, 242.62324160044182, 233.49859328035348, 237.7988746242828, 254.03909969942626, 247.83127975954102, 241.06502380763283, 239.85201904610628, 235.08161523688506, 240.26529218950805, 244.61223375160645], "netStocks": [458, 459, 459, 459, 460, 461, 461, 461, 463, 463, 463, 465, 465, 465, 466, 466, 466, 467, 467, 467, 467, 468, 468, 468, 470, 470, 471, 472, 472, 472, 475, 476, 476, 476, 476, 476, 476, 476, 477, 477, 477, 477, 479, 480, 480, 481, 482, 483, 483, 483, 483, 483, 484, 485, 486, 489, 490, 491, 491, 491, 495, 495, 495, 495, 495, 495, 495, 495, 495, 495, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496]}};
    </script>
    <script>
        
        (function() {
            const chartInstances = {};
            let isSyncing = false;

            document.querySelectorAll('.reset-zoom-btn').forEach(button => {
                button.addEventListener('click', (e) => {
                    const chartId = e.target.getAttribute('data-chart-id');
                    if (chartInstances[chartId]) {
                        chartInstances[chartId].resetZoom();
                    }
                });
            });

            function syncCharts(sourceChart) {
                if (isSyncing) return;
                isSyncing = true;
                const { min, max } = sourceChart.scales.x;
                for (const chartId in chartInstances) {
                    const targetChart = chartInstances[chartId];
                    if (targetChart.canvas.id !== sourceChart.canvas.id) {
                        targetChart.options.scales.x.min = min;
                        targetChart.options.scales.x.max = max;
                        targetChart.update('none');
                    }
                }
                isSyncing = false;
            }

            function createCharts(data) {
                const computedStyles = getComputedStyle(document.body);
                const colors = {
                    green: computedStyles.getPropertyValue('--green').trim(), red: computedStyles.getPropertyValue('--red').trim(),
                    blue: computedStyles.getPropertyValue('--blue').trim(), cyan: computedStyles.getPropertyValue('--cyan').trim(),
                    yellow: computedStyles.getPropertyValue('--yellow').trim(), magenta: computedStyles.getPropertyValue('--magenta').trim(),
                    text: computedStyles.getPropertyValue('--text-color').trim(), grid: computedStyles.getPropertyValue('--border-color').trim() + '80',
                };
                const commonOptions = {
                    responsive: true, maintainAspectRatio: false,
                    scales: {
                        x: { grid: { color: colors.grid }, ticks: { color: colors.text, maxRotation: 0, autoSkip: true, maxTicksLimit: 15 }, grace: '5%' },
                        y: { grid: { color: colors.grid }, ticks: { color: colors.text } }
                    },
                    plugins: {
                        legend: { labels: { color: colors.text, font: { size: 14 } } },
                        tooltip: {
                            backgroundColor: computedStyles.getPropertyValue('--card-bg-color').trim(),
                            titleFont: { size: 16 }, bodyFont: { size: 14 }, padding: 10,
                            borderColor: colors.grid, borderWidth: 1, titleColor: colors.text, bodyColor: colors.text,
                        },
                        zoom: {
                            pan: { enabled: true, mode: 'x', onPanComplete: ({ chart }) => syncCharts(chart) },
                            zoom: {
                                drag: { enabled: false },
                                wheel: { enabled: true }, 
                                pinch: { enabled: true },
                                mode: 'x',
                                onZoomComplete: ({ chart }) => syncCharts(chart)
                            }
                        }
                    },
                    elements: { point: { radius: 0 } },
                    interaction: { intersect: false, mode: 'index' }
                };
                const chartHeight = 450;
                document.querySelectorAll('.chart-card canvas').forEach(c => c.parentElement.style.height = chartHeight + 'px');
                
                chartInstances.chart1 = new Chart(document.getElementById('chart1'), { type: 'line', data: { labels: data.labels, datasets: [{ label: 'Trend Of Stks', data: data.chart1.trendOfStocks, borderColor: colors.magenta, borderWidth: 2, tension: 0.1 }, { label: 'e9 (EMA)', data: data.chart1.e9_trendOfStocks, borderColor: colors.blue, borderWidth: 2, tension: 0.1 }] }, options: commonOptions });
                chartInstances.chart2 = new Chart(document.getElementById('chart2'), { type: 'line', data: { labels: data.labels, datasets: [{ label: 'Proportion', data: data.chart2.proportion, borderColor: colors.yellow, borderWidth: 2, tension: 0.1 }, { label: 'e9 (EMA)', data: data.chart2.e9_proportion, borderColor: colors.blue, borderWidth: 2, tension: 0.1 }] }, options: commonOptions });
                chartInstances.chart3 = new Chart(document.getElementById('chart3'), { type: 'line', data: { labels: data.labels, datasets: [{ label: 'Stocks Above EMA', data: data.chart3.abvEMA, borderColor: colors.green, borderWidth: 2, tension: 0.1 }, { label: 'Stocks Below EMA', data: data.chart3.belEMA, borderColor: colors.red, borderWidth: 2, tension: 0.1 }, { label: 'Net Stocks', data: data.chart3.netStocks, borderColor: colors.text, borderWidth: 1, tension: 0.1, borderDash: [5, 5] }] }, options: commonOptions });
            }
            createCharts(window.chartData);
        })();
    
    </script>
</body>
</html>