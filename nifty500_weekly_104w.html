<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nifty 500 - Broad Market Monitor</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/hammer.js/2.0.8/hammer.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-zoom@2.0.1/dist/chartjs-plugin-zoom.min.js"></script>
    <style>
        :root { --bg-color: #1a1b26; --card-bg-color: #24283b; --text-color: #c0caf5; --text-secondary-color: #a9b1d6; --border-color: #414868; --primary-color: #7aa2f7; --green: #9ece6a; --red: #f7768e; --blue: #7aa2f7; --cyan: #7dcfff; --yellow: #e0af68; --magenta: #bb9af7; }
        body[data-theme="bloomberg"] { --bg-color: #0d0d0d; --card-bg-color: #1a1a1a; --text-color: #e0e0e0; --text-secondary-color: #a0a0a0; --border-color: #333333; --primary-color: #ff9900; --green: #00e676; --red: #ff5252; --blue: #2979ff; --cyan: #00e5ff; --yellow: #ffd600; --magenta: #d500f9; }
        body[data-theme="light"] { --bg-color: #f5f7fa; --card-bg-color: #ffffff; --text-color: #1c2a42; --text-secondary-color: #5b6b85; --border-color: #e6e9f0; --primary-color: #0052cc; --green: #00875a; --red: #bf2600; --blue: #0052cc; --cyan: #00a3bf; --yellow: #ffab00; --magenta: #6554c0; }
        body { font-family: 'Segoe UI', 'Roboto', 'Helvetica', sans-serif; background-color: var(--bg-color); color: var(--text-color); margin: 0; padding: 10px; }
        .container { max-width: 1600px; margin: auto; }
        header { text-align: center; margin-bottom: 25px; border-bottom: 1px solid var(--border-color); padding-bottom: 20px; }
        h1 { font-size: 1.5rem; color: var(--text-color); margin: 0 0 5px 0; }
        h2 { margin: 0; color: var(--text-secondary-color); font-weight: 500; font-size: 1rem; }
        .card { background-color: var(--card-bg-color); border: 1px solid var(--border-color); border-radius: 8px; padding: 20px; margin-bottom: 20px; }
        .chart-header { display: flex; flex-direction: column; align-items: flex-start; gap: 10px; border-bottom: 1px solid var(--border-color); padding-bottom: 15px; margin-bottom: 15px; }
        .chart-title { font-size: 1.1rem; color: var(--text-secondary-color); font-weight: 500; }
        .zoom-hint { font-size: 0.8rem; font-style: italic; color: #6c707a; }
        .reset-zoom-btn { background: none; border: 1px solid var(--border-color); color: var(--text-secondary-color); padding: 5px 10px; border-radius: 4px; cursor: pointer; }
        @media (min-width: 600px) { 
            h1 {font-size: 1.8rem;} h2 {font-size: 1.2rem;}
            .chart-header { flex-direction: row; justify-content: space-between; align-items: center;}
        }
    </style>
</head>
<body data-theme="bloomberg">
    <div class="container">
        <header>
            <h1>Nifty 500</h1>
            <h2>Timeframe: Weekly | Lookback: 104 Periods</h2>
        </header>
        <div id="charts">
            <div class="card chart-card"><div class="chart-header"><span class="chart-title">Market Trend (Sum)</span><div><span class="zoom-hint">Scroll/Drag to Zoom</span> <button class="reset-zoom-btn" data-chart-id="chart1">Reset</button></div></div><canvas id="chart1"></canvas></div>
            <div class="card chart-card"><div class="chart-header"><span class="chart-title">Market Proportion</span><div><span class="zoom-hint">Scroll/Drag to Zoom</span> <button class="reset-zoom-btn" data-chart-id="chart2">Reset</button></div></div><canvas id="chart2"></canvas></div>
            <div class="card chart-card"><div class="chart-header"><span class="chart-title">Market Breadth</span><div><span class="zoom-hint">Scroll/Drag to Zoom</span> <button class="reset-zoom-btn" data-chart-id="chart3">Reset</button></div></div><canvas id="chart3"></canvas></div>
        </div>
    </div>
    <script>
        window.chartData = {"labels": ["2023-11-10", "2023-11-17", "2023-11-24", "2023-12-04", "2023-12-11", "2023-12-18", "2023-12-26", "2024-01-02", "2024-01-09", "2024-01-16", "2024-01-23", "2024-01-31", "2024-02-07", "2024-02-14", "2024-02-21", "2024-02-28", "2024-03-05", "2024-03-13", "2024-03-20", "2024-03-28", "2024-04-05", "2024-04-15", "2024-04-23", "2024-04-30", "2024-05-08", "2024-05-15", "2024-05-22", "2024-05-29", "2024-06-05", "2024-06-12", "2024-06-20", "2024-06-27", "2024-07-04", "2024-07-11", "2024-07-19", "2024-07-26", "2024-08-02", "2024-08-09", "2024-08-19", "2024-08-26", "2024-09-02", "2024-09-09", "2024-09-16", "2024-09-23", "2024-09-30", "2024-10-08", "2024-10-15", "2024-10-22", "2024-10-29", "2024-11-05", "2024-11-12", "2024-11-21", "2024-11-28", "2024-12-05", "2024-12-12", "2024-12-19", "2024-12-27", "2025-01-03", "2025-01-10", "2025-01-17", "2025-01-24", "2025-01-31", "2025-02-06", "2025-02-13", "2025-02-20", "2025-02-28", "2025-03-07", "2025-03-17", "2025-03-24", "2025-04-01", "2025-04-08", "2025-04-17", "2025-04-25", "2025-05-05", "2025-05-12", "2025-05-19", "2025-05-26", "2025-06-02", "2025-06-09", "2025-06-16", "2025-06-23", "2025-06-30", "2025-07-07", "2025-07-14", "2025-07-21", "2025-07-28", "2025-08-04", "2025-08-11", "2025-08-19", "2025-08-26", "2025-09-03", "2025-09-10", "2025-09-17", "2025-09-24", "2025-10-01", "2025-10-09", "2025-10-16", "2025-10-24", "2025-10-31", "2025-11-10", "2025-11-17", "2025-11-24", "2025-12-01", "2025-12-08"], "chart1": {"trendOfStocks": [132, 222, 232, 366, 364, 378, 324, 352, 332, 337, 179, 275, 248, 164, 194, 122, 171, -189, -109, 107, 279, 184, 211, 283, 155, 132, 204, 145, 11, 363, 377, 305, 351, 330, 224, 312, 290, 126, 141, 207, 203, 129, 222, 182, 160, -26, 46, -219, -218, -149, -200, -281, -108, 84, 98, -65, -138, -64, -288, -304, -354, -322, -258, -392, -390, -435, -375, -365, -37, -131, -233, 43, 63, 65, 133, 347, 297, 265, 337, 259, 121, 311, 263, 209, 239, -39, -79, -157, -27, -133, -63, -1, 141, 3, -113, -45, -3, 9, 3, -67, -1, -153, -97, -211], "e9_trendOfStocks": [132.0, 150.0, 166.4, 206.32, 237.856, 265.88480000000004, 277.50784000000004, 292.40627200000006, 300.3250176, 307.66001408, 281.928011264, 280.5424090112, 274.03392720896, 252.02714176716802, 240.42171341373444, 216.73737073098758, 207.5898965847901, 128.27191726783207, 80.81753381426566, 86.05402705141253, 124.64322164113003, 136.51457731290404, 151.41166185032324, 177.7293294802586, 173.1834635842069, 164.94677086736553, 172.75741669389245, 167.20593335511396, 135.96474668409115, 181.37179734727295, 220.49743787781836, 237.39795030225469, 260.11836024180377, 274.09468819344306, 264.07575055475445, 273.66060044380356, 276.9284803550429, 246.74278428403431, 225.59422742722745, 221.87538194178197, 218.10030555342559, 200.2802444427405, 204.62419555419243, 200.09935644335397, 192.0794851546832, 148.46358812374658, 127.97087049899727, 58.57669639919782, 3.2613571193582587, -27.19091430451339, -61.75273144361071, -105.60218515488857, -106.08174812391087, -68.0653984991287, -34.852318799302964, -40.88185503944237, -60.3054840315539, -61.04438722524313, -106.43550978019451, -145.94840782415562, -187.5587262593245, -214.4469810074596, -223.1575848059677, -256.92606784477414, -283.54085427581936, -313.8326834206555, -326.0661467365244, -333.8529173892195, -274.4823339113756, -245.7858671291005, -243.2286937032804, -185.98295496262435, -136.18636397009948, -95.94909117607959, -50.15927294086368, 29.27258164730906, 82.81806531784726, 119.25445225427781, 162.80356180342227, 182.04284944273783, 169.8342795541903, 198.06742364335224, 211.0539389146818, 210.64315113174547, 216.3145209053964, 165.2516167243171, 116.40129337945369, 61.72103470356295, 43.97682776285036, 8.581462210280293, -5.734830231775767, -4.787864185420614, 24.36970865166351, 20.095766921330814, -6.523386462935349, -14.21870917034828, -11.974967336278624, -7.779973869022899, -5.623979095218319, -17.899183276174654, -14.519346620939723, -42.21547729675178, -53.17238183740143, -84.73790546992115]}, "chart2": {"proportion": [0.28695652173913044, 0.4826086956521739, 0.5043478260869565, 0.7922077922077922, 0.7878787878787878, 0.8181818181818182, 0.6982758620689655, 0.7586206896551724, 0.7155172413793104, 0.7247311827956989, 0.3849462365591398, 0.5913978494623656, 0.5321888412017167, 0.351931330472103, 0.41630901287553645, 0.26180257510729615, 0.36616702355460384, -0.40471092077087795, -0.2334047109207709, 0.2291220556745182, 0.5948827292110874, 0.39148936170212767, 0.44798301486199577, 0.6008492569002123, 0.32908704883227174, 0.27848101265822783, 0.43037974683544306, 0.30526315789473685, 0.023157894736842106, 0.7642105263157895, 0.7936842105263158, 0.6421052631578947, 0.7389473684210527, 0.6932773109243697, 0.47058823529411764, 0.6554621848739496, 0.6092436974789915, 0.26359832635983266, 0.29436325678496866, 0.4321503131524008, 0.42379958246346555, 0.2681912681912682, 0.4605809128630705, 0.3775933609958506, 0.33195020746887965, -0.05394190871369295, 0.0954356846473029, -0.453416149068323, -0.45041322314049587, -0.30721649484536084, -0.411522633744856, -0.5746421267893661, -0.22040816326530613, 0.17142857142857143, 0.2, -0.13184584178498987, -0.2793522267206478, -0.12955465587044535, -0.582995951417004, -0.6153846153846154, -0.7165991902834008, -0.6518218623481782, -0.5222672064777328, -0.7935222672064778, -0.7894736842105263, -0.8787878787878788, -0.7575757575757576, -0.7373737373737373, -0.07474747474747474, -0.26464646464646463, -0.4707070707070707, 0.08686868686868687, 0.12727272727272726, 0.13131313131313133, 0.2686868686868687, 0.701010101010101, 0.6, 0.5353535353535354, 0.6808080808080809, 0.5232323232323233, 0.24444444444444444, 0.6282828282828283, 0.5313131313131313, 0.4222222222222222, 0.48282828282828283, -0.07878787878787878, -0.1595959595959596, -0.31717171717171716, -0.05454545454545454, -0.2686868686868687, -0.12727272727272726, -0.00202020202020202, 0.28484848484848485, 0.006060606060606061, -0.22828282828282828, -0.09090909090909091, -0.006060606060606061, 0.01818181818181818, 0.006060606060606061, -0.13535353535353536, -0.00202020202020202, -0.3090909090909091, -0.19595959595959597, -0.4262626262626263], "e9_proportion": [0.28695652173913044, 0.32608695652173914, 0.3617391304347826, 0.4478328627893846, 0.5158420478072653, 0.576310001882176, 0.6007031739195339, 0.6322866770666616, 0.6489327899291915, 0.6640924685024929, 0.6082632221138223, 0.604890147583531, 0.5903498863071681, 0.5426661751401551, 0.5173947426872314, 0.46627630917124435, 0.44625445204791625, 0.27606137748415743, 0.1741681598031718, 0.1851589389774411, 0.26710369702417036, 0.2919808299597618, 0.32318126694020866, 0.3787148649322094, 0.3687893017122219, 0.35072764390142314, 0.36665806448822713, 0.3543790831695291, 0.28813484548299173, 0.38334998164955125, 0.4654168274249042, 0.5007545145715023, 0.5483930853414124, 0.5773699304580039, 0.5560135914252267, 0.5759033101149713, 0.5825713875877754, 0.5187767753421868, 0.47389407163074315, 0.46554531993507475, 0.45719617244075295, 0.41939519159085603, 0.42763233584529897, 0.41762454087540934, 0.4004896741941034, 0.30960335761254415, 0.2667698230194959, 0.12273262860193213, 0.008103458253446535, -0.05496053236631494, -0.12627295264202315, -0.21594678747149176, -0.21683906263025465, -0.13918553581848944, -0.07134842865479155, -0.08344791128083122, -0.12262877436879455, -0.12401395066912471, -0.2158103508187006, -0.2957252037318836, -0.379900001042187, -0.4342843733033853, -0.45188093993825484, -0.5202092053918994, -0.5740621011556248, -0.6350072566820757, -0.659520956860812, -0.6750915129633972, -0.5550227053202127, -0.4969474571854631, -0.4916993798897847, -0.3759857665380904, -0.2753340677759269, -0.19400462795811527, -0.10146632862911847, 0.0590289572987254, 0.1672231658389803, 0.24084923974189132, 0.32884100795512927, 0.36771927101056806, 0.3430643056973433, 0.4001080102144403, 0.42634903443417854, 0.4255236719917873, 0.43698459415908647, 0.33383009956969345, 0.23514488773656286, 0.12468156675490687, 0.08883616249483459, 0.017331556258493926, -0.011589300447750311, -0.009675480762240653, 0.04922931235990445, 0.040595571100044775, -0.013180108776529836, -0.028725905203042055, -0.024192845374554857, -0.01571791266328025, -0.011362208918502988, -0.03616047420550947, -0.02933241976844798, -0.0852841176329402, -0.10741921329827137, -0.17118789589114236]}, "chart3": {"abvEMA": [296, 341, 346, 414, 413, 420, 394, 408, 398, 401, 322, 370, 357, 315, 330, 294, 319, 139, 179, 287, 374, 327, 341, 377, 313, 303, 339, 310, 243, 419, 426, 390, 413, 403, 350, 394, 383, 302, 310, 343, 341, 305, 352, 332, 321, 228, 264, 132, 133, 168, 143, 104, 191, 287, 294, 214, 178, 215, 103, 95, 70, 86, 118, 51, 52, 30, 60, 65, 229, 182, 131, 269, 279, 280, 314, 421, 396, 380, 416, 377, 308, 403, 379, 352, 367, 228, 208, 169, 234, 181, 216, 247, 318, 249, 191, 225, 246, 252, 249, 214, 247, 171, 199, 142], "belEMA": [164, 119, 114, 48, 49, 42, 70, 56, 66, 64, 143, 95, 109, 151, 136, 172, 148, 328, 288, 180, 95, 143, 130, 94, 158, 171, 135, 165, 232, 56, 49, 85, 62, 73, 126, 82, 93, 176, 169, 136, 138, 176, 130, 150, 161, 254, 218, 351, 351, 317, 343, 385, 299, 203, 196, 279, 316, 279, 391, 399, 424, 408, 376, 443, 442, 465, 435, 430, 266, 313, 364, 226, 216, 215, 181, 74, 99, 115, 79, 118, 187, 92, 116, 143, 128, 267, 287, 326, 261, 314, 279, 248, 177, 246, 304, 270, 249, 243, 246, 281, 248, 324, 296, 353], "e9AbvEMA": [296.0, 305.0, 313.2, 333.36, 349.28800000000007, 363.4304000000001, 369.5443200000001, 377.2354560000001, 381.38836480000015, 385.3106918400001, 372.6485534720001, 372.1188427776001, 369.09507422208014, 358.2760593776641, 352.6208475021313, 340.8966780017051, 336.5173424013641, 297.0138739210913, 273.4110991368731, 276.1288793094985, 295.7031034475988, 301.96248275807903, 309.7699862064632, 323.2159889651706, 321.1727911721365, 317.5382329377092, 321.8305863501674, 319.46446908013394, 304.17157526410716, 327.13726021128576, 346.9098081690286, 355.5278465352229, 367.0222772281784, 374.2178217825427, 369.3742574260342, 374.2994059408274, 376.039524752662, 361.23161980212956, 350.98529584170365, 349.38823667336294, 347.71058933869034, 339.1684714709523, 341.7347771767619, 339.7878217414095, 336.0302573931276, 314.4242059145021, 304.33936473160173, 269.87149178528136, 242.4971934282251, 227.5977547425801, 210.67820379406407, 189.3425630352513, 189.67405042820104, 209.13924034256084, 226.11139227404868, 223.68911381923897, 214.55129105539118, 214.64103284431295, 192.31282627545036, 172.8502610203603, 152.28020881628825, 139.0241670530306, 134.81933364242448, 118.0554669139396, 104.84437353115169, 89.87549882492135, 83.90039905993709, 80.12031924794967, 109.89625539835973, 124.3170043186878, 125.65360345495024, 154.3228827639602, 179.25830621116816, 199.40664496893453, 222.32531597514765, 262.0602527801181, 288.8482022240945, 307.0785617792756, 328.8628494234205, 338.49027953873644, 332.3922236309892, 346.51377890479137, 353.0110231238331, 352.80881849906655, 355.6470547992533, 330.11764383940266, 305.69411507152216, 278.35529205721775, 269.4842336457742, 251.78738691661937, 244.62990953329552, 245.10392762663642, 259.68314210130916, 257.5465136810473, 244.23721094483784, 240.38976875587028, 241.51181500469625, 243.609452003757, 244.68756160300563, 238.55004928240453, 240.24003942592364, 226.3920315407389, 220.91362523259116, 205.13090018607295], "netStocks": [460, 460, 460, 462, 462, 462, 464, 464, 464, 465, 465, 465, 466, 466, 466, 466, 467, 467, 467, 467, 469, 470, 471, 471, 471, 474, 474, 475, 475, 475, 475, 475, 475, 476, 476, 476, 476, 478, 479, 479, 479, 481, 482, 482, 482, 482, 482, 483, 484, 485, 486, 489, 490, 490, 490, 493, 494, 494, 494, 494, 494, 494, 494, 494, 494, 495, 495, 495, 495, 495, 495, 495, 495, 495, 495, 495, 495, 495, 495, 495, 495, 495, 495, 495, 495, 495, 495, 495, 495, 495, 495, 495, 495, 495, 495, 495, 495, 495, 495, 495, 495, 495, 495, 495]}};
    </script>
    <script>
        
        (function() {
            const chartInstances = {};
            let isSyncing = false;

            document.querySelectorAll('.reset-zoom-btn').forEach(button => {
                button.addEventListener('click', (e) => {
                    const chartId = e.target.getAttribute('data-chart-id');
                    if (chartInstances[chartId]) {
                        chartInstances[chartId].resetZoom();
                    }
                });
            });

            function syncCharts(sourceChart) {
                if (isSyncing) return;
                isSyncing = true;
                const { min, max } = sourceChart.scales.x;
                for (const chartId in chartInstances) {
                    const targetChart = chartInstances[chartId];
                    if (targetChart.canvas.id !== sourceChart.canvas.id) {
                        targetChart.options.scales.x.min = min;
                        targetChart.options.scales.x.max = max;
                        targetChart.update('none');
                    }
                }
                isSyncing = false;
            }

            function createCharts(data) {
                const computedStyles = getComputedStyle(document.body);
                const colors = {
                    green: computedStyles.getPropertyValue('--green').trim(), red: computedStyles.getPropertyValue('--red').trim(),
                    blue: computedStyles.getPropertyValue('--blue').trim(), cyan: computedStyles.getPropertyValue('--cyan').trim(),
                    yellow: computedStyles.getPropertyValue('--yellow').trim(), magenta: computedStyles.getPropertyValue('--magenta').trim(),
                    text: computedStyles.getPropertyValue('--text-color').trim(), grid: computedStyles.getPropertyValue('--border-color').trim() + '80',
                };
                const commonOptions = {
                    responsive: true, maintainAspectRatio: false,
                    scales: {
                        x: { grid: { color: colors.grid }, ticks: { color: colors.text, maxRotation: 0, autoSkip: true, maxTicksLimit: 15 }, grace: '5%' },
                        y: { grid: { color: colors.grid }, ticks: { color: colors.text } }
                    },
                    plugins: {
                        legend: { labels: { color: colors.text, font: { size: 14 } } },
                        tooltip: {
                            backgroundColor: computedStyles.getPropertyValue('--card-bg-color').trim(),
                            titleFont: { size: 16 }, bodyFont: { size: 14 }, padding: 10,
                            borderColor: colors.grid, borderWidth: 1, titleColor: colors.text, bodyColor: colors.text,
                        },
                        zoom: {
                            pan: { enabled: true, mode: 'x', onPanComplete: ({ chart }) => syncCharts(chart) },
                            zoom: {
                                drag: { enabled: false },
                                wheel: { enabled: true }, 
                                pinch: { enabled: true },
                                mode: 'x',
                                onZoomComplete: ({ chart }) => syncCharts(chart)
                            }
                        }
                    },
                    elements: { point: { radius: 0 } },
                    interaction: { intersect: false, mode: 'index' }
                };
                const chartHeight = 450;
                document.querySelectorAll('.chart-card canvas').forEach(c => c.parentElement.style.height = chartHeight + 'px');
                
                chartInstances.chart1 = new Chart(document.getElementById('chart1'), { type: 'line', data: { labels: data.labels, datasets: [{ label: 'Trend Of Stks', data: data.chart1.trendOfStocks, borderColor: colors.magenta, borderWidth: 2, tension: 0.1 }, { label: 'e9 (EMA)', data: data.chart1.e9_trendOfStocks, borderColor: colors.blue, borderWidth: 2, tension: 0.1 }] }, options: commonOptions });
                chartInstances.chart2 = new Chart(document.getElementById('chart2'), { type: 'line', data: { labels: data.labels, datasets: [{ label: 'Proportion', data: data.chart2.proportion, borderColor: colors.yellow, borderWidth: 2, tension: 0.1 }, { label: 'e9 (EMA)', data: data.chart2.e9_proportion, borderColor: colors.blue, borderWidth: 2, tension: 0.1 }] }, options: commonOptions });
                chartInstances.chart3 = new Chart(document.getElementById('chart3'), { type: 'line', data: { labels: data.labels, datasets: [{ label: 'Stocks Above EMA', data: data.chart3.abvEMA, borderColor: colors.green, borderWidth: 2, tension: 0.1 }, { label: 'Stocks Below EMA', data: data.chart3.belEMA, borderColor: colors.red, borderWidth: 2, tension: 0.1 }, { label: 'Net Stocks', data: data.chart3.netStocks, borderColor: colors.text, borderWidth: 1, tension: 0.1, borderDash: [5, 5] }] }, options: commonOptions });
            }
            createCharts(window.chartData);
        })();
    
    </script>
</body>
</html>