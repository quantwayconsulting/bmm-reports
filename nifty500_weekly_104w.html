<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nifty 500 - Broad Market Monitor</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/hammer.js/2.0.8/hammer.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-zoom@2.0.1/dist/chartjs-plugin-zoom.min.js"></script>
    <style>
        :root { --bg-color: #1a1b26; --card-bg-color: #24283b; --text-color: #c0caf5; --text-secondary-color: #a9b1d6; --border-color: #414868; --primary-color: #7aa2f7; --green: #9ece6a; --red: #f7768e; --blue: #7aa2f7; --cyan: #7dcfff; --yellow: #e0af68; --magenta: #bb9af7; }
        body[data-theme="bloomberg"] { --bg-color: #0d0d0d; --card-bg-color: #1a1a1a; --text-color: #e0e0e0; --text-secondary-color: #a0a0a0; --border-color: #333333; --primary-color: #ff9900; --green: #00e676; --red: #ff5252; --blue: #2979ff; --cyan: #00e5ff; --yellow: #ffd600; --magenta: #d500f9; }
        body[data-theme="light"] { --bg-color: #f5f7fa; --card-bg-color: #ffffff; --text-color: #1c2a42; --text-secondary-color: #5b6b85; --border-color: #e6e9f0; --primary-color: #0052cc; --green: #00875a; --red: #bf2600; --blue: #0052cc; --cyan: #00a3bf; --yellow: #ffab00; --magenta: #6554c0; }
        body { font-family: 'Segoe UI', 'Roboto', 'Helvetica', sans-serif; background-color: var(--bg-color); color: var(--text-color); margin: 0; padding: 10px; }
        .container { max-width: 1600px; margin: auto; }
        header { text-align: center; margin-bottom: 25px; border-bottom: 1px solid var(--border-color); padding-bottom: 20px; }
        h1 { font-size: 1.5rem; color: var(--text-color); margin: 0 0 5px 0; }
        h2 { margin: 0; color: var(--text-secondary-color); font-weight: 500; font-size: 1rem; }
        .card { background-color: var(--card-bg-color); border: 1px solid var(--border-color); border-radius: 8px; padding: 20px; margin-bottom: 20px; }
        .chart-header { display: flex; flex-direction: column; align-items: flex-start; gap: 10px; border-bottom: 1px solid var(--border-color); padding-bottom: 15px; margin-bottom: 15px; }
        .chart-title { font-size: 1.1rem; color: var(--text-secondary-color); font-weight: 500; }
        .zoom-hint { font-size: 0.8rem; font-style: italic; color: #6c707a; }
        .reset-zoom-btn { background: none; border: 1px solid var(--border-color); color: var(--text-secondary-color); padding: 5px 10px; border-radius: 4px; cursor: pointer; }
        @media (min-width: 600px) { 
            h1 {font-size: 1.8rem;} h2 {font-size: 1.2rem;}
            .chart-header { flex-direction: row; justify-content: space-between; align-items: center;}
        }
    </style>
</head>
<body data-theme="bloomberg">
    <div class="container">
        <header>
            <h1>Nifty 500</h1>
            <h2>Timeframe: Weekly | Lookback: 104 Periods</h2>
        </header>
        <div id="charts">
            <div class="card chart-card"><div class="chart-header"><span class="chart-title">Market Trend (Sum)</span><div><span class="zoom-hint">Scroll/Drag to Zoom</span> <button class="reset-zoom-btn" data-chart-id="chart1">Reset</button></div></div><canvas id="chart1"></canvas></div>
            <div class="card chart-card"><div class="chart-header"><span class="chart-title">Market Proportion</span><div><span class="zoom-hint">Scroll/Drag to Zoom</span> <button class="reset-zoom-btn" data-chart-id="chart2">Reset</button></div></div><canvas id="chart2"></canvas></div>
            <div class="card chart-card"><div class="chart-header"><span class="chart-title">Market Breadth</span><div><span class="zoom-hint">Scroll/Drag to Zoom</span> <button class="reset-zoom-btn" data-chart-id="chart3">Reset</button></div></div><canvas id="chart3"></canvas></div>
        </div>
    </div>
    <script>
        window.chartData = {"labels": ["2023-10-19", "2023-10-27", "2023-11-03", "2023-11-10", "2023-11-17", "2023-11-24", "2023-12-04", "2023-12-11", "2023-12-18", "2023-12-26", "2024-01-02", "2024-01-09", "2024-01-16", "2024-01-23", "2024-01-31", "2024-02-07", "2024-02-14", "2024-02-21", "2024-02-28", "2024-03-05", "2024-03-13", "2024-03-20", "2024-03-28", "2024-04-05", "2024-04-15", "2024-04-23", "2024-04-30", "2024-05-08", "2024-05-15", "2024-05-22", "2024-05-29", "2024-06-05", "2024-06-12", "2024-06-20", "2024-06-27", "2024-07-04", "2024-07-11", "2024-07-19", "2024-07-26", "2024-08-02", "2024-08-09", "2024-08-19", "2024-08-26", "2024-09-02", "2024-09-09", "2024-09-16", "2024-09-23", "2024-09-30", "2024-10-08", "2024-10-15", "2024-10-22", "2024-10-29", "2024-11-05", "2024-11-12", "2024-11-21", "2024-11-28", "2024-12-05", "2024-12-12", "2024-12-19", "2024-12-27", "2025-01-03", "2025-01-10", "2025-01-17", "2025-01-24", "2025-01-31", "2025-02-06", "2025-02-13", "2025-02-20", "2025-02-28", "2025-03-07", "2025-03-17", "2025-03-24", "2025-04-01", "2025-04-08", "2025-04-17", "2025-04-25", "2025-05-05", "2025-05-12", "2025-05-19", "2025-05-26", "2025-06-02", "2025-06-09", "2025-06-16", "2025-06-23", "2025-06-30", "2025-07-07", "2025-07-14", "2025-07-21", "2025-07-28", "2025-08-04", "2025-08-11", "2025-08-19", "2025-08-26", "2025-09-03", "2025-09-10", "2025-09-17", "2025-09-24", "2025-10-01", "2025-10-09", "2025-10-16", "2025-10-24", "2025-10-31", "2025-11-10", "2025-11-17"], "chart1": {"trendOfStocks": [215, -39, 45, 131, 209, 215, 332, 334, 344, 292, 316, 302, 307, 163, 251, 234, 152, 178, 110, 149, -173, -105, 99, 257, 174, 199, 263, 149, 128, 196, 137, 23, 333, 337, 271, 321, 300, 198, 276, 256, 112, 125, 187, 187, 115, 198, 162, 146, -18, 52, -198, -197, -134, -177, -250, -93, 79, 101, -47, -118, -56, -256, -272, -320, -294, -234, -356, -358, -389, -339, -333, -39, -131, -213, 37, 57, 53, 123, 309, 263, 237, 299, 227, 99, 271, 225, 183, 211, -43, -71, -149, -35, -123, -53, -3, 125, 5, -93, -45, -9, 11, 5, -57, -121], "e9_trendOfStocks": [215.0, 164.2, 140.35999999999999, 138.488, 152.59040000000002, 165.07232000000002, 198.45785600000002, 225.5662848, 249.25302784000002, 257.80242227200006, 269.44193781760004, 275.95355025408, 282.16284020326407, 258.33027216261127, 256.864217730089, 252.29137418407123, 232.233099347257, 221.3864794778056, 199.1091835822445, 189.0873468657956, 116.66987749263649, 72.3359019941092, 77.66872159528735, 113.53497727622988, 125.6279818209839, 140.30238545678714, 164.8419083654297, 161.67352669234378, 154.93882135387503, 163.15105708310003, 157.92084566648003, 130.93667653318403, 171.34934122654724, 204.4794729812378, 217.78357838499022, 238.4268627079922, 250.74149016639376, 240.19319213311502, 247.35455370649203, 249.08364296519363, 221.66691437215493, 202.33353149772395, 199.2668251981792, 196.81346015854336, 180.4507681268347, 183.96061450146777, 179.56849160117423, 172.85479328093942, 134.68383462475154, 118.14706769980124, 54.917654159841, 4.534123327872798, -23.17270133770176, -53.93816107016141, -93.15052885612913, -93.12042308490331, -58.69633846792266, -26.757070774338125, -30.805656619470504, -48.24452529557641, -49.79562023646113, -91.03649618916891, -127.22919695133514, -165.7833575610681, -191.4266860488545, -199.94134883908362, -231.15307907126692, -256.52246325701356, -283.01797060561086, -294.2143764844887, -301.971501187591, -249.37720095007282, -225.70176076005828, -223.16140860804663, -171.12912688643732, -125.50330150914985, -89.80264120731988, -47.2421129658559, 24.006309627315282, 71.80504770185223, 104.84403816148179, 143.67523052918546, 160.34018442334838, 148.0721475386787, 172.657718030943, 183.1261744247544, 183.1009395398035, 188.68075163184284, 142.34460130547427, 99.67568104437942, 49.940544835503545, 32.95243586840284, 1.7619486947222711, -9.190441044222185, -7.952352835377749, 18.6381177316978, 15.91049418535824, -5.871604651713408, -13.697283721370727, -12.757826977096583, -8.006261581677268, -5.405009265341815, -15.724007412273451, -36.779205929818765]}, "chart2": {"proportion": [0.5205811138014528, -0.09443099273607748, 0.1089588377723971, 0.3171912832929782, 0.5060532687651331, 0.5205811138014528, 0.8019323671497585, 0.8067632850241546, 0.8309178743961353, 0.7019230769230769, 0.7596153846153846, 0.7259615384615384, 0.7362110311750599, 0.3908872901678657, 0.6019184652278178, 0.5598086124401914, 0.36363636363636365, 0.4258373205741627, 0.2631578947368421, 0.3556085918854415, -0.4128878281622912, -0.25059665871121717, 0.23627684964200477, 0.6104513064133017, 0.41232227488151657, 0.47044917257683216, 0.6217494089834515, 0.35224586288416077, 0.3004694835680751, 0.460093896713615, 0.32084309133489464, 0.053864168618266976, 0.7798594847775175, 0.7892271662763466, 0.6346604215456675, 0.7517564402810304, 0.7009345794392523, 0.46261682242990654, 0.6448598130841121, 0.5981308411214953, 0.26046511627906976, 0.2900232018561485, 0.43387470997679817, 0.43387470997679817, 0.26558891454965355, 0.45622119815668205, 0.37327188940092165, 0.33640552995391704, -0.041474654377880185, 0.11981566820276497, -0.45622119815668205, -0.4528735632183908, -0.3073394495412844, -0.40503432494279173, -0.5681818181818182, -0.2108843537414966, 0.17913832199546487, 0.2290249433106576, -0.10609480812641084, -0.26576576576576577, -0.12612612612612611, -0.5765765765765766, -0.6126126126126126, -0.7207207207207207, -0.6621621621621622, -0.527027027027027, -0.8018018018018018, -0.8063063063063063, -0.8741573033707866, -0.7617977528089888, -0.748314606741573, -0.08764044943820225, -0.2943820224719101, -0.4786516853932584, 0.08314606741573034, 0.12808988764044943, 0.11910112359550562, 0.27640449438202247, 0.6943820224719102, 0.5910112359550562, 0.5325842696629214, 0.6719101123595506, 0.5101123595505618, 0.22247191011235956, 0.6089887640449438, 0.5056179775280899, 0.41123595505617977, 0.47415730337078654, -0.09662921348314607, -0.15955056179775282, -0.3348314606741573, -0.07865168539325842, -0.27640449438202247, -0.11910112359550562, -0.006741573033707865, 0.2808988764044944, 0.011235955056179775, -0.20898876404494382, -0.10112359550561797, -0.020224719101123594, 0.024719101123595506, 0.011235955056179775, -0.12808988764044943, -0.27191011235955054], "e9_proportion": [0.5205811138014528, 0.39757869249394673, 0.3398547215496368, 0.3353220338983051, 0.3694682808716707, 0.3996908474576272, 0.48013915139605345, 0.5454639781216737, 0.602554757376566, 0.6224284212858682, 0.6498658139517715, 0.6650849588537249, 0.6793101733179918, 0.6216255966879666, 0.6176841703959368, 0.6061090588047877, 0.5576145197711029, 0.5312590799317148, 0.47763884289274033, 0.4532327926912806, 0.2800086685205663, 0.17388760307420958, 0.18636545238776864, 0.2711826231928752, 0.29941055353060353, 0.3336182773398493, 0.3912445036685698, 0.383444775511688, 0.36684971712296544, 0.38549855304109537, 0.37256746069985525, 0.3088268022835376, 0.4030333387823336, 0.48027210428113626, 0.5111497677340425, 0.5592711022434401, 0.5876037976826026, 0.5626064026320634, 0.5790570847224732, 0.5828718360022777, 0.5183904920576361, 0.4727170340173386, 0.46494856920923056, 0.4587337973627441, 0.420104820800126, 0.42732809627143725, 0.41651685489733414, 0.4004945899086507, 0.31210074105134455, 0.27364372648162866, 0.12767074155396652, 0.011561880599495047, -0.05221838542866085, -0.12278157333148704, -0.21186162230155328, -0.21166616858954196, -0.13350527047254063, -0.06099922771590098, -0.07001834379800295, -0.10916782819155552, -0.11255948777846964, -0.20536290553809103, -0.28681284695299536, -0.37359442170654045, -0.43130796979766484, -0.4504517812435373, -0.5207217853551902, -0.5778386895454135, -0.6371024123104881, -0.6620414804101883, -0.6792961056764653, -0.5609649744288127, -0.5076483840374322, -0.5018490443085974, -0.3848500219637319, -0.2822620400428957, -0.20198940731521542, -0.10631062697576785, 0.05382790291376777, 0.16126456952202545, 0.23552850955020466, 0.32280483011207384, 0.3602663359997715, 0.3327074508222891, 0.38796371346682, 0.41149456627907405, 0.4114428440344952, 0.42398573590175354, 0.3198627460247736, 0.22398008446026832, 0.11221777543338321, 0.07404388326805489, 0.0039542077380394156, -0.020656858528669594, -0.01787380142967725, 0.04188073413715708, 0.035751778320961616, -0.013196330152219472, -0.03078178322289918, -0.028670370398544063, -0.01799247609411615, -0.012146789864056965, -0.03533540941933546, -0.08265035000737848]}, "chart3": {"abvEMA": [314, 187, 229, 272, 311, 314, 373, 374, 379, 354, 366, 359, 362, 290, 334, 326, 285, 298, 264, 284, 123, 157, 259, 339, 298, 311, 343, 286, 277, 311, 282, 225, 380, 382, 349, 374, 364, 313, 352, 342, 271, 278, 309, 309, 274, 316, 298, 290, 208, 243, 118, 119, 151, 130, 95, 174, 260, 271, 198, 163, 194, 94, 86, 62, 75, 105, 44, 43, 28, 53, 56, 203, 157, 116, 241, 251, 249, 284, 377, 354, 341, 372, 336, 272, 358, 335, 314, 328, 201, 187, 148, 205, 161, 196, 221, 285, 225, 176, 200, 218, 228, 225, 194, 162], "belEMA": [99, 226, 184, 141, 102, 99, 41, 40, 35, 62, 50, 57, 55, 127, 83, 92, 133, 120, 154, 135, 296, 262, 160, 82, 124, 112, 80, 137, 149, 115, 145, 202, 47, 45, 78, 53, 64, 115, 76, 86, 159, 153, 122, 122, 159, 118, 136, 144, 226, 191, 316, 316, 285, 307, 345, 267, 181, 170, 245, 281, 250, 350, 358, 382, 369, 339, 400, 401, 417, 392, 389, 242, 288, 329, 204, 194, 196, 161, 68, 91, 104, 73, 109, 173, 87, 110, 131, 117, 244, 258, 297, 240, 284, 249, 224, 160, 220, 269, 245, 227, 217, 220, 251, 283], "e9AbvEMA": [314.0, 288.6, 276.68, 275.744, 282.7952, 289.03616000000005, 305.8289280000001, 319.4631424000001, 331.37051392000006, 335.8964111360001, 341.91712890880007, 345.33370312704005, 348.66696250163204, 336.93357000130567, 336.34685600104456, 334.2774848008356, 324.4219878406685, 319.13759027253485, 308.1100722180279, 303.2880577744223, 267.2304462195379, 245.18435697563032, 247.9474855805043, 266.15798846440345, 272.52639077152276, 280.22111261721824, 292.7768900937746, 291.42151207501973, 288.53720966001583, 293.0297677280127, 290.82381418241016, 277.6590513459281, 298.1272410767425, 314.90179286139403, 321.7214342891152, 332.1771474312922, 338.5417179450338, 333.43337435602706, 337.1466994848216, 338.1173595878573, 324.69388767028585, 315.3551101362287, 314.08408810898294, 313.06727048718636, 305.2538163897491, 307.4030531117993, 305.52244248943947, 302.4179539915516, 283.5343631932413, 275.4274905545931, 243.94199244367448, 218.9535939549396, 205.36287516395168, 190.29030013116136, 171.2322401049291, 171.7857920839433, 189.42863366715466, 205.74290693372376, 204.194325546979, 195.9554604375832, 195.5643683500666, 175.2514946800533, 157.40119574404264, 138.32095659523412, 125.6567652761873, 121.52541222094985, 106.02032977675988, 93.41626382140791, 80.33301105712633, 74.86640884570107, 71.09312707656086, 97.4745016612487, 109.37960132899897, 110.70368106319918, 136.76294485055934, 159.61035588044746, 177.48828470435797, 198.79062776348638, 234.43250221078912, 258.3460017686313, 274.87680141490506, 294.3014411319241, 302.6411529055393, 296.51292232443143, 308.81033785954514, 314.0482702876361, 314.0386162301089, 316.83089298408714, 293.6647143872697, 272.3317715098158, 247.46541720785262, 238.9723337662821, 223.3778670130257, 217.9022936104206, 218.5218348883365, 231.81746791066922, 230.4539743285354, 219.56317946282832, 215.65054357026267, 216.12043485621015, 218.49634788496812, 219.79707830797452, 214.63766264637962, 204.11013011710372], "netStocks": [413, 413, 413, 413, 413, 413, 414, 414, 414, 416, 416, 416, 417, 417, 417, 418, 418, 418, 418, 419, 419, 419, 419, 421, 422, 423, 423, 423, 426, 426, 427, 427, 427, 427, 427, 427, 428, 428, 428, 428, 430, 431, 431, 431, 433, 434, 434, 434, 434, 434, 434, 435, 436, 437, 440, 441, 441, 441, 443, 444, 444, 444, 444, 444, 444, 444, 444, 444, 445, 445, 445, 445, 445, 445, 445, 445, 445, 445, 445, 445, 445, 445, 445, 445, 445, 445, 445, 445, 445, 445, 445, 445, 445, 445, 445, 445, 445, 445, 445, 445, 445, 445, 445, 445]}};
    </script>
    <script>
        
        (function() {
            const chartInstances = {};
            let isSyncing = false;

            document.querySelectorAll('.reset-zoom-btn').forEach(button => {
                button.addEventListener('click', (e) => {
                    const chartId = e.target.getAttribute('data-chart-id');
                    if (chartInstances[chartId]) {
                        chartInstances[chartId].resetZoom();
                    }
                });
            });

            function syncCharts(sourceChart) {
                if (isSyncing) return;
                isSyncing = true;
                const { min, max } = sourceChart.scales.x;
                for (const chartId in chartInstances) {
                    const targetChart = chartInstances[chartId];
                    if (targetChart.canvas.id !== sourceChart.canvas.id) {
                        targetChart.options.scales.x.min = min;
                        targetChart.options.scales.x.max = max;
                        targetChart.update('none');
                    }
                }
                isSyncing = false;
            }

            function createCharts(data) {
                const computedStyles = getComputedStyle(document.body);
                const colors = {
                    green: computedStyles.getPropertyValue('--green').trim(), red: computedStyles.getPropertyValue('--red').trim(),
                    blue: computedStyles.getPropertyValue('--blue').trim(), cyan: computedStyles.getPropertyValue('--cyan').trim(),
                    yellow: computedStyles.getPropertyValue('--yellow').trim(), magenta: computedStyles.getPropertyValue('--magenta').trim(),
                    text: computedStyles.getPropertyValue('--text-color').trim(), grid: computedStyles.getPropertyValue('--border-color').trim() + '80',
                };
                const commonOptions = {
                    responsive: true, maintainAspectRatio: false,
                    scales: {
                        x: { grid: { color: colors.grid }, ticks: { color: colors.text, maxRotation: 0, autoSkip: true, maxTicksLimit: 15 }, grace: '5%' },
                        y: { grid: { color: colors.grid }, ticks: { color: colors.text } }
                    },
                    plugins: {
                        legend: { labels: { color: colors.text, font: { size: 14 } } },
                        tooltip: {
                            backgroundColor: computedStyles.getPropertyValue('--card-bg-color').trim(),
                            titleFont: { size: 16 }, bodyFont: { size: 14 }, padding: 10,
                            borderColor: colors.grid, borderWidth: 1, titleColor: colors.text, bodyColor: colors.text,
                        },
                        zoom: {
                            pan: { enabled: true, mode: 'x', onPanComplete: ({ chart }) => syncCharts(chart) },
                            zoom: {
                                drag: { enabled: false },
                                wheel: { enabled: true }, 
                                pinch: { enabled: true },
                                mode: 'x',
                                onZoomComplete: ({ chart }) => syncCharts(chart)
                            }
                        }
                    },
                    elements: { point: { radius: 0 } },
                    interaction: { intersect: false, mode: 'index' }
                };
                const chartHeight = 450;
                document.querySelectorAll('.chart-card canvas').forEach(c => c.parentElement.style.height = chartHeight + 'px');
                
                chartInstances.chart1 = new Chart(document.getElementById('chart1'), { type: 'line', data: { labels: data.labels, datasets: [{ label: 'Trend Of Stks', data: data.chart1.trendOfStocks, borderColor: colors.magenta, borderWidth: 2, tension: 0.1 }, { label: 'e9 (EMA)', data: data.chart1.e9_trendOfStocks, borderColor: colors.blue, borderWidth: 2, tension: 0.1 }] }, options: commonOptions });
                chartInstances.chart2 = new Chart(document.getElementById('chart2'), { type: 'line', data: { labels: data.labels, datasets: [{ label: 'Proportion', data: data.chart2.proportion, borderColor: colors.yellow, borderWidth: 2, tension: 0.1 }, { label: 'e9 (EMA)', data: data.chart2.e9_proportion, borderColor: colors.blue, borderWidth: 2, tension: 0.1 }] }, options: commonOptions });
                chartInstances.chart3 = new Chart(document.getElementById('chart3'), { type: 'line', data: { labels: data.labels, datasets: [{ label: 'Stocks Above EMA', data: data.chart3.abvEMA, borderColor: colors.green, borderWidth: 2, tension: 0.1 }, { label: 'Stocks Below EMA', data: data.chart3.belEMA, borderColor: colors.red, borderWidth: 2, tension: 0.1 }, { label: 'Net Stocks', data: data.chart3.netStocks, borderColor: colors.text, borderWidth: 1, tension: 0.1, borderDash: [5, 5] }] }, options: commonOptions });
            }
            createCharts(window.chartData);
        })();
    
    </script>
</body>
</html>