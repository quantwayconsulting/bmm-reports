<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nifty 500 - Broad Market Monitor</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/hammer.js/2.0.8/hammer.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-zoom@2.0.1/dist/chartjs-plugin-zoom.min.js"></script>
    <style>
        :root { --bg-color: #1a1b26; --card-bg-color: #24283b; --text-color: #c0caf5; --text-secondary-color: #a9b1d6; --border-color: #414868; --primary-color: #7aa2f7; --green: #9ece6a; --red: #f7768e; --blue: #7aa2f7; --cyan: #7dcfff; --yellow: #e0af68; --magenta: #bb9af7; }
        body[data-theme="bloomberg"] { --bg-color: #0d0d0d; --card-bg-color: #1a1a1a; --text-color: #e0e0e0; --text-secondary-color: #a0a0a0; --border-color: #333333; --primary-color: #ff9900; --green: #00e676; --red: #ff5252; --blue: #2979ff; --cyan: #00e5ff; --yellow: #ffd600; --magenta: #d500f9; }
        body[data-theme="light"] { --bg-color: #f5f7fa; --card-bg-color: #ffffff; --text-color: #1c2a42; --text-secondary-color: #5b6b85; --border-color: #e6e9f0; --primary-color: #0052cc; --green: #00875a; --red: #bf2600; --blue: #0052cc; --cyan: #00a3bf; --yellow: #ffab00; --magenta: #6554c0; }
        body { font-family: 'Segoe UI', 'Roboto', 'Helvetica', sans-serif; background-color: var(--bg-color); color: var(--text-color); margin: 0; padding: 10px; }
        .container { max-width: 1600px; margin: auto; }
        header { text-align: center; margin-bottom: 25px; border-bottom: 1px solid var(--border-color); padding-bottom: 20px; }
        h1 { font-size: 1.5rem; color: var(--text-color); margin: 0 0 5px 0; }
        h2 { margin: 0; color: var(--text-secondary-color); font-weight: 500; font-size: 1rem; }
        .card { background-color: var(--card-bg-color); border: 1px solid var(--border-color); border-radius: 8px; padding: 20px; margin-bottom: 20px; }
        .chart-header { display: flex; flex-direction: column; align-items: flex-start; gap: 10px; border-bottom: 1px solid var(--border-color); padding-bottom: 15px; margin-bottom: 15px; }
        .chart-title { font-size: 1.1rem; color: var(--text-secondary-color); font-weight: 500; }
        .zoom-hint { font-size: 0.8rem; font-style: italic; color: #6c707a; }
        .reset-zoom-btn { background: none; border: 1px solid var(--border-color); color: var(--text-secondary-color); padding: 5px 10px; border-radius: 4px; cursor: pointer; }
        @media (min-width: 600px) { 
            h1 {font-size: 1.8rem;} h2 {font-size: 1.2rem;}
            .chart-header { flex-direction: row; justify-content: space-between; align-items: center;}
        }
    </style>
</head>
<body data-theme="bloomberg">
    <div class="container">
        <header>
            <h1>Nifty 500</h1>
            <h2>Timeframe: Weekly | Lookback: 104 Periods</h2>
        </header>
        <div id="charts">
            <div class="card chart-card"><div class="chart-header"><span class="chart-title">Market Trend (Sum)</span><div><span class="zoom-hint">Scroll/Drag to Zoom</span> <button class="reset-zoom-btn" data-chart-id="chart1">Reset</button></div></div><canvas id="chart1"></canvas></div>
            <div class="card chart-card"><div class="chart-header"><span class="chart-title">Market Proportion</span><div><span class="zoom-hint">Scroll/Drag to Zoom</span> <button class="reset-zoom-btn" data-chart-id="chart2">Reset</button></div></div><canvas id="chart2"></canvas></div>
            <div class="card chart-card"><div class="chart-header"><span class="chart-title">Market Breadth</span><div><span class="zoom-hint">Scroll/Drag to Zoom</span> <button class="reset-zoom-btn" data-chart-id="chart3">Reset</button></div></div><canvas id="chart3"></canvas></div>
        </div>
    </div>
    <script>
        window.chartData = {"labels": ["2023-10-05", "2023-10-12", "2023-10-19", "2023-10-27", "2023-11-03", "2023-11-10", "2023-11-17", "2023-11-24", "2023-12-04", "2023-12-11", "2023-12-18", "2023-12-26", "2024-01-02", "2024-01-09", "2024-01-16", "2024-01-23", "2024-01-31", "2024-02-07", "2024-02-14", "2024-02-21", "2024-02-28", "2024-03-05", "2024-03-13", "2024-03-20", "2024-03-28", "2024-04-05", "2024-04-15", "2024-04-23", "2024-04-30", "2024-05-08", "2024-05-15", "2024-05-22", "2024-05-29", "2024-06-05", "2024-06-12", "2024-06-20", "2024-06-27", "2024-07-04", "2024-07-11", "2024-07-19", "2024-07-26", "2024-08-02", "2024-08-09", "2024-08-19", "2024-08-26", "2024-09-02", "2024-09-09", "2024-09-16", "2024-09-23", "2024-09-30", "2024-10-08", "2024-10-15", "2024-10-22", "2024-10-29", "2024-11-05", "2024-11-12", "2024-11-21", "2024-11-28", "2024-12-05", "2024-12-12", "2024-12-19", "2024-12-27", "2025-01-03", "2025-01-10", "2025-01-17", "2025-01-24", "2025-01-31", "2025-02-06", "2025-02-13", "2025-02-20", "2025-02-28", "2025-03-07", "2025-03-17", "2025-03-24", "2025-04-01", "2025-04-08", "2025-04-17", "2025-04-25", "2025-05-05", "2025-05-12", "2025-05-19", "2025-05-26", "2025-06-02", "2025-06-09", "2025-06-16", "2025-06-23", "2025-06-30", "2025-07-07", "2025-07-14", "2025-07-21", "2025-07-28", "2025-08-04", "2025-08-11", "2025-08-19", "2025-08-26", "2025-09-03", "2025-09-10", "2025-09-17", "2025-09-24", "2025-10-01", "2025-10-09", "2025-10-16", "2025-10-24", "2025-10-31"], "chart1": {"trendOfStocks": [209, 248, 222, -54, 33, 120, 210, 216, 352, 352, 364, 308, 340, 320, 319, 165, 259, 236, 154, 180, 108, 153, -185, -109, 97, 265, 174, 203, 273, 147, 126, 202, 133, 7, 343, 355, 289, 333, 304, 200, 286, 270, 110, 125, 183, 187, 113, 194, 156, 140, -44, 30, -225, -226, -159, -208, -291, -124, 58, 76, -79, -158, -80, -290, -310, -350, -322, -258, -386, -390, -429, -375, -361, -53, -151, -247, 23, 47, 49, 111, 321, 271, 237, 311, 237, 105, 289, 245, 195, 213, -47, -83, -161, -43, -141, -73, -17, 121, -19, -129, -69, -27, -15, -21], "e9_trendOfStocks": [209.0, 216.8, 217.84000000000003, 163.47200000000004, 137.37760000000003, 133.90208, 149.121664, 162.49733120000002, 200.39786496000002, 230.71829196800005, 257.37463357440004, 267.4997068595201, 281.99976548761606, 289.5998123900929, 295.4798499120743, 269.38387992965943, 267.30710394372755, 261.04568315498204, 239.63654652398566, 227.70923721918854, 203.76738977535084, 193.61391182028066, 117.89112945622455, 72.51290356497965, 77.41032285198372, 114.92825828158698, 126.74260662526959, 141.9940853002157, 168.19526824017257, 163.95621459213805, 156.36497167371044, 165.49197733896835, 158.99358187117468, 128.59486549693975, 171.47589239755183, 208.18071391804148, 224.3445711344332, 246.0756569075466, 257.6605255260373, 246.12842042082985, 254.1027363366639, 257.28218906933114, 227.82575125546492, 207.26060100437195, 202.40848080349755, 199.32678464279806, 182.06142771423845, 184.44914217139078, 178.75931373711262, 171.0074509896901, 128.00596079175207, 108.40476863340166, 41.72381490672133, -11.82094807462294, -41.256758459698354, -74.6054067677587, -117.88432541420696, -119.10746033136557, -83.68596826509247, -51.74877461207397, -57.19901968965918, -77.35921575172735, -77.88737260138188, -120.3098980811055, -158.2479184648844, -196.59833477190753, -221.67866781752605, -228.94293425402086, -260.3543474032167, -286.2834779225734, -314.82678233805876, -326.861425870447, -333.68914069635764, -277.55131255708613, -252.24105004566894, -251.19284003653516, -196.35427202922816, -147.68341762338252, -108.34673409870602, -64.47738727896483, 12.61809017682814, 64.29447214146252, 98.83557771317003, 141.26846217053603, 160.41476973642884, 149.33181578914306, 177.26545263131447, 190.8123621050516, 191.64988968404128, 195.91991174723302, 147.33592939778643, 101.26874351822914, 48.814994814583315, 30.451995851666652, -3.8384033186666784, -17.670722654933343, -17.536578123946676, 10.170737500842662, 4.33659000067413, -22.330727999460695, -31.66458239956856, -30.73166591965485, -27.58533273572388, -26.268266188579105]}, "chart2": {"proportion": [0.46547884187082406, 0.5511111111111111, 0.49333333333333335, -0.12, 0.07317073170731707, 0.26548672566371684, 0.4646017699115044, 0.4778761061946903, 0.775330396475771, 0.775330396475771, 0.801762114537445, 0.6754385964912281, 0.7456140350877193, 0.7017543859649122, 0.6980306345733042, 0.3610503282275711, 0.5667396061269147, 0.5152838427947598, 0.33624454148471616, 0.3930131004366812, 0.23580786026200873, 0.3333333333333333, -0.40305010893246185, -0.2374727668845316, 0.2113289760348584, 0.5773420479302832, 0.3782608695652174, 0.4403470715835141, 0.5921908893709328, 0.3188720173535792, 0.27155172413793105, 0.4353448275862069, 0.2860215053763441, 0.015053763440860216, 0.7376344086021506, 0.7634408602150538, 0.621505376344086, 0.7161290322580646, 0.6523605150214592, 0.4291845493562232, 0.6137339055793991, 0.5793991416309013, 0.23504273504273504, 0.26652452025586354, 0.39019189765458423, 0.39872068230277186, 0.23991507430997877, 0.4110169491525424, 0.3305084745762712, 0.2966101694915254, -0.09322033898305085, 0.0635593220338983, -0.47568710359408034, -0.4767932489451477, -0.33473684210526317, -0.4369747899159664, -0.6075156576200418, -0.25833333333333336, 0.12083333333333333, 0.15833333333333333, -0.16356107660455488, -0.32644628099173556, -0.1652892561983471, -0.5991735537190083, -0.640495867768595, -0.7231404958677686, -0.6652892561983471, -0.5330578512396694, -0.7975206611570248, -0.8057851239669421, -0.8845360824742268, -0.7731958762886598, -0.7443298969072165, -0.10927835051546392, -0.311340206185567, -0.5092783505154639, 0.04742268041237113, 0.09690721649484536, 0.10103092783505155, 0.2288659793814433, 0.6618556701030928, 0.5587628865979382, 0.488659793814433, 0.6412371134020619, 0.488659793814433, 0.21649484536082475, 0.5958762886597938, 0.5051546391752577, 0.4020618556701031, 0.43917525773195876, -0.09690721649484536, -0.1711340206185567, -0.3319587628865979, -0.088659793814433, -0.2907216494845361, -0.15051546391752577, -0.03505154639175258, 0.24948453608247423, -0.03917525773195876, -0.26597938144329897, -0.1422680412371134, -0.05567010309278351, -0.030927835051546393, -0.04329896907216495], "e9_proportion": [0.46547884187082406, 0.4826052957188815, 0.4847509032417719, 0.3638007225934175, 0.3056747244161974, 0.2976371246657013, 0.33103005371486194, 0.36039926421082763, 0.44338549066381633, 0.5097744718262073, 0.5681720003684548, 0.5896253195930095, 0.6208230626919514, 0.6370093273465436, 0.6492135887918957, 0.5915809366790309, 0.5866126705686077, 0.5723469050138381, 0.5251264323080137, 0.49870376593374727, 0.4461245847993996, 0.42356633450618636, 0.2582430458184567, 0.15909988327785907, 0.16954570182925893, 0.25110497104946383, 0.27653615075261456, 0.3092983349187945, 0.3658768458092222, 0.3564758801180936, 0.3394910489220611, 0.3586618046548903, 0.344133744799181, 0.27831774852751684, 0.3701810805424436, 0.44883303647696565, 0.4833675044503898, 0.5299198100119248, 0.5544079510138318, 0.5293632706823101, 0.546237397661728, 0.5528697464555626, 0.4893043441729971, 0.44474837938957046, 0.43383708304257323, 0.426813802894613, 0.3894340571776862, 0.39375063557265744, 0.38110220337338024, 0.3642037965970093, 0.2727189694809973, 0.23088703999157748, 0.08957221127444591, -0.023700880769472812, -0.08590807303663088, -0.156121416412498, -0.24640026465400677, -0.2487868783898721, -0.174862836045231, -0.10822360216951812, -0.11929109705652549, -0.16072213384356754, -0.16163555831452345, -0.24914315739542042, -0.3274136994700554, -0.4065590587495981, -0.45830509823934795, -0.4732556488394123, -0.5381086513029348, -0.5916439458357363, -0.6502223731634345, -0.6748170737884795, -0.6887196384122269, -0.5728313808328743, -0.5205331459034129, -0.5182821868258232, -0.4051412133781843, -0.3047315274035784, -0.2235790363558524, -0.13309003320839327, 0.025899107453903947, 0.1324718632827108, 0.20370944938905522, 0.2912149821916566, 0.3307039445162119, 0.30786212468513446, 0.36546495748006635, 0.39340289381910465, 0.39513468618930436, 0.40394280049783526, 0.30377279709929916, 0.208791433555728, 0.1006413942672628, 0.06278115665092365, -0.007919404576168299, -0.0364386164444398, -0.036161202433902355, 0.020967945269372963, 0.008939304669106618, -0.046044432553374495, -0.06528915429012228, -0.06336534405065453, -0.0568778422508329, -0.05416206761509931]}, "chart3": {"abvEMA": [329, 349, 336, 198, 242, 286, 331, 334, 403, 403, 409, 382, 398, 388, 388, 311, 358, 347, 306, 319, 283, 306, 137, 175, 278, 362, 317, 332, 367, 304, 295, 333, 299, 236, 404, 410, 377, 399, 385, 333, 376, 368, 289, 297, 326, 328, 292, 333, 314, 306, 214, 251, 124, 124, 158, 134, 94, 178, 269, 278, 202, 163, 202, 97, 87, 67, 81, 113, 49, 47, 28, 55, 62, 216, 167, 119, 254, 266, 267, 298, 403, 378, 361, 398, 361, 295, 387, 365, 340, 349, 219, 201, 162, 221, 172, 206, 234, 303, 233, 178, 208, 229, 235, 232], "belEMA": [120, 101, 114, 252, 209, 166, 121, 118, 51, 51, 45, 74, 58, 68, 69, 146, 99, 111, 152, 139, 175, 153, 322, 284, 181, 97, 143, 129, 94, 157, 169, 131, 166, 229, 61, 55, 88, 66, 81, 133, 90, 98, 179, 172, 143, 141, 179, 139, 158, 166, 258, 221, 349, 350, 317, 342, 385, 302, 211, 202, 281, 321, 282, 387, 397, 417, 403, 371, 435, 437, 457, 430, 423, 269, 318, 366, 231, 219, 218, 187, 82, 107, 124, 87, 124, 190, 98, 120, 145, 136, 266, 284, 323, 264, 313, 279, 251, 182, 252, 307, 277, 256, 250, 253], "e9AbvEMA": [329.0, 333.0, 333.6, 306.4800000000001, 293.58400000000006, 292.06720000000007, 299.8537600000001, 306.6830080000001, 325.9464064000001, 341.35712512000015, 354.88570009600016, 360.3085600768002, 367.8468480614402, 371.8774784491522, 375.1019827593218, 362.28158620745745, 361.425268965966, 358.54021517277283, 348.03217213821824, 342.2257377105746, 330.3805901684597, 325.50447213476775, 287.8035777078142, 265.24286216625137, 267.7942897330011, 286.6354317864009, 292.70834542912075, 300.56667634329665, 313.85334107463734, 311.8826728597099, 308.50613828776795, 313.4049106302144, 310.5239285041715, 295.61914280333724, 317.2953142426698, 335.83625139413584, 344.06900111530865, 355.05520089224694, 361.04416071379757, 355.4353285710381, 359.5482628568305, 361.2386102854644, 346.79088822837156, 336.83271058269725, 334.6661684661578, 333.33293477292625, 325.066347818341, 326.65307825467283, 324.1224626037383, 320.49797008299066, 299.19837606639254, 289.55870085311403, 256.44696068249124, 229.957568545993, 215.56605483679442, 199.25284386943557, 178.2022750955485, 178.1618200764388, 196.32945606115106, 212.66356484892086, 210.5308518791367, 201.02468150330935, 201.2197452026475, 180.375796162118, 161.7006369296944, 142.76050954375555, 130.40840763500444, 126.92672610800355, 111.34138088640285, 98.47310470912228, 84.37848376729782, 78.50278701383826, 75.2022296110706, 103.36178368885649, 116.08942695108519, 116.67154156086815, 144.13723324869454, 168.50978659895566, 188.20782927916454, 210.16626342333163, 248.7330107386653, 274.58640859093225, 291.8691268727458, 313.0953014981967, 322.67624119855736, 317.1409929588459, 331.11279436707673, 337.8902354936614, 338.31218839492914, 340.4497507159433, 316.15980057275465, 293.1278404582037, 266.90227236656295, 257.7218178932504, 240.57745431460032, 233.66196345168026, 233.72957076134423, 247.5836566090754, 244.66692528726034, 231.33354022980828, 226.66683218384662, 227.1334657470773, 228.70677259766185, 229.3654180781295], "netStocks": [449, 450, 450, 450, 451, 452, 452, 452, 454, 454, 454, 456, 456, 456, 457, 457, 457, 458, 458, 458, 458, 459, 459, 459, 459, 459, 460, 461, 461, 461, 464, 464, 465, 465, 465, 465, 465, 465, 466, 466, 466, 466, 468, 469, 469, 469, 471, 472, 472, 472, 472, 472, 473, 474, 475, 476, 479, 480, 480, 480, 483, 484, 484, 484, 484, 484, 484, 484, 484, 484, 485, 485, 485, 485, 485, 485, 485, 485, 485, 485, 485, 485, 485, 485, 485, 485, 485, 485, 485, 485, 485, 485, 485, 485, 485, 485, 485, 485, 485, 485, 485, 485, 485, 485]}};
    </script>
    <script>
        
        (function() {
            const chartInstances = {};
            let isSyncing = false;

            document.querySelectorAll('.reset-zoom-btn').forEach(button => {
                button.addEventListener('click', (e) => {
                    const chartId = e.target.getAttribute('data-chart-id');
                    if (chartInstances[chartId]) {
                        chartInstances[chartId].resetZoom();
                    }
                });
            });

            function syncCharts(sourceChart) {
                if (isSyncing) return;
                isSyncing = true;
                const { min, max } = sourceChart.scales.x;
                for (const chartId in chartInstances) {
                    const targetChart = chartInstances[chartId];
                    if (targetChart.canvas.id !== sourceChart.canvas.id) {
                        targetChart.options.scales.x.min = min;
                        targetChart.options.scales.x.max = max;
                        targetChart.update('none');
                    }
                }
                isSyncing = false;
            }

            function createCharts(data) {
                const computedStyles = getComputedStyle(document.body);
                const colors = {
                    green: computedStyles.getPropertyValue('--green').trim(), red: computedStyles.getPropertyValue('--red').trim(),
                    blue: computedStyles.getPropertyValue('--blue').trim(), cyan: computedStyles.getPropertyValue('--cyan').trim(),
                    yellow: computedStyles.getPropertyValue('--yellow').trim(), magenta: computedStyles.getPropertyValue('--magenta').trim(),
                    text: computedStyles.getPropertyValue('--text-color').trim(), grid: computedStyles.getPropertyValue('--border-color').trim() + '80',
                };
                const commonOptions = {
                    responsive: true, maintainAspectRatio: false,
                    scales: {
                        x: { grid: { color: colors.grid }, ticks: { color: colors.text, maxRotation: 0, autoSkip: true, maxTicksLimit: 15 }, grace: '5%' },
                        y: { grid: { color: colors.grid }, ticks: { color: colors.text } }
                    },
                    plugins: {
                        legend: { labels: { color: colors.text, font: { size: 14 } } },
                        tooltip: {
                            backgroundColor: computedStyles.getPropertyValue('--card-bg-color').trim(),
                            titleFont: { size: 16 }, bodyFont: { size: 14 }, padding: 10,
                            borderColor: colors.grid, borderWidth: 1, titleColor: colors.text, bodyColor: colors.text,
                        },
                        zoom: {
                            pan: { enabled: true, mode: 'x', onPanComplete: ({ chart }) => syncCharts(chart) },
                            zoom: {
                                drag: { enabled: false },
                                wheel: { enabled: true }, 
                                pinch: { enabled: true },
                                mode: 'x',
                                onZoomComplete: ({ chart }) => syncCharts(chart)
                            }
                        }
                    },
                    elements: { point: { radius: 0 } },
                    interaction: { intersect: false, mode: 'index' }
                };
                const chartHeight = 450;
                document.querySelectorAll('.chart-card canvas').forEach(c => c.parentElement.style.height = chartHeight + 'px');
                
                chartInstances.chart1 = new Chart(document.getElementById('chart1'), { type: 'line', data: { labels: data.labels, datasets: [{ label: 'Trend Of Stks', data: data.chart1.trendOfStocks, borderColor: colors.magenta, borderWidth: 2, tension: 0.1 }, { label: 'e9 (EMA)', data: data.chart1.e9_trendOfStocks, borderColor: colors.blue, borderWidth: 2, tension: 0.1 }] }, options: commonOptions });
                chartInstances.chart2 = new Chart(document.getElementById('chart2'), { type: 'line', data: { labels: data.labels, datasets: [{ label: 'Proportion', data: data.chart2.proportion, borderColor: colors.yellow, borderWidth: 2, tension: 0.1 }, { label: 'e9 (EMA)', data: data.chart2.e9_proportion, borderColor: colors.blue, borderWidth: 2, tension: 0.1 }] }, options: commonOptions });
                chartInstances.chart3 = new Chart(document.getElementById('chart3'), { type: 'line', data: { labels: data.labels, datasets: [{ label: 'Stocks Above EMA', data: data.chart3.abvEMA, borderColor: colors.green, borderWidth: 2, tension: 0.1 }, { label: 'Stocks Below EMA', data: data.chart3.belEMA, borderColor: colors.red, borderWidth: 2, tension: 0.1 }, { label: 'Net Stocks', data: data.chart3.netStocks, borderColor: colors.text, borderWidth: 1, tension: 0.1, borderDash: [5, 5] }] }, options: commonOptions });
            }
            createCharts(window.chartData);
        })();
    
    </script>
</body>
</html>