<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nifty 500 - Broad Market Monitor</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/hammer.js/2.0.8/hammer.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-zoom@2.0.1/dist/chartjs-plugin-zoom.min.js"></script>
    <style>
        :root { --bg-color: #1a1b26; --card-bg-color: #24283b; --text-color: #c0caf5; --text-secondary-color: #a9b1d6; --border-color: #414868; --primary-color: #7aa2f7; --green: #9ece6a; --red: #f7768e; --blue: #7aa2f7; --cyan: #7dcfff; --yellow: #e0af68; --magenta: #bb9af7; }
        body[data-theme="bloomberg"] { --bg-color: #0d0d0d; --card-bg-color: #1a1a1a; --text-color: #e0e0e0; --text-secondary-color: #a0a0a0; --border-color: #333333; --primary-color: #ff9900; --green: #00e676; --red: #ff5252; --blue: #2979ff; --cyan: #00e5ff; --yellow: #ffd600; --magenta: #d500f9; }
        body[data-theme="light"] { --bg-color: #f5f7fa; --card-bg-color: #ffffff; --text-color: #1c2a42; --text-secondary-color: #5b6b85; --border-color: #e6e9f0; --primary-color: #0052cc; --green: #00875a; --red: #bf2600; --blue: #0052cc; --cyan: #00a3bf; --yellow: #ffab00; --magenta: #6554c0; }
        body { font-family: 'Segoe UI', 'Roboto', 'Helvetica', sans-serif; background-color: var(--bg-color); color: var(--text-color); margin: 0; padding: 10px; }
        .container { max-width: 1600px; margin: auto; }
        header { text-align: center; margin-bottom: 25px; border-bottom: 1px solid var(--border-color); padding-bottom: 20px; }
        h1 { font-size: 1.5rem; color: var(--text-color); margin: 0 0 5px 0; }
        h2 { margin: 0; color: var(--text-secondary-color); font-weight: 500; font-size: 1rem; }
        .card { background-color: var(--card-bg-color); border: 1px solid var(--border-color); border-radius: 8px; padding: 20px; margin-bottom: 20px; }
        .chart-header { display: flex; flex-direction: column; align-items: flex-start; gap: 10px; border-bottom: 1px solid var(--border-color); padding-bottom: 15px; margin-bottom: 15px; }
        .chart-title { font-size: 1.1rem; color: var(--text-secondary-color); font-weight: 500; }
        .zoom-hint { font-size: 0.8rem; font-style: italic; color: #6c707a; }
        .reset-zoom-btn { background: none; border: 1px solid var(--border-color); color: var(--text-secondary-color); padding: 5px 10px; border-radius: 4px; cursor: pointer; }
        @media (min-width: 600px) { 
            h1 {font-size: 1.8rem;} h2 {font-size: 1.2rem;}
            .chart-header { flex-direction: row; justify-content: space-between; align-items: center;}
        }
    </style>
</head>
<body data-theme="bloomberg">
    <div class="container">
        <header>
            <h1>Nifty 500</h1>
            <h2>Timeframe: Weekly | Lookback: 104 Periods</h2>
        </header>
        <div id="charts">
            <div class="card chart-card"><div class="chart-header"><span class="chart-title">Market Trend (Sum)</span><div><span class="zoom-hint">Scroll/Drag to Zoom</span> <button class="reset-zoom-btn" data-chart-id="chart1">Reset</button></div></div><canvas id="chart1"></canvas></div>
            <div class="card chart-card"><div class="chart-header"><span class="chart-title">Market Proportion</span><div><span class="zoom-hint">Scroll/Drag to Zoom</span> <button class="reset-zoom-btn" data-chart-id="chart2">Reset</button></div></div><canvas id="chart2"></canvas></div>
            <div class="card chart-card"><div class="chart-header"><span class="chart-title">Market Breadth</span><div><span class="zoom-hint">Scroll/Drag to Zoom</span> <button class="reset-zoom-btn" data-chart-id="chart3">Reset</button></div></div><canvas id="chart3"></canvas></div>
        </div>
    </div>
    <script>
        window.chartData = {"labels": ["2023-11-13", "2023-11-21", "2023-11-29", "2023-12-06", "2023-12-13", "2023-12-20", "2023-12-28", "2024-01-04", "2024-01-11", "2024-01-18", "2024-01-25", "2024-02-02", "2024-02-09", "2024-02-16", "2024-02-23", "2024-03-01", "2024-03-07", "2024-03-15", "2024-03-22", "2024-04-02", "2024-04-09", "2024-04-18", "2024-04-25", "2024-05-03", "2024-05-10", "2024-05-17", "2024-05-24", "2024-05-31", "2024-06-07", "2024-06-14", "2024-06-24", "2024-07-01", "2024-07-08", "2024-07-15", "2024-07-23", "2024-07-30", "2024-08-06", "2024-08-13", "2024-08-21", "2024-08-28", "2024-09-04", "2024-09-11", "2024-09-18", "2024-09-25", "2024-10-03", "2024-10-10", "2024-10-17", "2024-10-24", "2024-10-31", "2024-11-07", "2024-11-14", "2024-11-25", "2024-12-02", "2024-12-09", "2024-12-16", "2024-12-23", "2024-12-31", "2025-01-07", "2025-01-14", "2025-01-21", "2025-01-28", "2025-02-03", "2025-02-10", "2025-02-17", "2025-02-24", "2025-03-04", "2025-03-11", "2025-03-19", "2025-03-26", "2025-04-03", "2025-04-11", "2025-04-22", "2025-04-29", "2025-05-07", "2025-05-14", "2025-05-21", "2025-05-28", "2025-06-04", "2025-06-11", "2025-06-18", "2025-06-25", "2025-07-02", "2025-07-09", "2025-07-16", "2025-07-23", "2025-07-30", "2025-08-06", "2025-08-13", "2025-08-21", "2025-08-29", "2025-09-05", "2025-09-12", "2025-09-19", "2025-09-26", "2025-10-06", "2025-10-13", "2025-10-20", "2025-10-28", "2025-11-04", "2025-11-12", "2025-11-19", "2025-11-26", "2025-12-03", "2025-12-10"], "chart1": {"trendOfStocks": [169, 237, 274, 381, 369, 290, 355, 377, 351, 266, 224, 266, 211, 211, 221, 175, 106, -96, -38, 210, 238, 115, 238, 224, 54, 187, 188, 62, 242, 374, 332, 342, 318, 339, 213, 341, 36, 66, 204, 228, 225, 130, 151, 189, 95, 29, 1, -216, -149, -118, -290, -156, -51, 109, 69, -175, -137, -123, -359, -327, -405, -307, -295, -413, -396, -414, -362, -212, -110, -6, -162, 190, 76, 12, 224, 310, 276, 274, 360, 168, 252, 276, 270, 300, 200, 0, -134, -142, -16, -218, -92, 30, 164, -160, -8, -8, -8, 44, 2, -20, -58, -80, -158, -228], "e9_trendOfStocks": [169.0, 182.60000000000002, 200.88000000000002, 236.90400000000005, 263.32320000000004, 268.6585600000001, 285.92684800000006, 304.1414784000001, 313.5131827200001, 304.0105461760001, 288.0084369408001, 283.6067495526401, 269.0853996421121, 257.4683197136897, 250.1746557709518, 235.13972461676144, 209.31177969340916, 148.24942375472733, 110.99953900378188, 130.7996312030255, 152.2397049624204, 144.7917639699363, 163.43341117594906, 175.54672894075927, 151.23738315260744, 158.38990652208597, 164.31192521766877, 143.84954017413503, 163.47963213930802, 205.58370571144644, 230.86696456915718, 253.09357165532575, 266.0748573242606, 280.6598858594085, 267.1279086875268, 281.90232695002146, 232.72186156001717, 199.37748924801375, 200.30199139841102, 205.8415931187288, 209.67327449498305, 193.73861959598645, 185.19089567678918, 185.95271654143136, 167.7621732331451, 140.00973858651608, 112.20779086921287, 46.5662326953703, 7.4529861562962445, -17.637611074963004, -72.1100888599704, -88.88807108797633, -81.31045687038107, -43.24836549630487, -20.798692397043897, -51.63895391763512, -68.7111631341081, -79.5689305072865, -135.4551444058292, -173.76411552466337, -220.0112924197307, -237.40903393578458, -248.92722714862768, -281.7417817189022, -304.59342537512174, -326.47474030009744, -333.57979224007795, -309.2638337920624, -269.41106703364994, -216.72885362691994, -205.78308290153598, -126.6264663212288, -86.10117305698304, -66.48093844558643, -8.384750756469145, 55.292199394824685, 99.43375951585975, 134.3470076126878, 179.47760609015023, 177.18208487212019, 192.14566789769617, 208.91653431815695, 221.13322745452558, 236.90658196362048, 229.5252655708964, 183.62021245671713, 120.0961699653737, 67.67693597229896, 50.941548777839174, -2.846760977728657, -20.677408782182926, -10.541927025746343, 24.36645837940293, -12.506833296477655, -11.605466637182124, -10.8843733097457, -10.30749864779656, 0.5540010817627525, 0.8432008654102021, -3.3254393076718385, -14.260351446137472, -27.40828115690998, -53.52662492552798, -88.42129994042239]}, "chart2": {"proportion": [0.3665943600867679, 0.5140997830802603, 0.5930735930735931, 0.8228941684665226, 0.796976241900648, 0.625, 0.7634408602150538, 0.810752688172043, 0.7548387096774194, 0.5708154506437768, 0.48068669527896996, 0.5708154506437768, 0.4518201284796574, 0.4518201284796574, 0.4732334047109208, 0.3747323340471092, 0.2264957264957265, -0.20512820512820512, -0.0811965811965812, 0.44680851063829785, 0.5063829787234042, 0.24416135881104034, 0.5042372881355932, 0.4745762711864407, 0.11440677966101695, 0.3936842105263158, 0.3949579831932773, 0.13025210084033614, 0.5084033613445378, 0.7857142857142857, 0.6974789915966386, 0.7184873949579832, 0.6680672268907563, 0.710691823899371, 0.44654088050314467, 0.7148846960167715, 0.07531380753138076, 0.1375, 0.425, 0.475, 0.4677754677754678, 0.2697095435684647, 0.31262939958592134, 0.391304347826087, 0.19668737060041408, 0.060041407867494824, 0.002070393374741201, -0.4462809917355372, -0.30721649484536084, -0.24279835390946503, -0.5918367346938775, -0.3183673469387755, -0.10386965376782077, 0.2219959266802444, 0.14052953156822812, -0.35353535353535354, -0.2767676767676768, -0.24848484848484848, -0.7252525252525253, -0.6606060606060606, -0.8181818181818182, -0.6202020202020202, -0.5959595959595959, -0.8343434343434344, -0.7983870967741935, -0.8346774193548387, -0.7298387096774194, -0.4274193548387097, -0.2217741935483871, -0.012096774193548387, -0.32661290322580644, 0.38306451612903225, 0.1532258064516129, 0.024193548387096774, 0.45161290322580644, 0.625, 0.5564516129032258, 0.5524193548387096, 0.7258064516129032, 0.3387096774193548, 0.5080645161290323, 0.5564516129032258, 0.5443548387096774, 0.6048387096774194, 0.4032258064516129, 0.0, -0.2701612903225806, -0.2862903225806452, -0.03225806451612903, -0.43951612903225806, -0.18548387096774194, 0.06048387096774194, 0.33064516129032256, -0.3225806451612903, -0.016129032258064516, -0.016129032258064516, -0.016129032258064516, 0.08870967741935484, 0.004032258064516129, -0.04032258064516129, -0.11693548387096774, -0.16129032258064516, -0.3185483870967742, -0.4596774193548387], "e9_proportion": [0.3665943600867679, 0.3960954446854664, 0.43549107436309176, 0.512971693183778, 0.569772602927152, 0.5808180823417217, 0.6173426379163882, 0.6560246479675191, 0.6757874603094992, 0.6547930583763547, 0.6199717857568778, 0.6101405187342577, 0.5784764406833376, 0.5531451782426016, 0.5371628235362654, 0.5046767256384342, 0.44904052580989273, 0.3182067796222732, 0.2383261074585023, 0.28002258809446146, 0.32529466622025005, 0.3090680047384081, 0.34810186141784516, 0.37339674337156425, 0.32159875062945475, 0.336015842608827, 0.34780427072571707, 0.3042938367486409, 0.34511574166782033, 0.4332354504771134, 0.4860841587010185, 0.5325648059524115, 0.5596652901400805, 0.5898705968919387, 0.5612046536141799, 0.5919406620946983, 0.48861529118203484, 0.41839223294562794, 0.4197137863565024, 0.43077102908520193, 0.4381719168232551, 0.40447944217229703, 0.3861094336550219, 0.3871484164892349, 0.3490562073114708, 0.2912532474226756, 0.23341667661308874, 0.09747714294336356, 0.016538415385618684, -0.03532893847339806, -0.14663049771749398, -0.18097786756175027, -0.16555622480296436, -0.0880457945063226, -0.04233072929141246, -0.10457165414020067, -0.1390108586656959, -0.16090565662952644, -0.2737750303541262, -0.3511412364045131, -0.4445493527599742, -0.4796798862483834, -0.502935828190626, -0.5692173494211876, -0.6150512988917889, -0.6589765229843989, -0.6731489603230031, -0.6240030392261444, -0.543557270090593, -0.4372651709111841, -0.41513471737410856, -0.2554948706734804, -0.17375073524846177, -0.13416187852135006, -0.01700692217191875, 0.111394462262465, 0.20040589239061715, 0.2708085848802356, 0.36180815822676915, 0.3571884620652863, 0.3873636728780355, 0.42118126088307356, 0.4458159764483944, 0.4776205230941994, 0.4627415797656821, 0.3701932638125457, 0.24212235298552043, 0.13643981787228732, 0.10270024139460406, -0.005743032690768368, -0.04169120034616309, -0.021256186083382082, 0.04912408339135885, -0.02521686231917098, -0.02339929630694969, -0.021945243497172657, -0.02078200124935103, 0.0011163344843901427, 0.00169951920041534, -0.006704900768699985, -0.02875101738915354, -0.05525887842745186, -0.10791678016131633, -0.17826890800002082]}, "chart3": {"abvEMA": [315, 349, 368, 422, 416, 377, 410, 421, 408, 366, 345, 366, 339, 339, 344, 321, 287, 186, 215, 340, 354, 293, 355, 348, 263, 331, 332, 269, 359, 425, 404, 409, 397, 408, 345, 409, 257, 273, 342, 354, 353, 306, 317, 336, 289, 256, 242, 134, 168, 184, 100, 167, 220, 300, 280, 160, 179, 186, 68, 84, 45, 94, 100, 41, 50, 41, 67, 142, 193, 245, 167, 343, 286, 254, 360, 403, 386, 385, 428, 332, 374, 386, 383, 398, 348, 248, 181, 177, 240, 139, 202, 263, 330, 168, 244, 244, 244, 270, 249, 238, 219, 208, 169, 134], "belEMA": [146, 112, 94, 41, 47, 87, 55, 44, 57, 100, 121, 100, 128, 128, 123, 146, 181, 282, 253, 130, 116, 178, 117, 124, 209, 144, 144, 207, 117, 51, 72, 67, 79, 69, 132, 68, 221, 207, 138, 126, 128, 176, 166, 147, 194, 227, 241, 350, 317, 302, 390, 323, 271, 191, 211, 335, 316, 309, 427, 411, 450, 401, 395, 454, 446, 455, 429, 354, 303, 251, 329, 153, 210, 242, 136, 93, 110, 111, 68, 164, 122, 110, 113, 98, 148, 248, 315, 319, 256, 357, 294, 233, 166, 328, 252, 252, 252, 226, 247, 258, 277, 288, 327, 362], "e9AbvEMA": [315.0, 321.8, 331.04, 349.2320000000001, 362.58560000000006, 365.4684800000001, 374.3747840000001, 383.6998272000001, 388.5598617600001, 384.0478894080001, 376.23831152640014, 374.1906492211201, 367.1525193768961, 361.52201550151693, 358.01761240121357, 350.61408992097086, 337.89127193677666, 307.5130175494213, 289.01041403953707, 299.2083312316297, 310.1666649853038, 306.73333198824304, 316.3866655905945, 322.7093324724756, 310.7674659779805, 314.81397278238444, 318.25117822590755, 308.40094258072605, 318.52075406458084, 339.8166032516647, 352.65328260133174, 363.9226260810654, 370.53810086485237, 378.0304806918819, 371.42438455350555, 378.9395076428045, 354.55160611424355, 338.24128489139486, 338.99302791311595, 341.9944223304928, 344.1955378643943, 336.5564302915154, 332.64514423321236, 333.3161153865699, 324.45289230925596, 310.76231384740476, 297.0098510779238, 264.4078808623391, 245.12630468987126, 232.90104375189702, 206.32083500151762, 198.45666800121413, 202.7653344009713, 222.21226752077706, 233.76981401662167, 219.01585121329734, 211.0126809706379, 206.01014477651034, 178.40811582120827, 159.52649265696664, 136.6211941255733, 128.09695530045866, 122.47756424036693, 106.18205139229356, 94.94564111383485, 84.15651289106789, 80.72521031285432, 92.98016825028346, 112.98413460022678, 139.38730768018144, 144.90984614414515, 184.52787691531614, 204.82230153225294, 214.65784122580237, 243.7262729806419, 275.5810183845135, 297.66481470761084, 315.1318517660887, 337.705481412871, 336.56438513029684, 344.0515081042375, 352.44120648339, 358.552965186712, 366.44237214936965, 362.75389771949574, 339.80311817559664, 308.0424945404773, 281.83399563238186, 273.46719650590546, 246.5737572047244, 237.65900576377953, 242.72720461102364, 260.18176368881893, 241.74541095105516, 242.19632876084415, 242.55706300867536, 242.8456504069403, 248.27652032555227, 248.42121626044184, 246.33697300835348, 240.86957840668282, 234.29566272534626, 221.23653018027704, 203.78922414422166], "netStocks": [461, 461, 462, 463, 463, 464, 465, 465, 465, 466, 466, 466, 467, 467, 467, 467, 468, 468, 468, 470, 470, 471, 472, 472, 472, 475, 476, 476, 476, 476, 476, 476, 476, 477, 477, 477, 478, 480, 480, 480, 481, 482, 483, 483, 483, 483, 483, 484, 485, 486, 490, 490, 491, 491, 491, 495, 495, 495, 495, 495, 495, 495, 495, 495, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496, 496]}};
    </script>
    <script>
        
        (function() {
            const chartInstances = {};
            let isSyncing = false;

            document.querySelectorAll('.reset-zoom-btn').forEach(button => {
                button.addEventListener('click', (e) => {
                    const chartId = e.target.getAttribute('data-chart-id');
                    if (chartInstances[chartId]) {
                        chartInstances[chartId].resetZoom();
                    }
                });
            });

            function syncCharts(sourceChart) {
                if (isSyncing) return;
                isSyncing = true;
                const { min, max } = sourceChart.scales.x;
                for (const chartId in chartInstances) {
                    const targetChart = chartInstances[chartId];
                    if (targetChart.canvas.id !== sourceChart.canvas.id) {
                        targetChart.options.scales.x.min = min;
                        targetChart.options.scales.x.max = max;
                        targetChart.update('none');
                    }
                }
                isSyncing = false;
            }

            function createCharts(data) {
                const computedStyles = getComputedStyle(document.body);
                const colors = {
                    green: computedStyles.getPropertyValue('--green').trim(), red: computedStyles.getPropertyValue('--red').trim(),
                    blue: computedStyles.getPropertyValue('--blue').trim(), cyan: computedStyles.getPropertyValue('--cyan').trim(),
                    yellow: computedStyles.getPropertyValue('--yellow').trim(), magenta: computedStyles.getPropertyValue('--magenta').trim(),
                    text: computedStyles.getPropertyValue('--text-color').trim(), grid: computedStyles.getPropertyValue('--border-color').trim() + '80',
                };
                const commonOptions = {
                    responsive: true, maintainAspectRatio: false,
                    scales: {
                        x: { grid: { color: colors.grid }, ticks: { color: colors.text, maxRotation: 0, autoSkip: true, maxTicksLimit: 15 }, grace: '5%' },
                        y: { grid: { color: colors.grid }, ticks: { color: colors.text } }
                    },
                    plugins: {
                        legend: { labels: { color: colors.text, font: { size: 14 } } },
                        tooltip: {
                            backgroundColor: computedStyles.getPropertyValue('--card-bg-color').trim(),
                            titleFont: { size: 16 }, bodyFont: { size: 14 }, padding: 10,
                            borderColor: colors.grid, borderWidth: 1, titleColor: colors.text, bodyColor: colors.text,
                        },
                        zoom: {
                            pan: { enabled: true, mode: 'x', onPanComplete: ({ chart }) => syncCharts(chart) },
                            zoom: {
                                drag: { enabled: false },
                                wheel: { enabled: true }, 
                                pinch: { enabled: true },
                                mode: 'x',
                                onZoomComplete: ({ chart }) => syncCharts(chart)
                            }
                        }
                    },
                    elements: { point: { radius: 0 } },
                    interaction: { intersect: false, mode: 'index' }
                };
                const chartHeight = 450;
                document.querySelectorAll('.chart-card canvas').forEach(c => c.parentElement.style.height = chartHeight + 'px');
                
                chartInstances.chart1 = new Chart(document.getElementById('chart1'), { type: 'line', data: { labels: data.labels, datasets: [{ label: 'Trend Of Stks', data: data.chart1.trendOfStocks, borderColor: colors.magenta, borderWidth: 2, tension: 0.1 }, { label: 'e9 (EMA)', data: data.chart1.e9_trendOfStocks, borderColor: colors.blue, borderWidth: 2, tension: 0.1 }] }, options: commonOptions });
                chartInstances.chart2 = new Chart(document.getElementById('chart2'), { type: 'line', data: { labels: data.labels, datasets: [{ label: 'Proportion', data: data.chart2.proportion, borderColor: colors.yellow, borderWidth: 2, tension: 0.1 }, { label: 'e9 (EMA)', data: data.chart2.e9_proportion, borderColor: colors.blue, borderWidth: 2, tension: 0.1 }] }, options: commonOptions });
                chartInstances.chart3 = new Chart(document.getElementById('chart3'), { type: 'line', data: { labels: data.labels, datasets: [{ label: 'Stocks Above EMA', data: data.chart3.abvEMA, borderColor: colors.green, borderWidth: 2, tension: 0.1 }, { label: 'Stocks Below EMA', data: data.chart3.belEMA, borderColor: colors.red, borderWidth: 2, tension: 0.1 }, { label: 'Net Stocks', data: data.chart3.netStocks, borderColor: colors.text, borderWidth: 1, tension: 0.1, borderDash: [5, 5] }] }, options: commonOptions });
            }
            createCharts(window.chartData);
        })();
    
    </script>
</body>
</html>